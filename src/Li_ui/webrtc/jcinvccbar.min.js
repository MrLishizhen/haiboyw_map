var websocket_guard_connecting=3E3,websocket_guard_connected=websocket_guard_connecting+1,websocket_guard_colsed=websocket_guard_connected+2,websocket_guard_remoteserver_disconnected=websocket_guard_connected+3,websocket_connecting=3100,websocket_connected=websocket_connecting+1,websocket_closed=websocket_connected+2,websocket_remoteserver_disconnected=websocket_connected+3,websocket_reconnecting=websocket_connected+4,APSP_Type_NONE=-1,APSP_Type_Action=0,APSP_Type_Event=1,APSP_Type_Command=2,APSP_Type_Prompt=3,APSP_NONE=-1,APSP_GetLocalPort_CONF=APSP_NONE+1,APSP_UpdateSetup_CONF=APSP_GetLocalPort_CONF+1,APSP_GetVersion_CONF=APSP_UpdateSetup_CONF+1,APSP_Initial_CONF=APSP_GetVersion_CONF+1,APSP_MakeCall_CONF=APSP_Initial_CONF+1,APSP_TransferOut_CONF=APSP_MakeCall_CONF+1,APSP_SerialBtn_CONF=APSP_TransferOut_CONF+1,APSP_ForeReleaseCall_CONF=APSP_SerialBtn_CONF+1,APSP_Insert_CONF=APSP_ForeReleaseCall_CONF+1,APSP_Listen_CONF=APSP_Insert_CONF+1,APSP_Help_CONF=APSP_Listen_CONF+1,APSP_Bridge_CONF=APSP_Help_CONF+1,APSP_SetBusy_CONF=APSP_Bridge_CONF+1,APSP_SetIdle_CONF=APSP_SetBusy_CONF+1,APSP_CallIn_CONF=APSP_SetIdle_CONF+1,APSP_Hold_CONF=APSP_CallIn_CONF+1,APSP_RetrieveHold_CONF=APSP_Hold_CONF+1,APSP_Disconnect_CONF=APSP_RetrieveHold_CONF+1,APSP_Conference_CONF=APSP_Disconnect_CONF+1,APSP_Answer_CONF=APSP_Conference_CONF+1,APSP_Consult_CONF=APSP_Answer_CONF+1,APSP_GetBtnStatus_CONF=APSP_Consult_CONF+1,APSP_Intercept_CONF=APSP_GetBtnStatus_CONF+1,APSP_SendDTMF_CONF=APSP_Intercept_CONF+1,APSP_BeginRecord_CONF=APSP_SendDTMF_CONF+1,APSP_StopRecord_CONF=APSP_BeginRecord_CONF+1,APSP_BeginPlay_CONF=APSP_StopRecord_CONF+1,APSP_StopPlay_CONF=APSP_BeginPlay_CONF+1,APSP_ForceReset_CONF=APSP_StopPlay_CONF+1,APSP_Configurate_CONF=APSP_ForceReset_CONF+1,APSP_Transfer_CONF=APSP_Configurate_CONF+1,APSP_Mute_CONF=APSP_Transfer_CONF+1,APSP_Lock_CONF=APSP_Mute_CONF+1,APSP_UnLock_CONF=APSP_Lock_CONF+1,APSP_SetWrapUp_CONF=APSP_UnLock_CONF+1,APSP_ForceIdle_CONF=APSP_SetWrapUp_CONF+1,APSP_ForceBusy_CONF=APSP_ForceIdle_CONF+1,APSP_ForceOut_CONF=APSP_ForceBusy_CONF+1,APSP_AlterNate_CONF=APSP_ForceOut_CONF+1,APSP_CallBack_CONF=APSP_AlterNate_CONF+1,APSP_ReCall_CONF=APSP_CallBack_CONF+1,APSP_GetConfiguration_CONF=APSP_ReCall_CONF+1,APSP_GetCallInfo_CONF=APSP_GetConfiguration_CONF+1,APSP_ChangeCallQueue_CONF=APSP_GetCallInfo_CONF+1,APSP_GetCallID_CONF=APSP_ChangeCallQueue_CONF+1,APSP_QueryQueueInfo_CONF=APSP_GetCallID_CONF+1,APSP_QueryIvrInfo_CONF=APSP_QueryQueueInfo_CONF+1,APSP_SMMsg_CONF=APSP_QueryIvrInfo_CONF+1,APSP_SetCTICalloutTask_CONF=APSP_SMMsg_CONF+1,APSP_GetCTICalloutTask_CONF=APSP_SetCTICalloutTask_CONF+1,APSP_QuerySPGroupList_CONF=APSP_GetCTICalloutTask_CONF+1,APSP_ReleaseThirdOne_CONF=APSP_QuerySPGroupList_CONF+1,APSP_GetCallData_CONF=APSP_ReleaseThirdOne_CONF+1,APSP_SetCallData_CONF=APSP_GetCallData_CONF+1,APSP_BeginCollect_CONF=APSP_SetCallData_CONF+1,APSP_StopCollect_CONF=APSP_BeginCollect_CONF+1,APSP_GetTransfer_CONF=APSP_StopCollect_CONF+1,APSP_SetTransfer_CONF=APSP_GetTransfer_CONF+1,APSP_GetMonitoredAgentList_CONF=APSP_SetTransfer_CONF+1,APSP_UnInitial_CONF=APSP_GetMonitoredAgentList_CONF+1,APSP_SetTransparentParameter_CONF=APSP_UnInitial_CONF+1,APSP_InitialState_CONF=APSP_SetTransparentParameter_CONF+1,APSP_AgentQuery_CONF=APSP_InitialState_CONF+1,APSP_IvrQuery_CONF=APSP_AgentQuery_CONF+1,APSP_TrunkQuery_CONF=APSP_IvrQuery_CONF+1,APSP_TelQuery_CONF=APSP_TrunkQuery_CONF+1,APSP_ServiceQuery_CONF=APSP_TelQuery_CONF+1,APSP_MMServiceQuery_CONF=APSP_ServiceQuery_CONF+1,APSP_AgentStateQuery_CONF=APSP_MMServiceQuery_CONF+1,APSP_TaskQuery_CONF=APSP_AgentStateQuery_CONF+1,APSP_StartNotification_CONF=APSP_TaskQuery_CONF+1,APSP_EndNotification_CONF=APSP_StartNotification_CONF+1,APSP_GetTaskSummary_CONF=APSP_EndNotification_CONF+1,APSP_CallReportQuery_CONF=APSP_GetTaskSummary_CONF+1,APSP_QueryCTIInfo_CONF=APSP_CallReportQuery_CONF+1,APSP_CallQueueQuery_CONF=APSP_QueryCTIInfo_CONF+1,APSP_SetCTIInfo_CONF=APSP_CallQueueQuery_CONF+1,APSP_QueryMonitorSumInfo_CONF=APSP_SetCTIInfo_CONF+1,APSP_SendWeiboMsg_CONF=APSP_QueryMonitorSumInfo_CONF+1,APSP_SendIMMessage_CONF=APSP_SendWeiboMsg_CONF+1,APSP_SendWeChatMsg_CONF=APSP_SendIMMessage_CONF+1,APSP_QueryWeChatData_CONF=APSP_SendWeChatMsg_CONF+1,APSP_QueryWeChatHistory_CONF=APSP_QueryWeChatData_CONF+1,APSP_UploadFileToMMS_CONF=APSP_QueryWeChatHistory_CONF+1,APSP_DownFileFromMMS_CONF=APSP_UploadFileToMMS_CONF+1,APSP_GetWeChatParam_CONF=APSP_DownFileFromMMS_CONF+1,APSP_TransferCallQueue_CONF=APSP_GetWeChatParam_CONF+1,APSP_SendIMMessage2_CONF=APSP_TransferCallQueue_CONF+1,APSP_WinCap_CONF=APSP_SendIMMessage2_CONF+1,APSP_PopDLG_CONF=APSP_WinCap_CONF+1,APSP_SendSipSessionMessage_CONF=APSP_PopDLG_CONF+1,APSP_UpdateMedia_CONF=APSP_SendSipSessionMessage_CONF+1,APSP_BeginCapture_CONF=APSP_UpdateMedia_CONF+1,APSP_Connect_CONF=APSP_BeginCapture_CONF+1,APSP_ReleaseConnectOne_CONF=APSP_Connect_CONF+1,APSP_MultiConfTransfer_CONF=APSP_ReleaseConnectOne_CONF+1,APSP_ModifyVideoStream_CONF=APSP_MultiConfTransfer_CONF+1,APSP_ComingCall_EVENT=APSP_ModifyVideoStream_CONF+1,APSP_RecordFileUpLoaded_EVENT=APSP_ComingCall_EVENT+1,APSP_AnswerCall_EVENT=APSP_RecordFileUpLoaded_EVENT+1,APSP_OnPrompt_EVENT=APSP_AnswerCall_EVENT+1,APSP_OnReportBtnStatus_EVENT=APSP_OnPrompt_EVENT+1,APSP_OnTelephoneStatusChanged_EVENT=APSP_OnReportBtnStatus_EVENT+1,APSP_OnAgentStatusChanged_EVENT=APSP_OnTelephoneStatusChanged_EVENT+1,APSP_OnQueueStatusChanged_EVENT=APSP_OnAgentStatusChanged_EVENT+1,APSP_OnlockStatusReport_EVENT=APSP_OnQueueStatusChanged_EVENT+1,APSP_OnInitalSuccess_EVENT=APSP_OnlockStatusReport_EVENT+1,APSP_OnShortCutKey_EVENT=APSP_OnInitalSuccess_EVENT+1,APSP_OnIVRStatusChanged_EVENT=APSP_OnShortCutKey_EVENT+1,APSP_OnEventPrompt_EVENT=APSP_OnIVRStatusChanged_EVENT+1,APSP_OnAgentWorkReport_EVENT=APSP_OnEventPrompt_EVENT+1,APSP_OnInitalFailure_EVENT=APSP_OnAgentWorkReport_EVENT+1,APSP_OnCallEnd_EVENT=APSP_OnInitalFailure_EVENT+1,APSP_OnAgentReport_EVENT=APSP_OnCallEnd_EVENT+1,APSP_OnIvrReport_EVENT=APSP_OnAgentReport_EVENT+1,APSP_OnTelReport_EVENT=APSP_OnIvrReport_EVENT+1,APSP_OnServiceReport_EVENT=APSP_OnTelReport_EVENT+1,APSP_OnMMServiceReport_EVENT=APSP_OnServiceReport_EVENT+1,APSP_OnTaskReport_EVENT=APSP_OnMMServiceReport_EVENT+1,APSP_OutboundReport_EVENT=APSP_OnTaskReport_EVENT+1,APSP_CallReportInfo_EVENT=APSP_OutboundReport_EVENT+1,APSP_QueryMonitorSumReport_EVENT=APSP_CallReportInfo_EVENT+1,APSP_OnCallRing_EVENT=APSP_QueryMonitorSumReport_EVENT+1,APSP_OnHeatBeat_EVENT=APSP_OnCallRing_EVENT+1,APSP_OnBarExit_EVENT=APSP_OnHeatBeat_EVENT+1,APSP_OnSystemBusy_EVENT=APSP_OnBarExit_EVENT+1,APSP_OnCallQueueQuery_EVENT=APSP_OnSystemBusy_EVENT+1,APSP_OnQueueReport_EVENT=APSP_OnCallQueueQuery_EVENT+1,APSP_OnSystemMessage_EVENT=APSP_OnQueueReport_EVENT+1,APSP_OnRecvWeiboMsg_EVENT=APSP_OnSystemMessage_EVENT+1,APSP_OnIMNoticsMsg_EVENT=APSP_OnRecvWeiboMsg_EVENT+1,APSP_OnIMTextMsg_EVENT=APSP_OnIMNoticsMsg_EVENT+1,APSP_OnWallServiceReport_EVENT=APSP_OnIMTextMsg_EVENT+1,APSP_OnWallQueueReport_EVENT=APSP_OnWallServiceReport_EVENT+1,APSP_OnStaticInfoReport_EVENT=APSP_OnWallQueueReport_EVENT+1,APSP_OnRecvWeChatMsg_EVENT=APSP_OnStaticInfoReport_EVENT+1,APSP_OnServiceStaticReport_EVENT=APSP_OnRecvWeChatMsg_EVENT+1,APSP_OnAgentStaticReport_EVENT=APSP_OnServiceStaticReport_EVENT+1,APSP_OnTrunkReport_EVENT=APSP_OnAgentStaticReport_EVENT+1,APSP_OnTrunkSumReport_EVENT=APSP_OnTrunkReport_EVENT+1,APSP_OnUploadFileToMMSReport_EVENT=APSP_OnTrunkSumReport_EVENT+1,APSP_OnDownloadFileToMMSReport_EVENT=APSP_OnUploadFileToMMSReport_EVENT+1,APSP_OnSendWeChatMsgReport_EVENT=APSP_OnDownloadFileToMMSReport_EVENT+1,APSP_OnAQueryCTIInfo_EVENT=APSP_OnSendWeChatMsgReport_EVENT+1,APSP_OnAgentBusyReason_EVENT=APSP_OnAQueryCTIInfo_EVENT+1,APSP_OnAsrEventReport_EVENT=APSP_OnAgentBusyReason_EVENT+1,APSP_OnStopSmSuccess_EVENT=APSP_OnAsrEventReport_EVENT+1,APSP_OnUpdateMediaEvent_EVENT=APSP_OnStopSmSuccess_EVENT+1,APSP_OnStopCaptureSuccess_EVENT=APSP_OnUpdateMediaEvent_EVENT+1,APSP_OnModifyVideoStreamReport_EVENT=APSP_OnStopCaptureSuccess_EVENT+1,APSP_OnAction_EVENT=APSP_OnModifyVideoStreamReport_EVENT+1,APSP_OnSetDlgStatusText_EVENT=APSP_OnAction_EVENT+1,APSP_OnChangeBtnSerial_EVENT=APSP_OnSetDlgStatusText_EVENT+1,APSP_Test_CONF=APSP_OnChangeBtnSerial_EVENT+1,APSP_Item_End=APSP_Test_CONF+1,APSP_WebSocket_Event=APSP_Item_End+1;function getCmdType(a){var b=APSP_Type_NONE;"event"==a&&(b=APSP_Type_Event);"command"==a&&(b=APSP_Type_Command);"action"==a&&(b=APSP_Type_Action);return b}function GetApspParam(){for(var a="",b=0;b<arguments.length;b++)a=0==b?getDefaultParam(arguments[b]):a+"|"+getDefaultParam(arguments[b]);return a}function buildApspMsg(a,b){var c='\x3capspMessage ver\x3d"2.0.0" time\x3d"'+getTimeString()+'"\x3e';return c=c+'\x3cheader\x3e\x3csessionID\x3e0\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"command" name\x3d"'+a+'"\x3e\x3cpaspparam\x3e'+b+"\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e"}function JAPSPWebSocket(a){this._ws=null;this._connectFlag=!1;this._msgCallback=null;this._appName=a;this.m_arrCmd=[];this.m_arrCmdIndex=[];this._dataBuffer=[];this._lastSendTime="";this.WSConnect=function(a,c){try{this._ws=new WebSocket("ws://"+a+":"+c)}catch(f){try{this._ws=new MozWebSocket("ws://"+a+":"+c)}catch(g){alert(g);this._ws=null;return}}this._ws.onopen=this.WSonOpen;this._ws.onmessage=this.WSonMessage;this._ws.onclose=this.WSonClose;this._ws.onerror=this.WSonError;this._ws.oParent=this};this.WSDisconnect=function(){!this._connectFlag||0!=this._ws.readyState&&1!=this._ws.readyState||this._ws.close()};this.ReWSSendMsg=function(){0>=this._dataBuffer.length||(this.WSSendMsg(this._dataBuffer[0]),DisplayLog(VccBar_Log_Debug,"buffer out:"+this._dataBuffer[0]),this._dataBuffer.splice(0,1))};this.WSSbufferSize=function(){return this._dataBuffer.length};this.WSSendMsg=function(a){if(""==a)return-1;if(this._connectFlag){if(""!=this._lastSendTime&&100>new Date-this._lastSendTime)return this._dataBuffer.push(a),DisplayLog(VccBar_Log_Debug,"buffer in:"+a),-2;DisplayLog(VccBar_Log_Protocol,"SenPAS:"+a);this._ws.send(a);this._lastSendTime=new Date;return 0}return-1};this.SetMsgCallBack=function(a){this._msgCallback=a};this.WSonOpen=function(){this.oParent._connectFlag=!0;this.oParent.invokeCallBack(APSP_Type_Prompt,APSP_WebSocket_Event,websocket_connected)};this.WSonMessage=function(a){DisplayLog(VccBar_Log_Protocol,"RecPAS:"+a.data);var b=getSubString(a.data,'type\x3d"','"'),f=getSubString(a.data,'name\x3d"','"');a=getSubString(a.data,"\x3cpaspparam\x3e","\x3c/paspparam\x3e");this.oParent.invokeCallBack(getCmdType(b),this.oParent.GetCmdIndex(f),a)};this.WSonClose=function(){DisplayLog(VccBar_Log_Error,"WebSocket::WSonClose("+this.oParent._appName+")");this.oParent.invokeCallBack(APSP_Type_Prompt,APSP_WebSocket_Event,websocket_closed);this.oParent._connectFlag=!1};this.WSonError=function(a){DisplayLog(VccBar_Log_Error,"WebSocket::WSonError("+this.oParent._appName+")");this.oParent.invokeCallBack(APSP_Type_Prompt,APSP_WebSocket_Event,websocket_remoteserver_disconnected);this.oParent._connectFlag=!1};this.invokeCallBack=function(a,c,f){null!=this._msgCallback&&this._msgCallback(a,c,f)};this._APSPInit=function(){0<this.m_arrCmd.length||(this.m_arrCmd.push("GetLocalPort"),this.m_arrCmdIndex.push(APSP_GetLocalPort_CONF),this.m_arrCmd.push("UpdateSetup"),this.m_arrCmdIndex.push(APSP_UpdateSetup_CONF),this.m_arrCmd.push("GetVersion"),this.m_arrCmdIndex.push(APSP_GetVersion_CONF),this.m_arrCmd.push("Initial"),this.m_arrCmdIndex.push(APSP_Initial_CONF),this.m_arrCmd.push("MakeCall"),this.m_arrCmdIndex.push(APSP_MakeCall_CONF),this.m_arrCmd.push("TransferOut"),this.m_arrCmdIndex.push(APSP_TransferOut_CONF),this.m_arrCmd.push("SerialBtn"),this.m_arrCmdIndex.push(APSP_SerialBtn_CONF),this.m_arrCmd.push("ForeReleaseCall"),this.m_arrCmdIndex.push(APSP_ForeReleaseCall_CONF),this.m_arrCmd.push("Insert"),this.m_arrCmdIndex.push(APSP_Insert_CONF),this.m_arrCmd.push("Listen"),this.m_arrCmdIndex.push(APSP_Listen_CONF),this.m_arrCmd.push("Help"),this.m_arrCmdIndex.push(APSP_Help_CONF),this.m_arrCmd.push("Bridge"),this.m_arrCmdIndex.push(APSP_Bridge_CONF),this.m_arrCmd.push("SetBusy"),this.m_arrCmdIndex.push(APSP_SetBusy_CONF),this.m_arrCmd.push("SetIdle"),this.m_arrCmdIndex.push(APSP_SetIdle_CONF),this.m_arrCmd.push("CallIn"),this.m_arrCmdIndex.push(APSP_CallIn_CONF),this.m_arrCmd.push("Hold"),this.m_arrCmdIndex.push(APSP_Hold_CONF),this.m_arrCmd.push("RetrieveHold"),this.m_arrCmdIndex.push(APSP_RetrieveHold_CONF),this.m_arrCmd.push("Disconnect"),this.m_arrCmdIndex.push(APSP_Disconnect_CONF),this.m_arrCmd.push("Conference"),this.m_arrCmdIndex.push(APSP_Conference_CONF),this.m_arrCmd.push("Answer"),this.m_arrCmdIndex.push(APSP_Answer_CONF),this.m_arrCmd.push("Consult"),this.m_arrCmdIndex.push(APSP_Consult_CONF),this.m_arrCmd.push("GetBtnStatus"),this.m_arrCmdIndex.push(APSP_GetBtnStatus_CONF),this.m_arrCmd.push("Intercept"),this.m_arrCmdIndex.push(APSP_Intercept_CONF),this.m_arrCmd.push("SendDTMF"),this.m_arrCmdIndex.push(APSP_SendDTMF_CONF),this.m_arrCmd.push("BeginRecord"),this.m_arrCmdIndex.push(APSP_BeginRecord_CONF),this.m_arrCmd.push("StopRecord"),this.m_arrCmdIndex.push(APSP_StopRecord_CONF),this.m_arrCmd.push("BeginPlay"),this.m_arrCmdIndex.push(APSP_BeginPlay_CONF),this.m_arrCmd.push("StopPlay"),this.m_arrCmdIndex.push(APSP_StopPlay_CONF),this.m_arrCmd.push("ForceReset"),this.m_arrCmdIndex.push(APSP_ForceReset_CONF),this.m_arrCmd.push("Configurate"),this.m_arrCmdIndex.push(APSP_Configurate_CONF),this.m_arrCmd.push("Transfer"),this.m_arrCmdIndex.push(APSP_Transfer_CONF),this.m_arrCmd.push("Mute"),this.m_arrCmdIndex.push(APSP_Mute_CONF),this.m_arrCmd.push("Lock"),this.m_arrCmdIndex.push(APSP_Lock_CONF),this.m_arrCmd.push("UnLock"),this.m_arrCmdIndex.push(APSP_UnLock_CONF),this.m_arrCmd.push("SetWrapUp"),this.m_arrCmdIndex.push(APSP_SetWrapUp_CONF),this.m_arrCmd.push("ForceIdle"),this.m_arrCmdIndex.push(APSP_ForceIdle_CONF),this.m_arrCmd.push("ForceBusy"),this.m_arrCmdIndex.push(APSP_ForceBusy_CONF),this.m_arrCmd.push("ForceOut"),this.m_arrCmdIndex.push(APSP_ForceOut_CONF),this.m_arrCmd.push("AlterNate"),this.m_arrCmdIndex.push(APSP_AlterNate_CONF),this.m_arrCmd.push("CallBack"),this.m_arrCmdIndex.push(APSP_CallBack_CONF),this.m_arrCmd.push("ReCall"),this.m_arrCmdIndex.push(APSP_ReCall_CONF),this.m_arrCmd.push("GetConfiguration"),this.m_arrCmdIndex.push(APSP_GetConfiguration_CONF),this.m_arrCmd.push("GetCallInfo"),this.m_arrCmdIndex.push(APSP_GetCallInfo_CONF),this.m_arrCmd.push("ChangeCallQueue"),this.m_arrCmdIndex.push(APSP_ChangeCallQueue_CONF),this.m_arrCmd.push("GetCallID"),this.m_arrCmdIndex.push(APSP_GetCallID_CONF),this.m_arrCmd.push("QueryQueueInfo"),this.m_arrCmdIndex.push(APSP_QueryQueueInfo_CONF),this.m_arrCmd.push("QueryIvrInfo"),this.m_arrCmdIndex.push(APSP_QueryIvrInfo_CONF),this.m_arrCmd.push("SMMsg"),this.m_arrCmdIndex.push(APSP_SMMsg_CONF),this.m_arrCmd.push("SetCTICalloutTask"),this.m_arrCmdIndex.push(APSP_SetCTICalloutTask_CONF),this.m_arrCmd.push("GetCTICalloutTask"),this.m_arrCmdIndex.push(APSP_GetCTICalloutTask_CONF),this.m_arrCmd.push("QuerySPGroupList"),this.m_arrCmdIndex.push(APSP_QuerySPGroupList_CONF),this.m_arrCmd.push("ReleaseThirdOne"),this.m_arrCmdIndex.push(APSP_ReleaseThirdOne_CONF),this.m_arrCmd.push("GetCallData"),this.m_arrCmdIndex.push(APSP_GetCallData_CONF),this.m_arrCmd.push("SetCallData"),this.m_arrCmdIndex.push(APSP_SetCallData_CONF),this.m_arrCmd.push("BeginCollect"),this.m_arrCmdIndex.push(APSP_BeginCollect_CONF),this.m_arrCmd.push("StopCollect"),this.m_arrCmdIndex.push(APSP_StopCollect_CONF),this.m_arrCmd.push("GetTransfer"),this.m_arrCmdIndex.push(APSP_GetTransfer_CONF),this.m_arrCmd.push("SetTransfer"),this.m_arrCmdIndex.push(APSP_SetTransfer_CONF),this.m_arrCmd.push("GetMonitoredAgentList"),this.m_arrCmdIndex.push(APSP_GetMonitoredAgentList_CONF),this.m_arrCmd.push("UnInitial"),this.m_arrCmdIndex.push(APSP_UnInitial_CONF),this.m_arrCmd.push("SetTransparentParameter"),this.m_arrCmdIndex.push(APSP_SetTransparentParameter_CONF),this.m_arrCmd.push("InitialState"),this.m_arrCmdIndex.push(APSP_InitialState_CONF),this.m_arrCmd.push("AgentQuery"),this.m_arrCmdIndex.push(APSP_AgentQuery_CONF),this.m_arrCmd.push("IvrQuery"),this.m_arrCmdIndex.push(APSP_IvrQuery_CONF),this.m_arrCmd.push("TrunkQuery"),this.m_arrCmdIndex.push(APSP_TrunkQuery_CONF),this.m_arrCmd.push("TelQuery"),this.m_arrCmdIndex.push(APSP_TelQuery_CONF),this.m_arrCmd.push("ServiceQuery"),this.m_arrCmdIndex.push(APSP_ServiceQuery_CONF),this.m_arrCmd.push("MMServiceQuery"),this.m_arrCmdIndex.push(APSP_MMServiceQuery_CONF),this.m_arrCmd.push("AgentStateQuery"),this.m_arrCmdIndex.push(APSP_AgentStateQuery_CONF),this.m_arrCmd.push("TaskQuery"),this.m_arrCmdIndex.push(APSP_TaskQuery_CONF),this.m_arrCmd.push("StartNotification"),this.m_arrCmdIndex.push(APSP_StartNotification_CONF),this.m_arrCmd.push("EndNotification"),this.m_arrCmdIndex.push(APSP_EndNotification_CONF),this.m_arrCmd.push("GetTaskSummary"),this.m_arrCmdIndex.push(APSP_GetTaskSummary_CONF),this.m_arrCmd.push("CallReportQuery"),this.m_arrCmdIndex.push(APSP_CallReportQuery_CONF),this.m_arrCmd.push("QueryCTIInfo"),this.m_arrCmdIndex.push(APSP_QueryCTIInfo_CONF),this.m_arrCmd.push("CallQueueQuery"),this.m_arrCmdIndex.push(APSP_CallQueueQuery_CONF),this.m_arrCmd.push("SetCTIInfo"),this.m_arrCmdIndex.push(APSP_SetCTIInfo_CONF),this.m_arrCmd.push("QueryMonitorSumInfo"),this.m_arrCmdIndex.push(APSP_QueryMonitorSumInfo_CONF),this.m_arrCmd.push("SendWeiboMsg"),this.m_arrCmdIndex.push(APSP_SendWeiboMsg_CONF),this.m_arrCmd.push("SendIMMessageMsg"),this.m_arrCmdIndex.push(APSP_SendIMMessage_CONF),this.m_arrCmd.push("SendWeChatMsg"),this.m_arrCmdIndex.push(APSP_SendWeChatMsg_CONF),this.m_arrCmd.push("QueryWeChatData"),this.m_arrCmdIndex.push(APSP_QueryWeChatData_CONF),this.m_arrCmd.push("QueryWeChatHistory"),this.m_arrCmdIndex.push(APSP_QueryWeChatHistory_CONF),this.m_arrCmd.push("UploadFileToMMS"),this.m_arrCmdIndex.push(APSP_UploadFileToMMS_CONF),this.m_arrCmd.push("DownFileFromMMS"),this.m_arrCmdIndex.push(APSP_DownFileFromMMS_CONF),this.m_arrCmd.push("GetWeChatParam"),this.m_arrCmdIndex.push(APSP_GetWeChatParam_CONF),this.m_arrCmd.push("TransferCallQueue"),this.m_arrCmdIndex.push(APSP_TransferCallQueue_CONF),this.m_arrCmd.push("SendIMMessageMsg2"),this.m_arrCmdIndex.push(APSP_SendIMMessage2_CONF),this.m_arrCmd.push("WinCap"),this.m_arrCmdIndex.push(APSP_WinCap_CONF),this.m_arrCmd.push("PopDLG"),this.m_arrCmdIndex.push(APSP_PopDLG_CONF),this.m_arrCmd.push("SendSipSessionMessage"),this.m_arrCmdIndex.push(APSP_SendSipSessionMessage_CONF),this.m_arrCmd.push("UpdateMedia"),this.m_arrCmdIndex.push(APSP_UpdateMedia_CONF),this.m_arrCmd.push("BeginCapture"),this.m_arrCmdIndex.push(APSP_BeginCapture_CONF),this.m_arrCmd.push("Connect"),this.m_arrCmdIndex.push(APSP_Connect_CONF),this.m_arrCmd.push("ReleaseConnectOne"),this.m_arrCmdIndex.push(APSP_ReleaseConnectOne_CONF),this.m_arrCmd.push("MultiConfTransfer"),this.m_arrCmdIndex.push(APSP_MultiConfTransfer_CONF),this.m_arrCmd.push("ModifyVideoStream"),this.m_arrCmdIndex.push(APSP_ModifyVideoStream_CONF),this.m_arrCmd.push("ComingCall"),this.m_arrCmdIndex.push(APSP_ComingCall_EVENT),this.m_arrCmd.push("RecordFileUpLoaded"),this.m_arrCmdIndex.push(APSP_RecordFileUpLoaded_EVENT),this.m_arrCmd.push("AnswerCall"),this.m_arrCmdIndex.push(APSP_AnswerCall_EVENT),this.m_arrCmd.push("OnPrompt"),this.m_arrCmdIndex.push(APSP_OnPrompt_EVENT),this.m_arrCmd.push("ReportBtnStatus"),this.m_arrCmdIndex.push(APSP_OnReportBtnStatus_EVENT),this.m_arrCmd.push("OnTelephoneStatusChanged"),this.m_arrCmdIndex.push(APSP_OnTelephoneStatusChanged_EVENT),this.m_arrCmd.push("OnAgentStatusChanged"),this.m_arrCmdIndex.push(APSP_OnAgentStatusChanged_EVENT),this.m_arrCmd.push("OnQueueStatusChanged"),this.m_arrCmdIndex.push(APSP_OnQueueStatusChanged_EVENT),this.m_arrCmd.push("OnlockStatusReport"),this.m_arrCmdIndex.push(APSP_OnlockStatusReport_EVENT),this.m_arrCmd.push("OnInitalSuccess"),this.m_arrCmdIndex.push(APSP_OnInitalSuccess_EVENT),this.m_arrCmd.push("OnShortCutKey"),this.m_arrCmdIndex.push(APSP_OnShortCutKey_EVENT),this.m_arrCmd.push("OnIVRStatusChanged"),this.m_arrCmdIndex.push(APSP_OnIVRStatusChanged_EVENT),this.m_arrCmd.push("OnEventPrompt"),this.m_arrCmdIndex.push(APSP_OnEventPrompt_EVENT),this.m_arrCmd.push("OnAgentWorkReport"),this.m_arrCmdIndex.push(APSP_OnAgentWorkReport_EVENT),this.m_arrCmd.push("OnInitalFailure"),this.m_arrCmdIndex.push(APSP_OnInitalFailure_EVENT),this.m_arrCmd.push("OnCallEnd"),this.m_arrCmdIndex.push(APSP_OnCallEnd_EVENT),this.m_arrCmd.push("OnAgentReport"),this.m_arrCmdIndex.push(APSP_OnAgentReport_EVENT),this.m_arrCmd.push("OnIvrReport"),this.m_arrCmdIndex.push(APSP_OnIvrReport_EVENT),this.m_arrCmd.push("OnTelReport"),this.m_arrCmdIndex.push(APSP_OnTelReport_EVENT),this.m_arrCmd.push("OnServiceReport"),this.m_arrCmdIndex.push(APSP_OnServiceReport_EVENT),this.m_arrCmd.push("OnMMServiceReport"),this.m_arrCmdIndex.push(APSP_OnMMServiceReport_EVENT),this.m_arrCmd.push("OnTaskReport"),this.m_arrCmdIndex.push(APSP_OnTaskReport_EVENT),this.m_arrCmd.push("OutboundReport"),this.m_arrCmdIndex.push(APSP_OutboundReport_EVENT),this.m_arrCmd.push("CallReportInfo"),this.m_arrCmdIndex.push(APSP_CallReportInfo_EVENT),this.m_arrCmd.push("QueryMonitorSumReport"),this.m_arrCmdIndex.push(APSP_QueryMonitorSumReport_EVENT),this.m_arrCmd.push("OnCallRing"),this.m_arrCmdIndex.push(APSP_OnCallRing_EVENT),this.m_arrCmd.push("OnHeatBeat"),this.m_arrCmdIndex.push(APSP_OnHeatBeat_EVENT),this.m_arrCmd.push("OnBarExit"),this.m_arrCmdIndex.push(APSP_OnBarExit_EVENT),this.m_arrCmd.push("OnSystemBusy"),this.m_arrCmdIndex.push(APSP_OnSystemBusy_EVENT),this.m_arrCmd.push("OnCallQueueQuery"),this.m_arrCmdIndex.push(APSP_OnCallQueueQuery_EVENT),this.m_arrCmd.push("OnQueueReport"),this.m_arrCmdIndex.push(APSP_OnQueueReport_EVENT),this.m_arrCmd.push("OnSystemMessage"),this.m_arrCmdIndex.push(APSP_OnSystemMessage_EVENT),this.m_arrCmd.push("OnRecvWeiboMsg"),this.m_arrCmdIndex.push(APSP_OnRecvWeiboMsg_EVENT),this.m_arrCmd.push("OnIMNoticsMsg"),this.m_arrCmdIndex.push(APSP_OnIMNoticsMsg_EVENT),this.m_arrCmd.push("OnIMTextMsg"),this.m_arrCmdIndex.push(APSP_OnIMTextMsg_EVENT),this.m_arrCmd.push("OnWallServiceReport"),this.m_arrCmdIndex.push(APSP_OnWallServiceReport_EVENT),this.m_arrCmd.push("OnWallQueueReport"),this.m_arrCmdIndex.push(APSP_OnWallQueueReport_EVENT),this.m_arrCmd.push("OnStaticInfoReport"),this.m_arrCmdIndex.push(APSP_OnStaticInfoReport_EVENT),this.m_arrCmd.push("OnRecvWeChatMsg"),this.m_arrCmdIndex.push(APSP_OnRecvWeChatMsg_EVENT),this.m_arrCmd.push("OnServiceStaticReport"),this.m_arrCmdIndex.push(APSP_OnServiceStaticReport_EVENT),this.m_arrCmd.push("OnAgentStaticReport"),this.m_arrCmdIndex.push(APSP_OnAgentStaticReport_EVENT),this.m_arrCmd.push("OnTrunkReport"),this.m_arrCmdIndex.push(APSP_OnTrunkReport_EVENT),this.m_arrCmd.push("OnTrunkSumReport"),this.m_arrCmdIndex.push(APSP_OnTrunkSumReport_EVENT),this.m_arrCmd.push("OnUploadFileToMMSReport"),this.m_arrCmdIndex.push(APSP_OnUploadFileToMMSReport_EVENT),this.m_arrCmd.push("OnDownloadFileToMMSReport"),this.m_arrCmdIndex.push(APSP_OnDownloadFileToMMSReport_EVENT),this.m_arrCmd.push("OnSendWeChatMsgReport"),this.m_arrCmdIndex.push(APSP_OnSendWeChatMsgReport_EVENT),this.m_arrCmd.push("OnAQueryCTIInfo"),this.m_arrCmdIndex.push(APSP_OnAQueryCTIInfo_EVENT),this.m_arrCmd.push("OnAgentBusyReason"),this.m_arrCmdIndex.push(APSP_OnAgentBusyReason_EVENT),this.m_arrCmd.push("OnAsrEventReport"),this.m_arrCmdIndex.push(APSP_OnAsrEventReport_EVENT),this.m_arrCmd.push("OnStopSmSuccess"),this.m_arrCmdIndex.push(APSP_OnStopSmSuccess_EVENT),this.m_arrCmd.push("OnUpdateMediaEvent"),this.m_arrCmdIndex.push(APSP_OnUpdateMediaEvent_EVENT),this.m_arrCmd.push("OnStopCaptureSuccess"),this.m_arrCmdIndex.push(APSP_OnStopCaptureSuccess_EVENT),this.m_arrCmd.push("OnModifyVideoStreamReport"),this.m_arrCmdIndex.push(APSP_OnModifyVideoStreamReport_EVENT),this.m_arrCmd.push("OnAction"),this.m_arrCmdIndex.push(APSP_OnAction_EVENT),this.m_arrCmd.push("OnSetDlgStatusText"),this.m_arrCmdIndex.push(APSP_OnSetDlgStatusText_EVENT),this.m_arrCmd.push("OnChangeBtnSerial"),this.m_arrCmdIndex.push(APSP_OnChangeBtnSerial_EVENT),this.m_arrCmd.push("Test"),this.m_arrCmdIndex.push(APSP_Test_CONF))};this.GetCmdName=function(a){for(var b=0;b<this.m_arrCmd.length;b++)if(this.m_arrCmdIndex[b]==a)return this.m_arrCmd[b];return""};this.GetCmdIndex=function(a){for(var b=0;b<this.m_arrCmd.length;b++)if(this.m_arrCmd[b]==a)return this.m_arrCmdIndex[b];return-1};this._APSPInit()}function JVccBarAssist(a){this.oBarBtnControl=new JBarBtnControl;this.oBarAgentStatus=new JBarAgentStatus(a);return this}function JBarBtnControl(){this._arrCmd=[];this._arrCmdIndex=[];this._type=0;this._getCmdID=function(a){for(var b=0;b<this._arrCmdIndex.length;b++)if(this._arrCmdIndex[b]==a)return this._arrCmd[b];return""};this._ChangeObject=function(a,b){1==a?0==this._type?b.disabled=!1:b.style.display="":0==this._type?b.disabled=!0:b.style.display="none"};this.AttachBtnByUIID=function(a,b){this._arrCmd.push(a);this._arrCmdIndex.push(b)};this.UpdateUI=function(a){a=a.split("|");for(var b=0;b<this._arrCmdIndex.length;b++){for(var c=this._arrCmdIndex[b],f=!1,g=0;g<a.length;g++)if(parseInt(a[g])==c){f=!0;break}c=this._getCmdID(c);""!=c&&(c=document.getElementById(c),null!=c&&this._ChangeObject(f,c))}};this.SetUpdateType=function(a){this._type=a};return this}function JBarAgentStatus(a){this._app=a;this._busySubStatusSelectedItem="";this._agentStatus=0;this._ring=!1;this._timerCount=0;this._timer=null;this._arrSubBusyIndex=[];this._arrSubBusyText=[];this.SetSubBusyStatus=function(a){this._arrSubBusyIndex.length=0;this._arrSubBusyText.length=0;a=a.split("$");for(var b=0;b<a.length;b++){var f=a[b].split("|");2==f.length&&(this._arrSubBusyIndex.push(parseInt(f[0])),this._arrSubBusyText.push(f[1]))}};this.SetRingFlag=function(a){this._ring=a};this.SetAgentStatus=function(a){if(this._agentStatus!=a||3==this._agentStatus||1==this._agentStatus)if(this._agentStatus=a,this._timerCount=0,0<this._agentStatus)this._BarBeginAgentStatusTimer();else{this._BarStopAgentStatusTimer();var b=this;setTimeout(function(){b.AgentStatusTimeSum()},1E3)}};this.OnAgentStatusTime=function(a,c,f){};this._BarBeginAgentStatusTimer=function(){if(null==this._timer){var a=this;this._timer=setInterval(function(){a.AgentStatusTimeSum()},1E3)}};this._BarStopAgentStatusTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};this.AgentStatusTimeSum=function(){this._timerCount+=1;-1==this._agentStatus&&(this._timerCount=0);this._showAgentStatusTimer()};this._getSubStatusText=function(){var a=this._app.oJVccBar.GetAgentSubBusyStatus();if(-1==a)this._busySubStatusSelectedItem="";else for(var c=0;c<this._arrSubBusyIndex.length;c++)if(this._arrSubBusyIndex[c]==a){this._busySubStatusSelectedItem=this._arrSubBusyText[c];break}};this._getTimerString=function(a){if(0==a)return"";var b=parseInt(a/3600),b=10>b?"0"+b:b,b="00"==b?"":b+":",f=parseInt(a%3600/60);a%=60;return b.toString()+(10>f?"0"+f:f).toString()+":"+(10>a?"0"+a:a).toString()};this._getTextByStatus=function(){return 1==this._agentStatus?(this._getSubStatusText(),""!=this._busySubStatusSelectedItem?this._busySubStatusSelectedItem:"\u5fd9\u788c"):2==this._agentStatus?"\u5c31\u7eea":3==this._agentStatus?this._ring?"\u632f\u94c3\u4e2d":"\u901a\u8bdd\u4e2d":4==this._agentStatus?"\u540e\u7eed\u6001":"\u672a\u767b\u5f55"};this._showAgentStatusTimer=function(){this.OnAgentStatusTime(this._agentStatus,this._getTextByStatus(),this._getTimerString(this._timerCount))};return this}function JWeChatMessageItem(){this.direction=0;this.msgseq=-1;this.timeStamp=this.data=this.title=this.eventKey=this.Event=this.recongnition=this.sessionUrl=this.content=this.msgType="";this.code=this.needMmcOpenData=0;this.sender=this.des="";return this}function JWechChatSession(){this.type="00";this.userNickName=this.sessionId="";this.sex="0";this.vccName=this.vccPublicId=this.userId=this.country=this.city=this.province="";this.msgSession=[];this.status=1;this.AddMessageItem=function(a,b,c,f,g,k,l,d,p,h,e,t){var n=this.GetMessageIndex(b);return-1==n?(n=new JWeChatMessageItem,n.sender=a,n.direction=n.sender==this.userId?0:1,n.msgseq=b,n.msgType=c,n.content=f,n.sessionUrl=g,n.recongnition=k,n.Event=l,n.eventKey=d,n.title=p,n.data=h,n.timeStamp=e,n.needMmcOpenData=t,this.msgSession.push(n),n):this.msgSession[n]};this.GetMessageCount=function(){return this.msgSession.length};this.GetMessageItemByIndex=function(a){return 0>a||a>=this.msgSession.length?null:this.msgSession[a]};this.GetMessageItem=function(a){a=this.GetMessageIndex(a);return-1==a?null:this.msgSession[a]};this.GetLastSendItem=function(){for(var a=this.msgSession.length-1;0<a;a--)if(this.msgSession[a].sender==this.vccPublicId&&1==this.msgSession[a].direction)return this.msgSession[a];return null};this.GetMessageIndex=function(a){for(var b=0;b<this.msgSession.length;b++)if(this.msgSession[b].msgseq==a)return b;return-1}}function JWechChatManager(){this._currentSession="";this.weChatSessions=[];this.arrSendFileName=[];this.arrSendFileSessionID=[];this.arrRecvFileName=[];this.arrRecvFileSessionID=[];this.arrRecvFileMsgseq=[];this.GetSessionIndexBySessionID=function(a){for(var b=0;b<this.weChatSessions.length;b++)if(this.weChatSessions[b].sessionId==a)return b;return-1};this.GetSessionIndexByUserId=function(a){for(var b=0;b<this.weChatSessions.length;b++)if(this.weChatSessions[b].userId==a)return b;return-1};this.SetUserInfo=function(a){a=a.split("|");if(6==a.length){var b=this.GetSessionItemByUserId(a[0]);null!=b&&(b.userNickName=GetGBKFromBase64(a[1]),b.sex=a[2],b.province=GetGBKFromBase64(a[3]),b.city=GetGBKFromBase64(a[4]),b.country=GetGBKFromBase64(a[5]),this.OnBeginSession(b.sessionId))}};this.GetSessionItemByUserId=function(a){a=this.GetSessionIndexByUserId(a);return-1==a?null:this.weChatSessions[a]};this.AddSessionItem=function(a,b,c,f){if(-1==this.GetSessionIndexBySessionID(a,c,f)){var g=new JWechChatSession;g.type=b;g.sessionId=a;g.userId=c;g.vccPublicId=f;this.weChatSessions.push(g);return g}return null};this.OnSaveRecvMessageReport=function(a,b,c,f,g,k,l,d,p,h,e,t,n,x){h=this.GetSessionItemBySessionID(a);null==h&&(this._currentSession=a,h=this.AddSessionItem(a,c,f,g));null!=h&&(h.AddMessageItem(f,b,k,l,d,p,Event,e,t,n,x,0),"begin"==k?this.app.oJVccBar.GetJVccBarType()==vccBarTypeHTML5?this.app.oJVccBar.GetWeChatParam(f):this.SetUserInfo(this.app.oJVccBar.GetWeChatParam(f)):"end"==k?this.OnEndSession(a):this.OnRecvMessage(a,b))};this.OnSaveSendMessageReport=function(a,b,c,f,g,k){a=this.GetSessionItemBySessionID(b);null!=a&&(a=a.GetLastSendItem(),null!=a&&(a.code=f,a.des=g,a.timeStamp=k,a.msgseq=c,this.OnSendMessageReport(b,c)))};this.SaveSendMessage=function(a,b,c,f,g,k,l,d,p,h){a=this.GetSessionItemBySessionID(a);null!=a&&a.AddMessageItem(f,-1,g,k,l,"","","",d,p,"",h)};this.OnInvokeUploadFileToMMSReport=function(a,b,c){if(1==b||2==b)for(var f=0;f<this.arrSendFileName.length;f++)if(this.arrSendFileName[f]==a){this.OnUploadFileStatus(this.arrSendFileSessionID[f],b,c);this.arrSendFileSessionID.splice(f,1);this.arrSendFileName.splice(f,1);break}};this.OnInvokeDownFileFromMMSReport=function(a,b,c,f){if(1==b||2==b)for(var g=0;g<this.arrRecvFileName.length;g++)if(this.arrRecvFileName[g]==a&&this.arrRecvFileMsgseq[g]==f){this.OnDowndFileStatus(this.arrRecvFileSessionID[g],this.arrRecvFileMsgseq[g],b,c);this.arrRecvFileSessionID.splice(g,1);this.arrRecvFileName.splice(g,1);this.arrRecvFileMsgseq.splice(g,1);break}};this.SendTextMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&this.app.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"text",b,"","","",0)};this.SendImageMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&this.app.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"image","",b,"","",0)};this.SendVoiceMessage=function(a,b){""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&this.app.oJVccBar.SendWeChatMsg(a,c.type,c.userId,c.vccPublicId,"voice","",b,"","",0)};this.SendVedioMessage=function(a,b,c){""==a&&(a=this._currentSession);var f=this.GetSessionItemBySessionID(a);null!=f&&this.app.oJVccBar.SendWeChatMsg(a,f.type,f.userId,f.vccPublicId,"vedio","",b,c,"",0)};this.SendFormatMessage=function(a,b,c,f){""==a&&(a=this._currentSession);var g=this.GetSessionItemBySessionID(a);null!=g&&this.app.oJVccBar.SendWeChatMsg(a,g.type,g.userId,g.vccPublicId,"notice","","",b,c,f)};this.EndMessage=function(a){""==a&&(a=this._currentSession);var b=this.GetSessionItemBySessionID(a);null!=b&&this.app.oJVccBar.SendWeChatMsg(a,b.type,b.userId,b.vccPublicId,"end","","","","",0)};this.UploadFileToMMS=function(a,b){if(""==b)return 0;""==a&&(a=this._currentSession);var c=this.GetSessionItemBySessionID(a);null!=c&&(this.arrSendFileName.push(b),this.arrSendFileSessionID.push(a),this.app.oJVccBar.UploadFileToMMS(b,c.userId,c.vccPublicId));return 0};this.DownFileFromMMS=function(a,b,c){if(""==c)return 0;""==a&&(a=this._currentSession);var f=this.GetSessionItemBySessionID(a);null!=f&&(this.arrRecvFileName.push(c),this.arrRecvFileSessionID.push(a),this.arrRecvFileMsgseq.push(b),this.app.oJVccBar.DownFileFromMMS(c,f.userId,f.vccPublicId,a,b));return 0};this.GetSessionItemBySessionID=function(a){a=this.GetSessionIndexBySessionID(a);return-1==a?null:this.weChatSessions[a]};this.GetSessionItem=function(a,b){var c=this.GetSessionItemBySessionID(a);if(null!=c)for(var f=0;f<c.GetMessageCount();f++){var g=c.GetMessageItemByIndex(f);if(g.msgseq==b)return g}return null};this.OnBeginSession=function(a){};this.OnEndSession=function(a){};this.OnRecvMessage=function(a,b){};this.OnSendMessageReport=function(a,b){};this.OnUploadFileStatus=function(a,b,c){};this.OnDowndFileStatus=function(a,b,c,f){}}var eventOnCallRing=0,eventOnAnswerCall=1,eventOnCallEnd=2,eventOnPrompt=3,eventOnReportBtnStatus=4,eventOnInitalSuccess=5,eventOnInitalFailure=6,eventOnEventPrompt=7,eventOnAgentWorkReport=8,eventOnCallDataChanged=9,eventOnBarExit=10,eventOnCallQueueQuery=11,eventOnQueryGroupAgentStatus=12,eventOnSystemMessage=13,eventOnRecvWeiboMsg=14,eventOnIMMessage=15,eventOnRecvWeChatMessage=16,eventOnSendWeChatMsgReport=17,eventOnUploadFileToMMSReport=18,eventOnDownloadFileToMMSReport=19,eventOnServiceStaticReport=20,eventOnAQueryCTIInfoReport=21,eventOnAgentBusyReasonReport=22,eventOnAgentLogUploadReport=23,eventOnAsrEventReport=24,eventOnStopSmSuccess=25,eventOnGetVersionReport=26,eventOnSessinMessage=27,eventOnUpdateMediaEvent=28,eventOnSnapShotPngEvent=29,eventOnStopCaptureSuccess=30,eventOnModifyVideoStreamReport=31,eventOnVideoWndStatusReport=32,eventOnAgentReport=60,eventOnTelReport=eventOnAgentReport+1,eventOnServiceReport=eventOnAgentReport+2,eventOnIvrReport=eventOnAgentReport+3,eventOnTaskReport=eventOnAgentReport+4,eventOnOutboundReport=eventOnAgentReport+5,eventOnCallReportInfo=eventOnAgentReport+6,eventOnQueueReport=eventOnAgentReport+7,eventOnQueryMonitorSumReport=eventOnAgentReport+8,eventOnWallServiceReport=eventOnAgentReport+9,eventOnWallQueueReport=eventOnAgentReport+10,eventOnWorkStaticInfoReport=eventOnAgentReport+11,eventOnAgentStaticReport=eventOnAgentReport+13,eventOnTrunkReport=eventOnAgentReport+14,eventOnTrunkSumReport=eventOnAgentReport+15,eventOnMMServiceReport=eventOnAgentReport+16,eventOnWebsocketSocket=90,lg_zhcn="zh-cn",lg_english="en-us",g_JsVersion="1.0.0.42",g_JsVersionTimer="20220411";function GetLanguageItem(a,b,c){return a==lg_zhcn?b:c}function CErrorItem(){this.code=0;this.description="";this.level=0;this.engshDes="";return this}function CHtmlBarControl(a){this._language=a;this._arrErrorInfo=[];this._loadErrorInfo=function(){this._addItem(2100,0,"\u6d88\u606f\u672a\u5b9a\u4e49","message not defined");this._addItem(2101,2,"\u6d88\u606f\u53c2\u6570\u5f02\u5e38","parameter error");this._addItem(2102,2,"\u6d88\u606f\u53d1\u9001\u5931\u8d25","send message failure");this._addItem(2110,2,"\u5ea7\u5e2d\u4e0d\u5b58\u5728","agent not exist");this._addItem(2111,2,"\u5ea7\u5e2d\u6682\u505c\u4f7f\u7528","agent unusefull temporary");this._addItem(2112,2,"\u5ea7\u5e2d\u5bc6\u7801\u9a8c\u8bc1\u9519\u8bef","wrong agent password");this._addItem(2113,2,"\u5ea7\u5e2d\u5bc6\u7801\u672a\u751f\u6548","agent password uneffective");this._addItem(2114,2,"\u5ea7\u5e2d\u5bc6\u7801\u5df2\u8fc7\u671f","agent password overdue");this._addItem(2115,2,"\u5ea7\u5e2d\u5df2\u9501\u5b9a","agent locked");this._addItem(2116,2,"\u5ea7\u5e2d\u65f6\u95f4\u6233\u4e0d\u5339\u914d","agent timestamp mismatching");this._addItem(2117,2,"\u5ea7\u5e2d\u767b\u5f55\u5206\u673a\u548c\u7ed1\u5b9a\u5206\u673a\u4e0d\u5339\u914d","agent'd device is mismatching with binded device");this._addItem(2118,2,"\u5ea7\u5e2d\u6240\u7528\u5206\u673a\u5df2\u88ab\u5176\u4ed6\u5ea7\u5e2d\u767b\u5f55","agent'd device is used by other");this._addItem(2119,1,"\u5ea7\u5e2d\u5df2\u767b\u5f55","agent signined");this._addItem(2120,2,"\u5ea7\u5e2d\u4e0d\u5141\u8bb8\u88ab\u66ff\u4ee3","agent can't be replaced");this._addItem(2121,1,"\u5ea7\u5e2d\u672a\u767b\u5f55","agent have not been signined");this._addItem(2122,1,"\u5ea7\u5e2d\u5fd9","agent busy");this._addItem(2123,2,"\u767b\u5f55\u5931\u8d25\uff1a\u6b64\u5ea7\u5e2d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\u4e14\u6b63\u5728\u901a\u8bdd\u4e2d","signing failuer:this agent is called by other");this._addItem(2124,2,"\u767b\u5f55\u5931\u8d25\uff1a\u6b64\u5ea7\u5e2d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\u4e14\u540e\u5904\u7406\u4e2d","signing failuer:this agent is wrapup by other");this._addItem(2125,1,"\u5ea7\u5e2d\u672a\u7a7a\u95f2","agent not idle");this._addItem(2126,1,"\u5ea7\u5e2d\u672a\u63a5\u901a","agent not connected");this._addItem(2130,2,"\u5bf9\u65b9\u5ea7\u5e2d\u4e0d\u5b58\u5728","opponent agent not exist");this._addItem(2131,2,"\u5bf9\u65b9\u5ea7\u5e2d\u6682\u505c\u4f7f\u7528","opponent agent unusefull temporary");this._addItem(2132,2,"\u5bf9\u65b9\u5ea7\u5e2d\u5df2\u9501\u5b9a","opponent agent locked");this._addItem(2133,2,"\u5bf9\u65b9\u5ea7\u5e2d\u5206\u673a\u672a\u8bbe\u7f6e","opponent agent's device not set");this._addItem(2134,1,"\u5bf9\u65b9\u5ea7\u5e2d\u672a\u767b\u5f55","opponent agent not signin");this._addItem(2135,1,"\u5bf9\u65b9\u5ea7\u5e2d\u5fd9","opponent agent busy");this._addItem(2136,1,"\u5bf9\u65b9\u5ea7\u5e2d\u901a\u8bdd\u4e2d","opponent agent calling");this._addItem(2137,1,"\u5bf9\u65b9\u5ea7\u5e2d\u540e\u5904\u7406\u4e2d","opponent agent wrapup");this._addItem(2138,1,"\u5bf9\u65b9\u5ea7\u5e2d\u7a7a\u95f2","opponent agent idle");this._addItem(2140,1,"\u5206\u673a\u901a\u8bdd\u4e2d","agent'device calling");this._addItem(2141,2,"\u5206\u673a\u672a\u8bbe\u7f6eIVR\u670d\u52a1","device not set IVR service");this._addItem(2142,2,"\u4f01\u4e1a\u5df2\u6682\u505c\u6216\u65e0\u6b64\u4f01\u4e1a","department invalid");this._addItem(2143,2,"\u5ea7\u5e2d\u767b\u5f55\u8fbe\u5230\u6700\u5927\u9650\u5236","signined agent count over limit");this._addItem(2144,2,"\u5ea7\u5e2d\u5206\u673a\u4e0d\u662fcti\u53d7\u63a7","agent'device don't control by cti");this._addItem(2150,2,"\u5ea7\u5e2d\u5df2\u88ab\u9009\u4e2d","agent already selected");this._addItem(2151,2,"\u5ea7\u5e2d\u88ab\u8d28\u68c0\u5458\u5f3a\u5236\u7b7e\u51fa","agent forceouted by monitor agent");this._addItem(2152,2,"\u5ea7\u5e2d\u56e0\u632f\u94c3\u8d85\u65f6\u88ab\u5f3a\u5236\u7b7e\u51fa","agent forceouted for alerting out of time");this._addItem(2153,2,"\u5ea7\u5e2d\u88ab\u8bdd\u673a\u547d\u4ee4\u5f3a\u5236\u7b7e\u51fa","agent forceouted by phone command");this._addItem(2160,2,"\u5ea7\u5e2d\u5fc3\u8df3\u8d85\u65f6cti\u53d1\u9001OnSignOuted\u4e8b\u4ef6","cti send OnSignOuted to agent for heartbeat overtime");this._addItem(2161,2,"\u5ea7\u5e2d\u6536\u5230AgentReport\u53d1\u73b0\u5750\u5e2d\u7b7e\u51facti\u53d1\u9001OnSignOuted\u4e8b\u4ef6","cti send OnSignOuted to agent for AgentReport message");this._addItem(2162,2,"\u5ea7\u5e2d\u4e0d\u5728\u5916\u547c\u4efb\u52a1\u4e2d\u9884\u8bbe\u5ea7\u5e2d\u5217\u8868\u4e2d","This agent is not in outtask's pre-setting agent list!");this._addItem(2300,2,"\u5ea7\u5e2d\u767b\u5f55\u8d28\u68c0\u670d\u52a1\u9a8c\u8bc1\u9519\u8bef","monitor login failure for wrong password");this._addItem(websocket_guard_connecting,2,"\u6b63\u5728\u8fde\u63a5\u7535\u8bdd\u6761\u536b\u58eb\u3010{0}:{1}\u3011...\u7b2c\u3010{2}\u3011\u6b21","connecting CINGuard [{0}:{1}]...times:[{2}]");this._addItem(websocket_guard_connected,2,"\u8fde\u63a5\u7535\u8bdd\u6761\u536b\u58eb\u6210\u529f","connect CINGurad success");this._addItem(websocket_guard_colsed,2,"\u7535\u8bdd\u6761\u536b\u58eb\u8054\u7cfb\u65ad\u5f00","disconnected to CINGurad");this._addItem(websocket_guard_remoteserver_disconnected,2,"\u7535\u8bdd\u6761\u536b\u58eb\u548c\u5ea7\u5e2d\u65ad\u5f00","ie client and CINGuard disconnected");this._addItem(websocket_connecting,2,"\u6b63\u5728\u8fde\u63a5\u7535\u8bdd\u6761\u670d\u52a1\u3010{0}:{1}\u3011...\u7b2c\u3010{2}\u3011\u6b21","connecting Maccard [{0}:{1}]...times:[{2}]");this._addItem(websocket_connected,2,"\u8fde\u63a5\u7535\u8bdd\u6761\u670d\u52a1\u6210\u529f","connect Maccard success");this._addItem(websocket_closed,2,"\u65ad\u5f00\u7535\u8bdd\u6761\u670d\u52a1\u6210\u529f!","close Maccard success");this._addItem(websocket_remoteserver_disconnected,2,"\u548c\u7535\u8bdd\u6761\u670d\u52a1\u4e4b\u95f4\u8fde\u63a5\u65ad\u5f00\uff01","disconnect Maccard success");this._addItem(4E3,2,"\u521b\u5efaA\u670d\u52a1\u7c7b\u5931\u8d25","create AClass failuer");this._addItem(4001,2,"CTI Interface\u670d\u52a1\u5668\u65e0\u6cd5\u8bbf\u95ee!","Can not Connect to CTI Interface server");this._addItem(4002,2,"\u65e0\u6cd5\u8fde\u63a5CTI\u670d\u52a1\u5668!","Can not connect to CTI server");this._addItem(4003,2,"CTI Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","invoke Initial failure in CTI Interface");this._addItem(4004,2,"\u767b\u5f55CTI\u670d\u52a1\u5668\u5931\u8d25,\u786e\u8ba4CTI\u53ef\u7528\u6216\u8005\u914d\u7f6e\u4fe1\u606f\u662f\u5426\u6210\u529f!","login cti failure,be sure cti server is ok and congfiguration is right");this._addItem(4005,2,"\u7531\u4e8e\u7f51\u7edc\u539f\u56e0\u5ea7\u5e2d\u548cCTI\u65ad\u5f00\uff0c\u8bf7\u4e0d\u8981\u6302\u673a\uff0c3S\u540e\u91cd\u65b0\u8fde\u63a5!","agent disconnect temporary cause by network,it will be reconnect after ten seconds");this._addItem(4006,2,"\u5ea7\u5e2d\u6b63\u5728\u91cd\u8fde...","agent reconnecting ...");this._addItem(4007,0,"\u91cd\u8fde\u6210\u529f,\u5ea7\u5e2d\u5c31\u7eea\u53ef\u4ee5\u91cd\u65b0\u4f7f\u7528!","reconnected success! the agent is already ok");this._addItem(4008,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4\u5ea7\u5e2d\u548cCTI\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u548c\u7ba1\u7406\u5458\u8054\u7cfb!","agent is signout from cti cause of network,please get help for administrator");this._addItem(4009,2,"\u5fc3\u8df3\u68c0\u6d4b\u5230CTI\u4e2d\u5ea7\u5e2d\u5df2\u7ecf\u9000\u51fa!","agent is signout by heartbeat checking");this._addItem(4010,1,"\u5ea7\u5e2d\u8bbe\u7f6e\u7684phoneType\u7c7b\u578b\u548c\u670d\u52a1\u5668\u7aef\u8bbe\u7f6e\u4e0d\u4e00\u6837\uff0c\u4f7f\u7528\u670d\u52a1\u5668\u7aef\u8bbe\u7f6e\u7684\u7535\u8bdd\u7c7b\u578b","phoneType mismatch with server's,using server's setting");this._addItem(4011,2,"\u7f51\u7edc\u4e0d\u7a33\u5b9a\uff0c\u5ea7\u5e2d\u4fee\u590d\u4e2d...","net error agent repairing ...");this._addItem(4012,2,"UC\u5e73\u53f0\u5bf9\u5e94[TaskId:{0}]\u914d\u7f6e\u53c2\u6570\u4e3a\u7a7a","Unified platform param is empty of [taskID:{0}]");this._addItem(4013,2,"UC CTI Interface\u670d\u52a1\u5668\u65e0\u6cd5\u8bbf\u95ee!","Cannot access to UC CTI Interface server");this._addItem(4014,2,"\u65e0\u6cd5\u8fde\u63a5UC CTI\u670d\u52a1\u5668!","Cannot access to UC CTI server");this._addItem(4015,2,"UC CTI Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","The UC CTI interface\u2019s initial method is failed");this._addItem(4300,2,"A\u63a5\u53e3\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","CINNGCCA not register");this._addItem(4301,2,"PA\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","PA not register");this._addItem(4302,2,"M\u63a7\u4ef6\u6ca1\u6709\u6ce8\u518c\u6216\u8005\u8def\u5f84\u4e0d\u5bf9!","CINMonitor not register");this._addItem(4303,2,"CTI\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb!","disconnect from cti,please get help for administrator");this._addItem(4305,2,"\u672c\u5ea7\u5e2d\u88ab\u5176\u4ed6\u7ec8\u7aef\u6240\u66ff\u4ee3!","agent replaced by other");this._addItem(4309,2,"\u7535\u8bdd\u6ce8\u518c\u5931\u8d25!","sipphone register failure");this._addItem(4310,2,"\u8bf7\u521d\u59cb\u5316\u63a7\u4ef6!","please initial the ocx");this._addItem(4311,2,"\u547d\u4ee4\u4e0d\u53ef\u7528,\u65e0\u6cd5\u6267\u884c!","method disanble,can't execute");this._addItem(4312,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u80fd\u4e3a\u7a7a!","target number can't be empty");this._addItem(4313,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u5408\u6cd5!","target number unvalidated ");this._addItem(4314,2,"\u76ee\u6807\u53f7\u7801\u4e0d\u80fd\u8d85\u8fc764\u4f4d","target number can't be more then 64 character");this._addItem(4315,2,"\u5ea7\u5e2d\u88abUnInitial","agent is UnInitialed");this._addItem(4316,1,"sip\u6ce8\u518c\u9519\u8bef\u7801:","sip error code:");this._addItem(4360,0,"\u6b63\u5728\u6ce8\u518cSip\u7535\u8bdd...","sipphone regsitering...");this._addItem(4361,0,"\u7535\u8bdd\u6ce8\u518c\u6210\u529f!","sipphone regsitered success");this._addItem(4362,0,"\u6b63\u5728\u68c0\u6d4b\u5230\u5ea7\u5e2d\u5361...","checking agent card...");this._addItem(4363,2,"\u6ca1\u6709\u68c0\u6d4b\u5230\u5ea7\u5e2d\u5361!","ageng card not checked");this._addItem(4364,1,"\u8bbe\u7f6eftp\u670d\u52a1\u5668\u4fe1\u606f\u5931\u8d25!","ftp config wrong");this._addItem(4400,0,"\u7b7e\u5165CTI\u670d\u52a1\u5668\u6210\u529f!","agent signin success");this._addItem(4401,2,"\u7b7e\u5165CTI\u670d\u52a1\u5668\u5931\u8d25!","agent signin failure");this._addItem(4402,0,"\u7b7e\u51faCTI\u670d\u52a1\u5668\u6210\u529f!","agent signout success");this._addItem(4403,0,"\u7b7e\u51faCTI\u670d\u52a1\u5668\u5931\u8d25!","agent signout failure");this._addItem(4404,2,"\u5ea7\u5e2d\u88ab\u5f3a\u5236\u8fc1\u51fa!","agent force signout");this._addItem(4405,2,"\u5ea7\u5e2d\u5df2\u7ecf\u88ab\u9501\u5b9a,\u8bf7\u8054\u7cfb\u8d28\u68c0\u5e2d\u89e3\u9501!","agent locked,please contact with monitor agent");this._addItem(4407,1,"\u6b63\u5728\u5411CTI\u670d\u52a1\u5668\u6ce8\u518c...","sigining to cti server...");this._addItem(4408,0,"\u6b63\u5728\u5411Monitor\u670d\u52a1\u5668\u6ce8\u518c...","logining to monitor server...");this._addItem(4409,0,"\u6ce8\u518cMonitor\u6210\u529f!","login monitor server success");this._addItem(4410,0,"\u7535\u8bdd\u6761\u521d\u59cb\u5316\u6210\u529f!","cinvccbar initial success");this._addItem(4411,2,"\u7535\u8bdd\u6761\u521d\u59cb\u5316\u5931\u8d25!","cinvccbar initial failure");this._addItem(4412,0,"\u6b63\u5728\u5411\u5907\u7528CTI\u670d\u52a1\u5668\u6ce8\u518c...","sigining to backup cti server...");this._addItem(4413,0,"\u6b63\u5728\u5411\u5907\u7528Monitor\u670d\u52a1\u5668\u6ce8\u518c...","logining to backup monitor server...");this._addItem(4415,1,"\u7f51\u7edc\u4e0d\u7a33\u5b9a\uff0c\u7535\u8bdd\u6761\u4fee\u590d\u6210\u529f!","net error and agent repaired");this._addItem(4416,0,"\u5ea7\u5e2d\u7b7e\u5165\u4e2d...","agent is signing ...");this._addItem(4417,2,"\u60a8\u5df2\u7ecf\u542f\u52a8\u767b\u5f55\u4e00\u4e2a\u5ea7\u5e2d\u4e86\uff0c\u7981\u6b62\u767b\u5f55\u53e6\u4e00\u4e2a\u4e0d\u540c\u8d26\u53f7\u7684\u5ea7\u5e2d!","only one agent can be used in one computer!");this._addItem(4418,0,"CINScreenRecord.exe\u4e0d\u5b58\u5728,\u65e0\u6cd5\u5f55\u5c4f!","CINScreenRecord.exe not exist,can not record screen!");this._addItem(4419,0,"\u6b63\u5728\u5f55\u5c4f...","recording screen...");this._addItem(4420,0,"\u7ed3\u675f\u5f55\u5c4f,\u6b63\u5728\u4e0a\u4f20\u6587\u4ef6...","stop record screen,upload the record file...");this._addItem(4421,0,"\u4e0a\u4f20\u5f55\u5c4f\u6587\u4ef6\u6210\u529f!","upload the record file success!");this._addItem(4422,0,"\u4e0a\u4f20\u5f55\u5c4f\u6587\u4ef6\u5931\u8d25,\u7f13\u5b58\u7eed\u4f20!","upload the record file failure,cache for upload again!");this._addItem(4423,0,"\u5411\u4e3b\u670d\u52a1\u5668\u4e0a\u6ce8\u518c","register to main server.....");this._addItem(4424,0,"\u5411\u5907\u670d\u52a1\u5668\u4e0a\u6ce8\u518c","register to back server.....");this._addItem(4450,0,"\u5ea7\u5e2d\u5df2\u7ecf\u88ab\u62e6\u622a!","agent intercepted");this._addItem(4451,1,"\u6ca1\u6709\u8981\u88ab\u63a5\u56de\u7684\u5bf9\u8c61!","have no retrieved line");this._addItem(4452,1,"\u5916\u547c\u5fc5\u987b\u5fd9\u788c\u4e0b\u624d\u80fd\u8fdb\u884c!","makeout must be use in busy");this._addItem(4453,1,"\u6ca1\u6709\u901a\u8bdd,\u4e0d\u80fd\u8f6c\u79fb...","can't transfer out of call");this._addItem(4454,1,"\u53ea\u6709\u4e24\u4e2a\u4eba\u901a\u8bdd\u7684\u65f6\u5019\u624d\u80fd\u6267\u884c\u6b64\u547d\u4ee4...","can only be executed in tow line");this._addItem(4455,1,"\u666e\u901a\u72b6\u6001\u4e0b,\u4e8c\u6b21\u62e8\u53f7\u7801\u5fc5\u987b\u57280-15\u4e4b\u95f4!","the code must be from 0 to 15 in senddtmf");this._addItem(4456,1,"\u7528\u6237\u5df2\u6302\u673a","user have been out of call");this._addItem(4457,1,"\u8bf7\u5feb\u70b9\u670d\u52a1,\u6240\u6709\u5750\u5e2d\u90fd\u5fd9\u788c!","hurry! all agents are busy");this._addItem(4458,1,"Mute\u5fc5\u987b\u901a\u8bdd\u4e0b\u624d\u80fd\u8fdb\u884c!","mute can only be execute in call");this._addItem(4459,2,"\u5ba2\u6237\u7aef\u63a5\u901ayealink\u8bdd\u673a\u7684\u5931\u8d25!","yealink phone pickup failure in client type");this._addItem(4460,1,"\u4f1a\u8bae\u6216\u8005\u54a8\u8be2\u65f6\u4e0d\u80fd\u6302\u65ad\u4e3b\u63a7\u5ea7\u5e2d!","the master agent can't be disconnect in conferece or consult scene");this._addItem(4600,2,"\u521b\u5efaM\u670d\u52a1\u7c7b\u5931\u8d25!","create M class failure");this._addItem(4601,2,"Monitor Interface\u7684Initail\u65b9\u6cd5\u8c03\u7528\u5931\u8d25!","Initail to Monitor Interface failure");this._addItem(4602,2,"Monitor\u670d\u52a1\u5668\u5730\u5740\u9519\u8bef\u6216\u8005\u6ca1\u6709\u542f\u52a8!","Monitor server  can't be use");this._addItem(4603,2,"Monitor Interface\u670d\u52a1\u5668\u5730\u5740\u9519\u8bef\u6216\u8005\u6ca1\u6709\u542f\u52a8!","Monitor Interface  can't be use");this._addItem(4604,2,"\u767b\u5f55(Login)Monitor\u670d\u52a1\u5668\u5931\u8d25!","login in Monitor server failure");this._addItem(4605,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4Monitor\u548c\u670d\u52a1\u5668\u65ad\u5f00,5\u540e\u91cd\u65b0\u8fde\u63a5....","agent disconnect from monitor server by network,will reconnect in 5 minutes");this._addItem(4606,2,"Monitor\u6b63\u5728\u548c\u670d\u52a1\u5668\u91cd\u65b0\u8fde\u63a5....","monitor is reconnecting...");this._addItem(4607,2,"\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0\u7f51\u7edc\u4e2d\u65ad,\u5bfc\u81f4Monitor\u548c\u670d\u52a1\u5668\u65ad\u5f00,\u8bf7\u548c\u7ba1\u7406\u5458\u8054\u7cfb!","monitor can't be connected with server by network,please contact to admin");this._addItem(4608,2,"Monitor\u91cd\u8fde\u6210\u529f,\u76d1\u63a7\u5ea7\u5e2d\u5c31\u7eea\u53ef\u4ee5\u91cd\u65b0\u4f7f\u7528!","monitor reconnect success,it works")};this._addItem=function(a,c,f,g){var b=new CErrorItem;b.code=a;b.level=c;b.description=f;b.engshDes=g;this._arrErrorInfo.push(b)};this.GetErrorItemDes=function(a){for(var b=0;b<this._arrErrorInfo.length;b++)if(this._arrErrorInfo[b].code==a)return this._language==lg_zhcn?this._arrErrorInfo[b].description:this._arrErrorInfo[b].engshDes;return""};this._loadErrorInfo();return this}var emInitNull=-1,emInitParamError=emInitNull+1,emInitSuccess=emInitNull+2,emInitSIPError=emInitNull+3,emInitMaccardError=emInitNull+4,emInitCTIError=emInitNull+5,emInitMonitorError=emInitNull+6,emCmdLogout=emInitNull+7,emCTIDisconneted=emInitNull+8,emMonitorDisconneted=emInitNull+9,emSipDisconneted=emInitNull+10,emServerDisconnected=emInitNull+11,emClientDisconnected=emInitNull+12,emExChangeAgentDisconnected=emInitNull+13,em_Bar_Unitial=0,em_Bar_Initialing=em_Bar_Unitial+1,em_Bar_Initialed=em_Bar_Unitial+2,em_Bar_Reconnecting=em_Bar_Unitial+3,emBtnWrapUp=0,emBtnSetBusy=emBtnWrapUp+1,emBtnSetIdle=emBtnWrapUp+2,emBtnMakeCall=emBtnWrapUp+3,emBtnHold=emBtnWrapUp+4,emBtnRetrieve=emBtnWrapUp+5,emBtnEndCall=emBtnWrapUp+6,emBtnTransfer=emBtnWrapUp+7,emBtnConference=emBtnWrapUp+8,emBtnPickUp=emBtnWrapUp+9,emBtnTransferOut=emBtnWrapUp+10,emBtnConsult=emBtnWrapUp+11,emBtnSendDtmf=emBtnWrapUp+12,emBtnBridge=emBtnWrapUp+13,emBtnAlterNate=emBtnWrapUp+14,emBtnConfig=emBtnWrapUp+15,emBtnForceReset=emBtnWrapUp+16,emBtnRecord=emBtnWrapUp+17,emBtnStopRecord=emBtnWrapUp+18,emBtnListen=emBtnWrapUp+19,emBtnInsert=emBtnWrapUp+20,emBtnIntercept=emBtnWrapUp+21,emBtnForceRelease=emBtnWrapUp+22,emBtnBeginPlay=emBtnWrapUp+23,emBtnStopPlay=emBtnWrapUp+24,emBtnLock=emBtnWrapUp+25,emBtnUnLock=emBtnWrapUp+26,emBtnMute=emBtnWrapUp+27,emBtnCallBack=emBtnWrapUp+28,emBtnReCall=emBtnWrapUp+29,emBtnHelp=emBtnWrapUp+30,emBtnConnect=emBtnWrapUp+31,CD_IVR_CALLIN=0,CD_SERVRE_EXACT_CALLOUT=1,CD_PREVIEW_CALLOUT=2,CD_AGENT_OUTSIDE_CALLOUT=3,CD_IVR_CALLOUT=4,CD_AGENT_INSIDE_CALLOUT=5,CD_CONSULT_CALLOUT=6,CD_SINGLE_CALLOUT=7,CD_BRIDGE_CALLOUT=8,CD_MONITOR_CALLIN=9,CD_INTERCEPT_CALLIN=10,CD_INSERT_CALLIN=11,CD_STEPBYSTEP_CALLOUT=12,CD_FORECAST_CALLOUT=13,CD_EXACT_PREVIEW_CALLOUT=14,CD_HELP_CALLIN=19,PORT_COUNT=5,barStatus_Null=0,barStatus_AgentConnecting=5,barStatus_AgentConnected=6,barStatus_AgentDisconnecting=7,barStatus_AgentDisconnected=8,RECONNECT_AGENT_TIME_ID=10,SETAGENTSTATUS_AGENT_TIME_ID=12,ASAP_HEARTBEAT_TIME_ID=14,ASAP_SEND_BUFFER_TIME_ID=15;function JHTML5Ctrl(){this.oGuardCtrl=this.responseCallBack=this.eventCallBack=this.oApspWS=this.oAgentInfo=null;this._connectCount=0;this._arrBtnStatus=[];this._oTimer=null;this.PngData=[];this._load=function(){this.oAgentInfo=new JAgentInfo;this.oAgentInfo.loadFromLocal();this.oApspWS=new JAPSPWebSocket("MacCard");this.oApspWS.oParent=this;this.oApspWS.SetMsgCallBack(this.apspCallback);this.oGuardCtrl=new JGuardCtrl(this.oAgentInfo._localserver,this.oAgentInfo._localGuardPort);this.oGuardCtrl.oParent=this;this.oGuardCtrl.SetCallBack(this.guardCallback);this._oTimer=new JTimer;this._oTimer.oParent=this;this._oTimer.SetTimerCallBack(this._OnTimerEvent);this._oTimer.Start();for(var a=0;a<emBtnHelp+1;a++)this._arrBtnStatus.push(0);this._arrBtnStatus[emBtnWrapUp]=1;this._arrBtnStatus[emBtnConfig]=1;this._oTimer.SetTimer(500,5E3)};this._IsNeedReConnected=function(){var a;return a=(a=(a=!this.oAgentInfo._isConnected)||!this.oAgentInfo._isInitial)||this.oAgentInfo._barStatus!=em_Bar_Initialing&&this.oAgentInfo._isReConnect};this._OnTimerEvent=function(a){var b=this.oParent;a==RECONNECT_AGENT_TIME_ID&&(DisplayLog(VccBar_Log_Info,"--------ReconnectAgent-------"),b._IsNeedReConnected()&&b.Initial());a==SETAGENTSTATUS_AGENT_TIME_ID&&(b._oTimer.KillTimer(a),b.oAgentInfo._isConnected&&(1==b.oAgentInfo._agentOldStatus&&b.SetBusy(0),2==b.oAgentInfo._agentOldStatus&&b.SetIdle(),4==b.oAgentInfo._agentOldStatus&&b.SetWrapUp()),b.oAgentInfo._agentOldStatus=-2);a==ASAP_HEARTBEAT_TIME_ID&&1==b.oAgentInfo._isConnected&&b._HeartBeat();a==ASAP_SEND_BUFFER_TIME_ID&&1==b.oAgentInfo._isConnected&&b.oApspWS.ReWSSendMsg()};this._HeartBeat=function(){if(0>=this.oApspWS.WSSbufferSize())return this.oApspWS.WSSendMsg(buildApspMsg("HeartBeat",""))};this._ResetBtn=function(){for(var a=0;a<emBtnHelp+1;a++)this._arrBtnStatus[a]=0};this._invokeEvent=function(a,b){null!=this.eventCallBack&&(DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:_invokeEvent(cmdIndex\x3d"+a+"  param\x3d"+b+")"),this.eventCallBack(a,b),a==eventOnInitalSuccess&&0==this.oAgentInfo._autoUpdateConfig&&this._InvokeMethod(APSP_GetConfiguration_CONF,""))};this._getPartenerNum=function(a){var b="";a=a.split("|");switch(parseInt(a[5])){case CD_IVR_CALLIN:case CD_SERVRE_EXACT_CALLOUT:case CD_SINGLE_CALLOUT:case CD_STEPBYSTEP_CALLOUT:case CD_FORECAST_CALLOUT:case CD_CONSULT_CALLOUT:b=a[0];break;case CD_PREVIEW_CALLOUT:case CD_AGENT_OUTSIDE_CALLOUT:case CD_AGENT_INSIDE_CALLOUT:case CD_MONITOR_CALLIN:case CD_INTERCEPT_CALLIN:case CD_INSERT_CALLIN:case CD_EXACT_PREVIEW_CALLOUT:b=a[2];break;case CD_HELP_CALLIN:b=a[2];break;case CD_IVR_CALLOUT:case CD_BRIDGE_CALLOUT:b=a[0]}return b};this.connectToService=function(a,b){this.oApspWS.WSConnect(a,b);getLocalLanguage();this.oAgentInfo._ctrlStatus==barStatus_AgentConnecting&&this._invokeEvent(eventOnWebsocketSocket,stringFormat("{0}|{1}|{2}|{3}",websocket_connecting,a,b,this._connectCount));this._connectCount+=1};this._InvokeMethod=function(a,b){var c=this.oApspWS.GetCmdName(a);if(""==c)return-1;a==APSP_GetLocalPort_CONF?b=this.oAgentInfo._localPort+"|"+this.oAgentInfo._killMaccard:a==APSP_Initial_CONF&&(b=this.oAgentInfo.getInitialParam(),this._gfOnPrompt(this.oAgentInfo.IsRegisterBackServer()?4424:4423));DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:_InvokeMethod(cmdName\x3d"+c+",param\x3d"+b+")");return this.oApspWS.WSSendMsg(buildApspMsg(c,b))};this.IsInitial=function(){DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:IsInitial("+this.oAgentInfo._isInitial+")");return this.oAgentInfo._isInitial};this.IsMethodUserFull=function(a,b){if(1==this._arrBtnStatus[a])return!0;this._gfOnPrompt(4311,"\u547d\u4ee4["+b+"]\u4e0d\u53ef\u7528,\u65e0\u6cd5\u6267\u884c!");return!1};this.ResetThisCtrl=function(){this.oAgentInfo._isConnected=!1;this.oAgentInfo._isInitial=!1;this.oAgentInfo._ctrlStatus=barStatus_Null;this.oAgentInfo._localPort=4520;this.oAgentInfo._localGuardPort=4510;this._connectCount=this.oAgentInfo.userMainServer=0};this.GetBtnStatuIDs=function(){for(var a="",b=0;b<this.oAgentInfo._arrUserBtn.length;b++){var c=parseInt(this.oAgentInfo._arrUserBtn[b]);1==this._arrBtnStatus[c]&&(a=""==a?this.oAgentInfo._arrUserBtn[b]:a+"|"+this.oAgentInfo._arrUserBtn[b])}return a};this.SetLogoutStatus=function(){this._ResetBtn();this._arrBtnStatus[emBtnWrapUp]=1;this._arrBtnStatus[emBtnConfig]=1;this._invokeEvent(eventOnReportBtnStatus,this.GetBtnStatuIDs())};this._gfOnPrompt=function(a,b){"undefined"==typeof b&&(b="");this._invokeEvent(eventOnPrompt,a+"|"+b)};this.attachEventfun=function(a){this.eventCallBack=a};this.attachResponsefun=function(a){this.responseCallBack=a};this.GetBarCtrl=function(){return this};this.SetCtrlAttribute=function(a,b){"MainIP"==a?this.oAgentInfo._mainIP=b:"BackIP"==a?this.oAgentInfo._backIP=b:"MainPortID"==a?this.oAgentInfo._mainPortID=b:"BackPortID"==a?this.oAgentInfo._backPortID=b:"AgentID"==a?this.oAgentInfo._agentID=b:"Dn"==a?this.oAgentInfo._dn=b:"PassWord"==a?this.oAgentInfo._passWord=b:"MediaFlag"==a?this.oAgentInfo._vccId=b:"PhonType"==a?this.oAgentInfo._phoneType=b:"AppType"==a?this.oAgentInfo._appType=b:"SipServerIP"==a?this.oAgentInfo._sipIp=b:"SipServerPort"==a?this.oAgentInfo._sipServerPort=b:"SipProtocol"==a?this.oAgentInfo._sipProtocol=b:"SipDn"==a?this.oAgentInfo._sipDn=b:"SipAuthType"!=a&&("SipDomain"==a?this.oAgentInfo._sipDomain=b:"SipPassWord"==a?this.oAgentInfo._sipPassWord=b:"SipBackServerIP"==a?this.oAgentInfo._sipBackIp=b:"SipBackServerPort"==a?this.oAgentInfo._sipBackServerPort=b:"SipBackProtocol"==a?this.oAgentInfo._sipBackProtocol=b:"SipBackAuthType"==a?this.oAgentInfo._sipBackAuthType=b:"SipBackDomain"==a?this.oAgentInfo._sipBackDomain=b:"SipBackPassWord"==a?this.oAgentInfo._sipBackPassWord=b:"MonitorIP"==a?this.oAgentInfo._monitorIp=b:"MonitorPort"==a?this.oAgentInfo._monitorPor=b:"MonitorBackIP"==a?this.oAgentInfo._monitorBackIp=b:"MonitorBackPort"==a?this.oAgentInfo._monitorBackPort=b:"WeChatServer"==a?this.oAgentInfo._weChatServerIp=b:"SelfPrompt"==a?this.oAgentInfo._selfPrompt=b:"MinotorVersion"==a?this.oAgentInfo._minotorVersion=b:"TaskID"==a?this.oAgentInfo._taskID=b:"AutoUpdateURL"==a?(this.oAgentInfo._autoUpdateUrl=b,""!=b&&this.CheckVesion(b,"check")):"SipPassWdCryptType"==a?this.oAgentInfo._sipPassWdCryptType=b:"PassWdCryptType"==a?this.oAgentInfo._passWdCryptType=b:"AutoSelectAgent"==a?this.oAgentInfo._autoSelectAgent=b:"VersionType"==a?this.oAgentInfo._versionType=b:"AutoExChangeServer"==a?this.oAgentInfo._autoExChangeServer=b:"IsAllTimeRecord"==a?this.oAgentInfo._allTimeRecord=b:"RecordType"==a?this.oAgentInfo._recordType=b:"AgentName"==a?this.oAgentInfo._agentName=b:"msgFlag"==a?this.oAgentInfo._msgFlag=b:"AgentType"==a?this.oAgentInfo._agentType=b:"LocalPort"==a?this.oAgentInfo._localPort=b:"ServiceLists"!=a&&"TimeOut"!=a&&("ftpServerIP"==a?this.oAgentInfo._ftpIp=b:"ftpServerPort"==a?this.oAgentInfo._ftpPort=b:"ftpType"==a?this.oAgentInfo._ftpType=b:"ftpUser"==a?this.oAgentInfo._ftpUser=b:"ftpPassWord"==a?this.oAgentInfo._ftpPassWord=b:"ftpDirectory"==a?this.oAgentInfo._ftpDirectory=b:"forceEndProcess"==a?this.oAgentInfo._killMaccard=b:DisplayLog(VccBar_Log_Error,"bad attribute name:"+a)))};this.GetCtrlAttribute=function(a){if("MainIP"==a)return this.oAgentInfo._mainIP;if("BackIP"==a)return this.oAgentInfo._backIP;if("MainPortID"==a)return this.oAgentInfo._mainPortID;if("BackPortID"==a)return this.oAgentInfo._backPortID;if("AgentID"==a)return this.oAgentInfo._agentID;if("Dn"==a)return this.oAgentInfo._dn;if("PassWord"==a)return this.oAgentInfo._passWord;if("MediaFlag"==a)return this.oAgentInfo._vccId;if("PhonType"==a)return this.oAgentInfo._phoneType;if("AppType"==a)return this.oAgentInfo._appType;if("Av"==a)return this.oAgentInfo._av;if("SipServerIP"==a)return this.oAgentInfo._sipIp;if("SipServerPort"==a)return this.oAgentInfo._sipServerPort;if("SipProtocol"==a)return this.oAgentInfo._sipProtocol;if("SipDn"==a)return this.oAgentInfo._sipDn;if("SipAuthType"==a)return this.oAgentInfo._sipAuthType;if("SipDomain"==a)return this.oAgentInfo._sipDomain;if("SipPassWord"==a)return this.oAgentInfo._sipPassWord;if("SipBackServerIP"==a)return this.oAgentInfo._sipBackIp;if("SipBackServerPort"==a)return this.oAgentInfo._sipBackServerPort;if("SipBackProtocol"==a)return this.oAgentInfo._sipBackProtocol;if("SipBackAuthType"==a)return this.oAgentInfo._sipBackAuthType;if("SipBackDomain"==a)return this.oAgentInfo._sipBackDomain;if("SipBackPassWord"==a)return this.oAgentInfo._sipBackPassWord;if("MonitorIP"==a)return this.oAgentInfo._monitorIp;if("MonitorPort"==a)return this.oAgentInfo._monitorPor;if("MonitorBackIP"==a)return this.oAgentInfo._monitorBackIp;if("MonitorBackPort"==a)return this.oAgentInfo._monitorBackPort;if("WeChatServer"==a)return this.oAgentInfo._weChatServerIp;if("SelfPrompt"==a)return this.oAgentInfo._selfPrompt;if("MinotorVersion"==a)return this.oAgentInfo._minotorVersion;if("TaskID"==a)return this.oAgentInfo._taskID;if("AutoUpdateURL"==a)return this.oAgentInfo._autoUpdateUrl;if("SipPassWdCryptType"==a)return this.oAgentInfo._sipPassWdCryptType;if("PassWdCryptType"==a)return this.oAgentInfo._passWdCryptType;if("AutoSelectAgent"==a)return this.oAgentInfo._autoSelectAgent;if("VersionType"==a)return this.oAgentInfo._versionType;if("AutoExChangeServer"==a)return this.oAgentInfo._autoExChangeServer;if("CurUseServer"==a)return this.oAgentInfo._userMainServer;if("IsAllTimeRecord"==a)return this.oAgentInfo._allTimeRecord;if("RecordType"==a)return this.oAgentInfo._recordType;if("AgentName"==a)return this.oAgentInfo._agentName;if("msgFlag"==a)return this.oAgentInfo._msgFlag;if("AgentType"==a)return this.oAgentInfo._agentType;if("LocalPort"==a)return this.oAgentInfo._localPort;if("ServiceLists"==a||"TimeOut"==a)return"";if("ftpServerIP"==a)return this.oAgentInfo._ftpIp;if("ftpServerPort"==a)return this.oAgentInfo._ftpPort;if("ftpType"==a)return this.oAgentInfo._ftpType;if("ftpUser"==a)return this.oAgentInfo._ftpUser;if("ftpPassWord"==a)return this.oAgentInfo._ftpPassWord;if("ftpDirectory"==a)return this.oAgentInfo._ftpDirectory;if("localHttpServer"==a)return this.oAgentInfo._localHttpPort;DisplayLog(VccBar_Log_Error,"bad attribute name:"+a);return""};this.GetBarType=function(){return vccBarTypeHTML5};this.CheckVesion=function(a,b){this.oGuardCtrl.exeGuardCmd(cmd_GuardType_UpdateSetup,a,b);return 0};this.Initial=function(){if(1==this.oAgentInfo._isConnected)if(this.oAgentInfo._ctrlStatus==barStatus_AgentConnected)this._IsNeedReConnected()&&(this._InvokeMethod(APSP_Initial_CONF,""),this.oAgentInfo._barStatus=em_Bar_Initialing);else return-1;else this.oAgentInfo._ctrlStatus==barStatus_Null&&(getLocalLanguage()==lg_english?this.oGuardCtrl.exeGuardCmd(cmd_GuardType_GetLocalPort,this.oAgentInfo._localPort+"|"+this.oAgentInfo._killMaccard+"|english",""):this.oGuardCtrl.exeGuardCmd(cmd_GuardType_GetLocalPort,this.oAgentInfo._localPort+"|"+this.oAgentInfo._killMaccard,""));return 0};this.SerialBtn=function(a,b){"undefined"==typeof b&&(b="");this.oAgentInfo.InitSerialBtn(a,b);return this._InvokeMethod(APSP_SerialBtn_CONF,GetApspParam(a))};this.GetBtnStatus=function(a){return 1!=this.IsInitial()?this.GetBtnStatuIDs():this._InvokeMethod(APSP_GetBtnStatus_CONF,GetApspParam(a))};this.stringToInt=function(a,b){"undefined"==typeof a&&(a="");return""==a?b:parseInt(a)};this.Configurate=function(a){"undefined"==typeof a&&(a="");if(a instanceof Object)return DisplayLog(VccBar_Log_Debug,"JVccBar:Configurate("+JSON.stringify(a)+")"),this.oAgentInfo._autoAnswer=getDefaultParamValue(a.autoAnswer,this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=getDefaultParamValue(a.idleStatus,this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=getDefaultParamValue(a.callIn,this.oAgentInfo._callIn),this.oAgentInfo._warn=getDefaultParamValue(a.warn,this.oAgentInfo._warn),this.oAgentInfo._sipAlert=getDefaultParamValue(a.sipAlert,this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=getDefaultParamValue(a.registInterVal,this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=getDefaultParamValue(a.vedioWnd,this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=getDefaultParamValue(a.bandWidth,this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=getDefaultParamValue(a.frameRate,this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=getDefaultParamValue(a.vedioFormat,this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=getDefaultParamValue(a.defaultIP,this.oAgentInfo._defaultIP),this.oAgentInfo._capType=getDefaultParamValue(a.capType,this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=getDefaultParamValue(a.minMediaPort,this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=getDefaultParamValue(a.maxMediaPort,this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=getDefaultParamValue(a.ecDelaySize,this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=getDefaultParamValue(a.popAlert,this.oAgentInfo._popAlert),this.oAgentInfo._sipHeartBeatType=getDefaultParamValue(a.sipHeartBeatType,this.oAgentInfo._sipHeartBeatType),this.oAgentInfo._snapShotType=getDefaultParamValue(a.snapShotType,this.oAgentInfo._snapShotType),this.oAgentInfo._recvNs=getDefaultParamValue(a.recvNs,this.oAgentInfo._recvNs),this.oAgentInfo._sendNs=getDefaultParamValue(a.sendNs,this.oAgentInfo._sendNs),this.oAgentInfo._recvAgc=getDefaultParamValue(a.recvAgc,this.oAgentInfo._recvAgc),this.oAgentInfo._sendAgc=getDefaultParamValue(a.sendAgc,this.oAgentInfo._sendAgc),this.oAgentInfo._sendEc=getDefaultParamValue(a.sendEc,this.oAgentInfo._sendEc),this.oAgentInfo._singleVideoWindow=getDefaultParamValue(a.singleVideoWindow,this.oAgentInfo._singleVideoWindow),this.oAgentInfo._videoToolBarTop=getDefaultParamValue(a.videoToolBarTop,this.oAgentInfo._videoToolBarTop),this.oAgentInfo._ringIndex=getDefaultParamValue(a.ringIndex,this.oAgentInfo._ringIndex),this.oAgentInfo._ftpSpeedLimit=getDefaultParamValue(a.ftpSpeedLimit,this.oAgentInfo._ftpSpeedLimit),this.oAgentInfo._customizeWidth=getDefaultParamValue(a.customizeWidth,this.oAgentInfo._customizeWidth),this.oAgentInfo._customizeHeight=getDefaultParamValue(a.customizeHeight,this.oAgentInfo._customizeHeight),0!=this.oAgentInfo._capType&&7!=this.oAgentInfo._capType&&(this.oAgentInfo._capType=0),this.oAgentInfo.saveToLocal(),this.IsInitial()?this._InvokeMethod(APSP_Configurate_CONF,this.oAgentInfo.getConfigParam()):-1;var b=a.split("|");if("PopWin"==a.substr(0,6)){if(this.IsInitial())return this._InvokeMethod(APSP_Configurate_CONF,a)}else if(1!=b.length||""!=a)if(5==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert);else if(7==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._recvNs=this.stringToInt(b[5],this.oAgentInfo._recvNs),this.oAgentInfo._sendNs=this.stringToInt(b[6],this.oAgentInfo._sendNs);else if(10==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._recvNs=this.stringToInt(b[5],this.oAgentInfo._recvNs),this.oAgentInfo._sendNs=this.stringToInt(b[6],this.oAgentInfo._sendNs),this.oAgentInfo._recvAgc=this.stringToInt(b[7],this.oAgentInfo._recvAgc),this.oAgentInfo._sendAgc=this.stringToInt(b[8],this.oAgentInfo._sendAgc),this.oAgentInfo._sendEc=this.stringToInt(b[9],this.oAgentInfo._sendEc);else if(11==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10];else if(12==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._pingFlag=this.stringToInt(b[11],this.oAgentInfo._pingFlag);else if(16==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._capType=this.stringToInt(b[11],this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=this.stringToInt(b[12],this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=this.stringToInt(b[13],this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=this.stringToInt(b[14],this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=this.stringToInt(b[15],this.oAgentInfo._popAlert);else if(17==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._capType=this.stringToInt(b[11],this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=this.stringToInt(b[12],this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=this.stringToInt(b[13],this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=this.stringToInt(b[14],this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=this.stringToInt(b[15],this.oAgentInfo._popAlert);else if(18==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._capType=this.stringToInt(b[11],this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=this.stringToInt(b[12],this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=this.stringToInt(b[13],this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=this.stringToInt(b[14],this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=this.stringToInt(b[15],this.oAgentInfo._popAlert),this.oAgentInfo._sipHeartBeatType=this.stringToInt(b[17],this.oAgentInfo._sipHeartBeatType);else if(19==b.length)this.oAgentInfo._autoAnswer=this.stringToInt(b[0],this.oAgentInfo._autoAnswer),this.oAgentInfo._idleStatus=this.stringToInt(b[1],this.oAgentInfo._idleStatus),this.oAgentInfo._callIn=this.stringToInt(b[2],this.oAgentInfo._callIn),this.oAgentInfo._warn=this.stringToInt(b[3],this.oAgentInfo._warn),this.oAgentInfo._sipAlert=this.stringToInt(b[4],this.oAgentInfo._sipAlert),this.oAgentInfo._registInterVal=this.stringToInt(b[5],this.oAgentInfo._registInterVal),this.oAgentInfo._vedioWnd=this.stringToInt(b[6],this.oAgentInfo._vedioWnd),this.oAgentInfo._bandWidth=this.stringToInt(b[7],this.oAgentInfo._bandWidth),this.oAgentInfo._frameRate=this.stringToInt(b[8],this.oAgentInfo._frameRate),this.oAgentInfo._vedioFormat=this.stringToInt(b[9],this.oAgentInfo._vedioFormat),this.oAgentInfo._defaultIP=b[10],this.oAgentInfo._capType=this.stringToInt(b[11],this.oAgentInfo._capType),this.oAgentInfo._minMediaPort=this.stringToInt(b[12],this.oAgentInfo._minMediaPort),this.oAgentInfo._maxMediaPort=this.stringToInt(b[13],this.oAgentInfo._maxMediaPort),this.oAgentInfo._ecDelaySize=this.stringToInt(b[14],this.oAgentInfo._ecDelaySize),this.oAgentInfo._popAlert=this.stringToInt(b[15],this.oAgentInfo._popAlert),this.oAgentInfo._sipHeartBeatType=this.stringToInt(b[17],this.oAgentInfo._sipHeartBeatType),this.oAgentInfo._snapShotType=this.stringToInt(b[18],this.oAgentInfo._snapShotType);else return getLocalLanguage()==lg_zhcn?alert("Configurate\u8bbe\u7f6e\u53c2\u6570\u4e0d\u6b63\u786e"):alert("bad Configurate parameter"),-1;0!=this.oAgentInfo._capType&&7!=this.oAgentInfo._capType&&(this.oAgentInfo._capType=0);this.oAgentInfo.saveToLocal();return this.IsInitial()?this._InvokeMethod(APSP_Configurate_CONF,this.oAgentInfo.getConfigParam()):-1};this.GetConfiguration=function(){return this.oAgentInfo.getConfiguration()};this.UnInitial=function(a){return this.IsInitial()?("undefined"==typeof a&&(a="0"),this.oAgentInfo._barExitCode=a,this._InvokeMethod(APSP_UnInitial_CONF,a)):-1};this.SetUIStyle=function(a){getLocalLanguage()==lg_zhcn?alert("\u6b64\u65b9\u6cd5\u65e0\u6548"):alert("invalidate Method")};this.GetVersion=function(){""==this.oAgentInfo._version&&this.oGuardCtrl.exeGuardCmd(cmd_GuardType_GetVersion,"","");return this.oAgentInfo._version};this.SetBusy=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnSetBusy,"SetBusy"))return-1;a=getDefaultParam(a);""==a&&(a=0);this.oAgentInfo._agentBusySubStatus=a;return this._InvokeMethod(APSP_SetBusy_CONF,a)};this.SetIdle=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnSetIdle,"SetIdle")?this._InvokeMethod(APSP_SetIdle_CONF,""):-1};this.SetWrapUp=function(){return this.IsMethodUserFull(emBtnSetIdle,"SetIdle")||this.IsMethodUserFull(emBtnSetBusy,"SetBusy")?this._InvokeMethod(APSP_SetWrapUp_CONF,""):-1};this.SetCTICalloutTask=function(a){this.oAgentInfo._taskID=a;return this._InvokeMethod(APSP_SetCTICalloutTask_CONF,a)};this.GetCTICalloutTask=function(){return this._InvokeMethod(APSP_GetCTICalloutTask_CONF,"")};this.GetCallData=function(a){return this._InvokeMethod(APSP_GetCallData_CONF,GetApspParam(a))};this.SetCallData=function(a,b){return this._InvokeMethod(APSP_SetCallData_CONF,GetApspParam(a,b))};this.GetTransfer=function(){return this._InvokeMethod(APSP_GetTransfer_CONF,"")};this.SetTransfer=function(a,b,c){return this._InvokeMethod(APSP_SetTransfer_CONF,GetApspParam(a,b,c))};this.ChangeCallQueue=function(a,b,c){return this._InvokeMethod(APSP_ChangeCallQueue_CONF,GetApspParam(a,b,c))};this.GetCallID=function(){return this._InvokeMethod(APSP_GetCallID_CONF,"")};this.QuerySPGroupList=function(a,b,c,f,g,k){"undefined"==typeof c&&(c="9");"undefined"==typeof f&&(f="0");this.oAgentInfo._realMethodName="QuerySPGroupList";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam(c,a,b,f,g,k))};this.GetCallInfo=function(){return this._InvokeMethod(APSP_GetCallInfo_CONF,"")};this.SetTransparentParameter=function(a){return this._InvokeMethod(APSP_SetTransparentParameter_CONF,a)};this.GetAgentStatus=function(){return this.oAgentInfo._agentStatus};this.GetAgentSubBusyStatus=function(){return 1==this.oAgentInfo._agentStatus?this.oAgentInfo._agentBusySubStatus:-1};this.GetBusySubStatus=function(){return this.oAgentInfo._strBusySubStatus};this.SetDisplayNumber=function(a){this.oAgentInfo._realMethodName="SetDisplayNumber";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("8",a))};this.GetDisplayNumber=function(){this.oAgentInfo._realMethodName="GetDisplayNumber";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,"21|")};this.CallQueueQuery=function(a,b,c){"undefined"==typeof b&&(b=2);"undefined"==typeof c&&(c=0);return this._InvokeMethod(APSP_CallQueueQuery_CONF,GetApspParam(a,b,c))};this.QueryGroupAgentStatus=function(a,b,c,f){this.oAgentInfo._realMethodName="QueryGroupAgentStatus";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("22",a,b,c,f))};this.QueryPreViewCallOutNumbers=function(a,b,c,f){this.oAgentInfo._realMethodName="QueryPreViewCallOutNumbers";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("23",a,b,c,f))};this.GetBase64Data=function(a){return GetBase64FromGBK(a)};this.GetDataFromBase64=function(a){return GetGBKFromBase64(a)};this.SetWeChatQueueFlag=function(a){this.oAgentInfo._realMethodName="SetWeChatQueueFlag";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("30",a))};this.GetWeChatQueueFlag=function(){this.oAgentInfo._realMethodName="GetWeChatQueueFlag";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("30",""))};this.TransferCallQueue=function(a,b,c){return this._InvokeMethod(APSP_TransferCallQueue_CONF,GetApspParam(a,b,c))};this.SetActiveService=function(a){this.oAgentInfo._realMethodName="SetActiveService";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("26",a))};this.GetActiveService=function(){this.oAgentInfo._realMethodName="GetActiveService";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("26",""))};this.GetExitCause=function(){return this.oAgentInfo._strExitCause};this.SetForwardNumber=function(a,b){this.oAgentInfo._realMethodName="SetForwardNumber";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("25",a,b))};this.GetForwardNumber=function(){this.oAgentInfo._realMethodName="GetForwardNumber";return this._InvokeMethod(APSP_QueryCTIInfo_CONF,GetApspParam("25",""))};this.SetAgentReservedStatus=function(a,b){this.oAgentInfo._realMethodName="SetAgentReservedStatus";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("31",a,b))};this.SetMMService=function(a,b){this.oAgentInfo._realMethodName="SetMMService";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("34",a,b))};this.DeleteCaptureFile=function(a){this.oAgentInfo._realMethodName="DeleteCaptureFile";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("35",a))};this.GetAgentLogFile=function(a,b,c){this.oAgentInfo._realMethodName="GetAgentLogFile";return this._InvokeMethod(APSP_SetCTIInfo_CONF,GetApspParam("32",this.oAgentInfo._agentID,a,b,c))};this.GetMonitorOffSetTime=function(){return this.oAgentInfo._ampOffSetTime};this.MakeCall=function(a,b,c,f,g,k,l,d,p,h,e){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnMakeCall,"MakeCall"))return-1;if(""==a)return this._gfOnPrompt(4312),-1;"undefined"==typeof l&&(l=0);if(0==l&&(a=formatCallNum(a),!isPhoneNum(a,!0)))return this._gfOnPrompt(4313),-1;b=getDefaultParam(b);""==b&&(b=CD_PREVIEW_CALLOUT);"undefined"==typeof c&&(c="");"undefined"==typeof f&&(f="");f=this.GetBase64Data(f);"undefined"==typeof g&&(g="");"undefined"==typeof k&&(k="");"undefined"==typeof d&&(d="");"undefined"==typeof p&&(p="");"undefined"==typeof h&&(h="");"undefined"==typeof e&&(e="");return this._InvokeMethod(APSP_MakeCall_CONF,GetApspParam(a,b,c,f,g,k,l,d,p,h,e))};this.CallIn=function(a,b,c,f,g){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnMakeCall,"CallIn"))return-1;if(""==a)return this._gfOnPrompt(4312),-1;b=getDefaultParam(b);""==b&&(b=CD_AGENT_INSIDE_CALLOUT);"undefined"==typeof c&&(c="");"undefined"==typeof f&&(f="");f=this.GetBase64Data(f);"undefined"==typeof g&&(g="");return this._InvokeMethod(APSP_CallIn_CONF,GetApspParam(a,b,c,f,g))};this.TransferOut=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnTransferOut,"TransferOut")?this._InvokeMethod(APSP_TransferOut_CONF,GetApspParam(a,b)):-1};this.Hold=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnHold,"Hold"))return-1;a=getDefaultParam(a);return this._InvokeMethod(APSP_Hold_CONF,a)};this.RetrieveHold=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnRetrieve,"RetrieveHold"))return-1;a=getDefaultParam(a);return this._InvokeMethod(APSP_RetrieveHold_CONF,a)};this.Disconnect=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnEndCall,"Disconnect"))return-1;a=getDefaultParam(a);""==a&&(a=0);return this._InvokeMethod(APSP_Disconnect_CONF,0==a?4:3)};this.Answer=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnPickUp,"Answer")?this._InvokeMethod(APSP_Answer_CONF,a):-1};this.Consult=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnConsult,"Consult")?""==b?(this._gfOnPrompt(4312),-1):0==a||(b=formatCallNum(b),isPhoneNum(b))?this._InvokeMethod(APSP_Consult_CONF,GetApspParam(a,b)):(this._gfOnPrompt(4313),-1):-1};this.Transfer=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnTransfer,"Transfer")?this._InvokeMethod(APSP_Transfer_CONF,""):-1};this.Conference=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnConference,"Conference")?this._InvokeMethod(APSP_Conference_CONF,""):-1};this.SendDTMF=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnSendDtmf,"SendDTMF")?this._InvokeMethod(APSP_SendDTMF_CONF,a):-1};this.Bridge=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnBridge,"Bridge")?""==a?(this._gfOnPrompt(4312),-1):this._InvokeMethod(APSP_Bridge_CONF,GetApspParam(a,b)):-1};this.Mute=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnMute,"Mute")?this._InvokeMethod(APSP_Mute_CONF,GetApspParam(a,b)):-1};this.ReleaseThirdOne=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnEndCall,"ReleaseThirdOne"))return-1;"undefined"==typeof a&&(a=0);this.oAgentInfo._retrieveCall=a;if(13==this.oAgentInfo._workStatus||28==this.oAgentInfo._workStatus)this.oAgentInfo._retrieveCall=0;return this._InvokeMethod(APSP_ReleaseThirdOne_CONF,"")};this.ReleaseConnectOne=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnEndCall,"ReleaseConnectOne"))return-1;"undefined"==typeof a&&(a="");return this._InvokeMethod(APSP_ReleaseConnectOne_CONF,a)};this.MultiConfTransfer=function(a){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnTransfer,"MultiConfTransfer"))return-1;"undefined"==typeof a&&(a="");return this._InvokeMethod(APSP_MultiConfTransfer_CONF,a)};this.ModifyVideoStream=function(a,b,c){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnTransfer,"ModifyVideoStream"))return-1;"undefined"==typeof a&&(a="0");"undefined"==typeof b&&(b="");"undefined"==typeof c&&(b="CPV");return this._InvokeMethod(APSP_ModifyVideoStream_CONF,GetApspParam(a,b,c))};this.ForceReset=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnForceReset,"ForceReset")?this._InvokeMethod(APSP_ForceReset_CONF,""):-1};this.SendIMMessage=function(a,b,c,f,g,k){k=GetBase64FromGBK(k);return this._InvokeMethod(APSP_SendIMMessage_CONF,GetApspParam(a,b,c,f,g,k))};this.BeginPlay=function(a,b,c,f,g){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnBeginPlay,"BeginPlay"))return-1;f=f.replace(/\|/g,"\u3010");"undefined"==typeof g&&(g="");return this._InvokeMethod(APSP_BeginPlay_CONF,GetApspParam(a,b,c,f,g))};this.StopPlay=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnStopPlay,"StopPlay")?this._InvokeMethod(APSP_StopPlay_CONF,GetApspParam(a,b)):-1};this.BeginCollect=function(a,b,c,f,g,k,l,d,p,h){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnEndCall,"BeginCollect"))return-1;f=f.replace(/\|/g,"\u3010");return this._InvokeMethod(APSP_BeginCollect_CONF,GetApspParam(a,b,c,f,g,k,l,d,p,h))};this.StopCollect=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnEndCall,"StopCollect")?this._InvokeMethod(APSP_StopCollect_CONF,GetApspParam(a,b)):-1};this.BeginRecord=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnRecord,"BeginRecord")?this._InvokeMethod(APSP_BeginRecord_CONF,GetApspParam(a,b)):-1};this.StopRecord=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnStopRecord,"StopRecord")?this._InvokeMethod(APSP_StopRecord_CONF,GetApspParam(a)):-1};this.AlterNate=function(a){return 0};this.CallBack=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnCallBack,"CallBack")?this._InvokeMethod(APSP_CallBack_CONF,GetApspParam()):-1};this.ReCall=function(){return this.IsInitial()&&this.IsMethodUserFull(emBtnReCall,"ReCall")?this._InvokeMethod(APSP_ReCall_CONF,GetApspParam()):-1};this.SMMsg=function(a,b){return this._InvokeMethod(APSP_SMMsg_CONF,GetApspParam(a,b))};this.SendIMMessage2=function(a,b,c){"undefined"==typeof c&&(c="");c=this.GetBase64Data(c);return this._InvokeMethod(APSP_SendIMMessage2_CONF,GetApspParam(a,b,c))};this.WinCap=function(a,b,c){if(!this.IsInitial())return-1;if("undefined"==typeof a||isNaN(a))a=1;"undefined"==typeof b&&(a=200);"undefined"==typeof c&&(c=1);return this._InvokeMethod(APSP_WinCap_CONF,GetApspParam(a,this.oAgentInfo._mainIP,b,c))};this.PopDlg=function(a,b,c,f){if(!this.IsInitial())return-1;"undefined"==typeof f&&(f="");var g;if("CallOutDlg"==a)g=emBtnMakeCall,f=this.oAgentInfo._autoSelectAgent;else if("TransferOutDlg"==a)g=emBtnTransferOut;else if("ConsultDlg"==a)g=emBtnConsult;else if("SendDtmfDlg"==a)g=emBtnSendDtmf;else if("MainSettingDlg"==a)g=emBtnConfig,f=this.GetBase64Data(f);else if("VideoDlg"==a)g=emBtnConfig;else return-2;if(!this.IsMethodUserFull(g,"PopDlg")||"undefined"==typeof a||""==a)return-1;if("undefined"==typeof b||isNaN(b))b=0;if("undefined"==typeof c||isNaN(c))c=0;return this._InvokeMethod(APSP_PopDLG_CONF,GetApspParam(a,b,c,f))};this.VideoSetting=function(a){if(!this.IsInitial())return-1;if(!a.key)return-2;var b="";if("resize"==a.key){var c;a.local&&(b=c=GetApspParam("local",a.local.left,a.local.top,a.local.right,a.local.bottom));a.remote&&(c=GetApspParam("remote",a.remote.left,a.remote.top,a.remote.right,a.remote.bottom),b=""==b?c:b+"@"+c);b=a.key+"@"+b}else if("show"==a.key)b=getDefaultParamValue(a.local,"-1"),b=b+"@"+getDefaultParamValue(a.remote,"-1"),b=a.key+"@"+b;else if("source"==a.key)b=getDefaultParamValue(a.src,""),b=a.key+"@"+b;else if("format"==a.key)b=getDefaultParamValue(a.format,""),b=a.key+"@"+b,"17"==a.format&&(b=b+"@"+getDefaultParamValue(a.width,480),b=b+"@"+getDefaultParamValue(a.height,640));else if("snap"==a.key)b=getDefaultParamValue(a.type,""),b=a.key+"@"+b;else return-3;"undefined"==typeof b&&(b="");b=this.GetBase64Data(b);return this._InvokeMethod(APSP_PopDLG_CONF,GetApspParam("VideoSetting",0,0,b))};this.VideoSettingInfo=function(a){if(!this.IsInitial())return-1;if(!a.key)return-2;var b;if("camera"==a.key)b=getDefaultParamValue(a.type,""),b=a.key+"@"+b;else if("resolution"==a.key)b=getDefaultParamValue(a.camera,""),b=a.key+"@"+b;else return-3;"undefined"==typeof b&&(b="");b=this.GetBase64Data(b);return this._InvokeMethod(APSP_PopDLG_CONF,GetApspParam("VideoInfo",0,0,b))};this.SendSipSessionMessage=function(a){if(!this.IsInitial())return-1;"undefined"==typeof a&&(a="");a=this.GetBase64Data(a);return this._InvokeMethod(APSP_SendSipSessionMessage_CONF,a)};this.UpdateMedia=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnHold,"UpdateMedia")?this._InvokeMethod(APSP_UpdateMedia_CONF,GetApspParam(a,b)):-1};this.BeginCapture=function(a,b){if(!this.IsInitial()||!this.IsMethodUserFull(emBtnHold,"BeginCapture"))return-1;"undefined"==typeof a&&(a="");"undefined"==typeof b&&(b="1");return this._InvokeMethod(APSP_BeginCapture_CONF,GetApspParam(a,b))};this.Connect=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnConnect,"Connect")?this._InvokeMethod(APSP_Connect_CONF,a):-1};this.ForeReleaseCall=function(a,b){return this.IsInitial()&&this.IsMethodUserFull(emBtnForceRelease,"ForeReleaseCall")?""==a?(this._gfOnPrompt(4312),-1):this._InvokeMethod(APSP_ForeReleaseCall_CONF,GetApspParam(a,b)):-1};this.Insert=function(a,b,c){return this.IsInitial()&&this.IsMethodUserFull(emBtnInsert,"Insert")?this._InvokeMethod(APSP_Insert_CONF,GetApspParam(a,b,c)):-1};this.Listen=function(a,b,c){return this.IsInitial()&&this.IsMethodUserFull(emBtnListen,"Listen")?this._InvokeMethod(APSP_Listen_CONF,GetApspParam(a,b,c)):-1};this.Intercept=function(a,b,c,f){return this.IsInitial()&&this.IsMethodUserFull(emBtnIntercept,"Intercept")?this._InvokeMethod(APSP_Intercept_CONF,GetApspParam(a,b,c,f)):-1};this.Help=function(a,b,c){return this.IsInitial()&&this.IsMethodUserFull(emBtnHelp,"Help")?this._InvokeMethod(APSP_Help_CONF,GetApspParam(a,b,c)):-1};this.Lock=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnLock,"Lock")?this._InvokeMethod.Lock(a):-1};this.UnLock=function(a){return this.IsInitial()&&this.IsMethodUserFull(emBtnUnLock,"UnLock")?this._InvokeMethod.UnLock(a):-1};this.ForceIdle=function(a){return this._InvokeMethod(APSP_ForceIdle_CONF,a)};this.ForceBusy=function(a){return this._InvokeMethod(APSP_ForceBusy_CONF,a)};this.ForceOut=function(a){return this._InvokeMethod(APSP_ForceOut_CONF,a)};this.InitialState=function(){return this._InvokeMethod(APSP_InitialState_CONF,this.oAgentInfo._minotorVersion)};this.AgentQuery=function(a,b,c){return this._InvokeMethod(APSP_AgentQuery_CONF,GetApspParam(a,b,c))};this.TelQuery=function(a,b){return this._InvokeMethod(APSP_TelQuery_CONF,GetApspParam(a,b))};this.IvrQuery=function(a,b){return this._InvokeMethod(APSP_IvrQuery_CONF,GetApspParam(a,b))};this.TrunkQuery=function(a,b){return this._InvokeMethod(APSP_TrunkQuery_CONF,GetApspParam(a,b))};this.ServiceQuery=function(a,b){return this._InvokeMethod(APSP_ServiceQuery_CONF,GetApspParam(a,b,""))};this.MMServiceQuery=function(a){return this._InvokeMethod(APSP_MMServiceQuery_CONF,GetApspParam(a))};this.AgentStateQuery=function(a,b,c,f){b=getDefaultParamValue(b,0);c=getDefaultParamValue(c,200);500<c&&(c=500);f=getDefaultParamValue(f,0);return this._InvokeMethod(APSP_AgentStateQuery_CONF,GetApspParam(a,b,c,f))};this.TaskQuery=function(a,b){return this._InvokeMethod(APSP_TaskQuery_CONF,GetApspParam(a,b))};this.CallReportQuery=function(a,b){return this._InvokeMethod(APSP_CallReportQuery_CONF,GetApspParam(a,b))};this.GetTaskSummary=function(a,b){return this._InvokeMethod(APSP_GetTaskSummary_CONF,GetApspParam(a,b))};this.QueryMonitorSumInfo=function(a,b){return this._InvokeMethod(APSP_QueryMonitorSumInfo_CONF,GetApspParam(a,b))};this.StartNotification=function(a,b,c){return this._InvokeMethod(APSP_StartNotification_CONF,GetApspParam(a,b,c))};this.EndNotification=function(a){return this._InvokeMethod(APSP_EndNotification_CONF,a)};this.SendWeiboMsg=function(a){return this._InvokeMethod(APSP_SendWeiboMsg_CONF,GetApspParam(a))};this.UploadFileToMMS=function(a,b,c,f){return this._InvokeMethod(APSP_UploadFileToMMS_CONF,GetApspParam(a,b,c,f))};this.DownFileFromMMS=function(a,b,c,f,g){return this._InvokeMethod(APSP_DownFileFromMMS_CONF,GetApspParam(a,b,c,f,g))};this.SendWeChatMsg=function(a,b,c,f,g,k,l,d,p,h){k=GetBase64FromGBK(k);d=GetBase64FromGBK(d);p=GetBase64FromGBK(p);return this._InvokeMethod(APSP_SendWeChatMsg_CONF,GetApspParam(a,b,c,f,g,k,l,d,p,h))};this.QueryWeChatData=function(a,b,c,f,g,k,l){return this._InvokeMethod(APSP_QueryWeChatData_CONF,GetApspParam(a,b,c,f,g,k,l))};this.QueryWeChatHistory=function(a,b,c,f,g,k,l){return this._InvokeMethod(APSP_QueryWeChatHistory_CONF,GetApspParam(a,b,c,f,g,k,l))};this.GetWeChatParam=function(a){return this._InvokeMethod(APSP_GetWeChatParam_CONF,GetApspParam(1,a))};this.guardCallback=function(a,b){var c=this.oParent;a==GuardEvent_WebSocket?c._invokeEvent(eventOnWebsocketSocket,b):a==GuardEvent_GetLocalPort?(c.oAgentInfo._localPort=b,c.oAgentInfo._ctrlStatus=barStatus_AgentConnecting,c.connectToService(c.oAgentInfo._localserver,c.oAgentInfo._localPort)):a!=GuardEvent_UpdateSetup&&(a==GuardEvent_GetVersion?(""==b&&(b="unknown"),c.oAgentInfo._version=b):a==GuardEvent_GetVersionOK&&c._invokeEvent(eventOnGetVersionReport,b))};this.apspCallback=function(a,b,c){if(a==APSP_Type_Prompt)this.oParent.OnWebSocketEvent(b,c);else{DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:apspCallback(cmdIndex("+this.oParent.oApspWS.GetCmdName(b)+")\x3d"+b+"  param\x3d"+c+")");this.oParent._oTimer.Reset(ASAP_HEARTBEAT_TIME_ID);if(a==APSP_Type_Event)return this.oParent.ReportEvent(b,c);if(a==APSP_Type_Action)return b==APSP_Initial_CONF?(this.oParent._oTimer.SetTimer(ASAP_HEARTBEAT_TIME_ID,1E4),this.oParent._oTimer.SetTimer(ASAP_SEND_BUFFER_TIME_ID,200)):b==APSP_UnInitial_CONF&&(this.oParent.oAgentInfo._localPort=4520,this.oParent.oAgentInfo._isInitial="0"==c?!1:!0,DisplayLog(VccBar_Log_Info,"JHTML5Ctrl:UnInitial("+this.oParent.oAgentInfo._isInitial+")"),this.oParent.oAgentInfo._ctrlStatus=barStatus_AgentDisconnecting,0==this.oParent.oAgentInfo._isInitial&&(this.oParent.ReportEvent(eventOnBarExit,this.oParent.oAgentInfo._barExitCode+"|"),this.oParent.oAgentInfo._barExitCode="0",this.oParent.oAgentInfo._userMainServer=0),this.oParent._oTimer.KillTimer(ASAP_HEARTBEAT_TIME_ID),this.oParent.ResetThisCtrl()),this.oParent.ReportResponse(b,c);this.oParent._invokeEvent(b,c)}};this.OnWebSocketEvent=function(a,b){if(a==APSP_WebSocket_Event){var c=parseInt(b);if(c==websocket_connected)this.oAgentInfo._ctrlStatus==barStatus_AgentConnecting&&(this.oAgentInfo._ctrlStatus=barStatus_AgentConnected,this.oAgentInfo._isConnected=!0,this._invokeEvent(eventOnWebsocketSocket,websocket_connected+"|"),this.Initial());else if(c==websocket_remoteserver_disconnected)this.oAgentInfo._ctrlStatus==barStatus_AgentConnecting&&(this._connectCount<PORT_COUNT?(this.oAgentInfo._localPort=this.oAgentInfo._localPort,this.connectToService(this.oAgentInfo._localserver,this.oAgentInfo._localPort)):(this.ResetThisCtrl(),this._invokeEvent(eventOnWebsocketSocket,websocket_remoteserver_disconnected+"|")));else if(c==websocket_closed)if(this.oAgentInfo._ctrlStatus==barStatus_AgentDisconnecting)this._invokeEvent(eventOnWebsocketSocket,websocket_closed+"|"),1==this.oAgentInfo._isInitial&&(this.ReportEvent(eventOnBarExit,this.oAgentInfo._barExitCode+"|"),this.oAgentInfo._barExitCode="0",this.oAgentInfo._userMainServer=0),this.ResetThisCtrl();else if(this.oAgentInfo._ctrlStatus==barStatus_AgentConnected)if(this.oAgentInfo._isInitial){if(this.oAgentInfo._barStatus!=em_Bar_Initialing||1!=this.oAgentInfo._isReConnect)this.oAgentInfo._barStatus=em_Bar_Reconnecting,this._connectCount=0,this.oAgentInfo._isConnected=!1,this.oAgentInfo._ctrlStatus=barStatus_Null,this.oAgentInfo._isReConnect=1,this.oAgentInfo._agentOldStatus=this.GetAgentStatus(),DisplayLog(VccBar_Log_Info,"ReconnectMaccard"),this._oTimer.SetTimer(RECONNECT_AGENT_TIME_ID,5E3)}else this.ResetThisCtrl()}};this.ReportResponse=function(a,b){if(null!=this.responseCallBack)if(a==APSP_SetBusy_CONF&&("0"==b?this.oAgentInfo._agentBusySubStatus_old=this.oAgentInfo._agentBusySubStatus:this.oAgentInfo._agentBusySubStatus=this.oAgentInfo._agentBusySubStatus_old),a==APSP_GetConfiguration_CONF){var c=b.split("|");this.oAgentInfo._autoAnswer=parseInt(c[0]);this.oAgentInfo._idleStatus=parseInt(c[1]);this.oAgentInfo._callIn=parseInt(c[2]);this.oAgentInfo._warn=parseInt(c[3]);this.oAgentInfo._sipAlert=parseInt(c[4]);this.oAgentInfo._registInterVal=parseInt(c[5]);this.oAgentInfo._vedioWnd=parseInt(c[6]);this.oAgentInfo._bandWidth=parseInt(c[7]);this.oAgentInfo._frameRate=parseInt(c[8]);this.oAgentInfo._vedioFormat=parseInt(c[9]);this.oAgentInfo._capType=parseInt(c[10]);this.oAgentInfo._defaultIP=c[11]}else a==APSP_GetConfiguration_CONF&&this.oAgentInfo._barStatus==em_Bar_Initialing&&("0"!=b&&this.oAgentInfo._barStatus==em_Bar_Unitial,"-2"==b&&alert("\u7248\u672c\u5b89\u88c5\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u66f4\u65b0\u7535\u8bdd\u6761\u7248\u672c!")),a==APSP_SetCTIInfo_CONF||a==APSP_QueryCTIInfo_CONF?this.responseCallBack(this.oAgentInfo._realMethodName,b):a==APSP_PopDLG_CONF?0<=b.indexOf("VideoInfo")&&this.responseCallBack(this.oApspWS.GetCmdName(a),b):this.responseCallBack(this.oApspWS.GetCmdName(a),b)};this.ReportEvent=function(a,b){var c=b,f=b.split("|");switch(a){case APSP_ComingCall_EVENT:a=eventOnCallRing;var g=this._getPartenerNum(b),k="",l="",d="",p="",h="",e="",t="",n="0";14<f.length&&(k=f[14]);15<f.length&&(l=f[15]);16<f.length&&(d=f[16]);17<f.length&&(p=f[17]);18<f.length&&(h=f[18]);19<f.length&&(e=f[19]);20<f.length&&(t=f[20]);21<f.length&&(n=f[21]);c=GetGBKFromBase64(f[3]);c=f[0]+"|"+f[1]+"|"+f[2]+"|"+c+"|"+f[4]+"|"+f[5]+"|"+f[6]+"|"+f[7]+"|"+f[8];c=c+"|"+g+"|"+this.oAgentInfo._dn+"|"+f[9]+"|"+f[11]+"|"+f[12]+"|"+f[13]+"|"+k+"|"+l;c=c+"|"+d+"|"+p+"|"+h+"|"+e+"|"+t+"|"+n;this._InvokeMethod(APSP_PopDLG_CONF,GetApspParam("PopRingDlg",0,0,GetBase64FromGBK(b)));break;case APSP_AnswerCall_EVENT:a=eventOnAnswerCall;break;case APSP_OnCallEnd_EVENT:a=eventOnCallEnd;this.oAgentInfo._retrieveCall=0;break;case APSP_OnPrompt_EVENT:a=eventOnPrompt;g=parseInt(f[0]);c="";k=!0;switch(g){case 4011:case 4005:this.SetLogoutStatus();break;case 4303:case 4008:case 4404:f="1"==f[1];if(this.oAgentInfo._barStatus==em_Bar_Initialing&&1==this.oAgentInfo._isReConnect)return;this.oAgentInfo._barStatus=em_Bar_Reconnecting;this.oAgentInfo._isReConnect=1;this.oAgentInfo._agentOldStatus=this.GetAgentStatus();f&&(DisplayLog(VccBar_Log_Info,"ReconnectMaccard"),this._oTimer.SetTimer(RECONNECT_AGENT_TIME_ID,5E3));k=!1;break;case 4009:k=!1;break;case 4316:c=f[1];break;case 4004:c=f[1]}if(4005==g||4006==g||4007==g)g=4011;c=g+"|"+c;k=k&&0==this.oAgentInfo._isReConnect||4011==g;if(!k)return;break;case APSP_OnReportBtnStatus_EVENT:a=eventOnReportBtnStatus;c=b.split("@");2==c.length&&(b=c[0],this.oAgentInfo._agentStatus=parseInt(c[1]),f=b.split("|"));this._ResetBtn();c="";for(g=0;g<f.length;g++)k=f[g],l=parseInt(k),100<=l?(this.oAgentInfo._agentStatus=l-100,k="0"):this._arrBtnStatus[l]=1,c=""==c?k:c+"|"+k;break;case APSP_OnInitalSuccess_EVENT:a=eventOnInitalSuccess;0<b.lastIndexOf("@")&&(f=b.split("@"),1<f.length&&(this.oAgentInfo._phoneType=parseInt(f[1]),b=f[0]),2<f.length&&(this.oAgentInfo._strExitCause=f[2]),3<f.length&&(this.oAgentInfo._agentName=f[3]),4<f.length&&(this.oAgentInfo._ampOffSetTime=parseInt(f[4])),5<f.length&&(g=parseInt(f[5]),this.oAgentInfo._userMainServer=0==this.oAgentInfo._userMainServer?g:g?0:1),6<f.length&&(g=this.GetDataFromBase64(f[6]).split("|"),this.oAgentInfo._autoAnswer=parseInt(g[0]),this.oAgentInfo._idleStatus=parseInt(g[1]),this.oAgentInfo._callIn=parseInt(g[2]),this.oAgentInfo._warn=parseInt(g[3]),this.oAgentInfo._sipAlert=parseInt(g[4]),this.oAgentInfo._registInterVal=parseInt(g[5]),this.oAgentInfo._vedioWnd=parseInt(g[6]),this.oAgentInfo._bandWidth=parseInt(g[7]),this.oAgentInfo._frameRate=parseInt(g[8]),this.oAgentInfo._vedioFormat=parseInt(g[9]),this.oAgentInfo._capType=parseInt(g[10]),this.oAgentInfo._defaultIP=g[11],this.oAgentInfo._autoUpdateConfig=!0),7<f.length&&(this.oAgentInfo._av=parseInt(f[7])));this.oAgentInfo._strBusySubStatus=b;this.oAgentInfo._barStatus=em_Bar_Initialed;this.oAgentInfo._isReConnect=0;if(0==this.oAgentInfo._isInitial)this.oAgentInfo._isInitial=!0;else{this._oTimer.KillTimer(RECONNECT_AGENT_TIME_ID);DisplayLog(VccBar_Log_Info,"--- Kill Reconnect  Timer  ----");this.oAgentInfo._agentOldStatus==this.GetAgentStatus()&&this._oTimer.SetTimer(SETAGENTSTATUS_AGENT_TIME_ID,1E3);return}break;case APSP_OnInitalFailure_EVENT:a=eventOnInitalFailure;parseInt(f[0])==emCmdLogout&&(this.oAgentInfo._isInitial=!1);if(this.oAgentInfo._isReConnect){this.oAgentInfo._barStatus=em_Bar_Unitial;return}break;case APSP_OnEventPrompt_EVENT:a=eventOnEventPrompt;108==parseInt(f[0])&&this._invokeEvent(eventOnCallDataChanged,f[1]);break;case APSP_OnAgentWorkReport_EVENT:a=eventOnAgentWorkReport;this.oAgentInfo._workStatus=parseInt(f[0]);14==this.oAgentInfo._workStatus&&1==this.oAgentInfo._retrieveCall&&(this.RetrieveHold(),this.oAgentInfo._retrieveCall=0);break;case APSP_OnBarExit_EVENT:this.oAgentInfo._isInitial=!1;1==this.oAgentInfo._isReConnect&&(this._oTimer.KillTimer(RECONNECT_AGENT_TIME_ID),this.oAgentInfo._isReConnect=0);this.oAgentInfo._userMainServer=0;this.oAgentInfo._autoUpdateConfig=!1;a=eventOnBarExit;break;case APSP_OnCallQueueQuery_EVENT:a=eventOnCallQueueQuery;break;case APSP_OnQueueReport_EVENT:a=eventOnQueueReport;break;case APSP_OnSystemMessage_EVENT:f=b.split(",");if(2==f.length)switch(parseInt(f[0])){case 1:a=eventOnCallDataChanged;c=GetGBKFromBase64(f[1]);break;case 2:a=eventOnSystemMessage;c="2|"+f[1];break;case 5:a=eventOnAgentLogUploadReport;c=GetGBKFromBase64(f[1]);f=c.split("|");if(7!=f.length)return;c=f[1]+"|"+f[2]+"|"+f[3]+"|"+f[4]+"|"+f[5]+"|"+f[6];break;case 22:a=eventOnQueryGroupAgentStatus;c=f[1];break;case 23:a=eventOnSystemMessage;c="23|"+GetGBKFromBase64(f[1]);break;case 24:a=eventOnSystemMessage;c="24|"+GetGBKFromBase64(f[1]);break;case 25:a=eventOnSystemMessage,c="25|"}break;case APSP_OnRecvWeiboMsg_EVENT:a=eventOnRecvWeiboMsg;break;case APSP_OnIMNoticsMsg_EVENT:a=eventOnIMMessage;c="0|"+c;break;case APSP_OnIMTextMsg_EVENT:a=eventOnIMMessage;c="1|"+c;break;case APSP_OnAction_EVENT:if("SessionMessage"==f[0]){a=eventOnSessinMessage;c=GetGBKFromBase64(f[1]);break}else if("SnapShort"==f[0]){g=parseInt(f[2]);k=parseInt(f[1]);1==g&&(this.PngData=[]);this.PngData[g]=f[3];g==k&&(a=eventOnSnapShotPngEvent,c=this.PngData.join(""),this.PngData=[]);break}else if("VideoWndReport"==f[0]){a=eventOnVideoWndStatusReport;c=f[1]+"|"+f[2];break}"RecordType"==f[0]&&(this.oAgentInfo._allTimeRecord=parseInt(f[1]));"LocalHttpPort"==f[0]&&(this.oAgentInfo._localHttpPort=parseInt(f[1]));return;case APSP_OnTaskReport_EVENT:a=eventOnTaskReport;break;case APSP_CallReportInfo_EVENT:a=eventOnCallReportInfo;break;case APSP_QueryMonitorSumReport_EVENT:a=eventOnQueryMonitorSumReport;break;case APSP_OutboundReport_EVENT:a=eventOnOutboundReport;break;case APSP_OnAgentReport_EVENT:a=eventOnAgentReport;break;case APSP_OnIvrReport_EVENT:a=eventOnIvrReport;break;case APSP_OnTelReport_EVENT:a=eventOnTelReport;break;case APSP_OnServiceReport_EVENT:a=eventOnServiceReport;break;case APSP_OnMMServiceReport_EVENT:a=eventOnMMServiceReport;break;case APSP_OnWallServiceReport_EVENT:a=eventOnWallServiceReport;break;case APSP_OnWallQueueReport_EVENT:a=eventOnWallQueueReport;break;case APSP_OnStaticInfoReport_EVENT:a=eventOnWorkStaticInfoReport;break;case APSP_OnServiceStaticReport_EVENT:a=eventOnServiceStaticReport;break;case APSP_OnAgentStaticReport_EVENT:a=eventOnAgentStaticReport;break;case APSP_OnTrunkReport_EVENT:a=eventOnTrunkReport;break;case APSP_OnTrunkSumReport_EVENT:a=eventOnTrunkSumReport;break;case APSP_OnRecvWeChatMsg_EVENT:c=f[0]+"|"+f[1]+"|"+f[2]+"|"+f[3]+"|"+f[4]+"|"+f[5]+"|"+GetGBKFromBase64(f[6])+"|"+f[7]+"|"+f[8];c=c+"|"+f[9]+"|"+f[10]+"|"+GetGBKFromBase64(f[11])+"|"+GetGBKFromBase64(f[12])+"|"+f[13];a=eventOnRecvWeChatMessage;break;case APSP_OnUploadFileToMMSReport_EVENT:a=eventOnUploadFileToMMSReport;break;case APSP_OnDownloadFileToMMSReport_EVENT:a=eventOnDownloadFileToMMSReport;break;case APSP_OnSendWeChatMsgReport_EVENT:a=eventOnSendWeChatMsgReport;break;case APSP_OnAQueryCTIInfo_EVENT:f=getSubString(b,"","|");if("8"==f||"9"==f||"10"==f)a=eventOnAQueryCTIInfoReport;else return;break;case APSP_OnAgentBusyReason_EVENT:a=eventOnAgentBusyReasonReport;this.oAgentInfo._agentBusySubStatus=parseInt(b);break;case APSP_OnAsrEventReport_EVENT:a=eventOnAsrEventReport;c=f[0]+"|"+f[1]+"|"+f[4]+"|"+f[5];break;case APSP_OnStopSmSuccess_EVENT:a=eventOnStopSmSuccess;c=b;break;case APSP_OnUpdateMediaEvent_EVENT:a=eventOnUpdateMediaEvent;c=b;break;case APSP_OnStopCaptureSuccess_EVENT:a=eventOnStopCaptureSuccess;c=b;break;case APSP_OnModifyVideoStreamReport_EVENT:a=eventOnModifyVideoStreamReport,c=b}this._invokeEvent(a,c)};this._load()}function JAgentInfo(){this._agentID="";this._passWord="111111";this._agentType=0;this._version=this._vccId=this._dn=this._agentName="";this._passWdCryptType=0;this._backIP=this._mainIP="";this._backPortID=this._mainPortID=14800;this._monitorIp="";this._monitorPor=4502;this._monitorBackIp="";this._monitorBackPort=4502;this._isInitial=this._isConnected=!1;this._barStatus=em_Bar_Unitial;this._warn=this._callIn=this._autoSelectAgent=this._autoAnswer=this._idleStatus=this._isReConnect=0;this._sipAlert=1;this._registInterVal=3;this._ecDelaySize=5;this._vedioWnd=this._setBusySupport0=this._popAlert=this._ringIndex=0;this._bandWidth=192;this._frameRate=15;this._vedioFormat=9;this._customizeWidth=480;this._customizeHeight=640;this._capType=0;this._defaultIP="";this._snapShotType=this._autoExChangeServer=this._pingFlag=0;this._singleVideoWindow=1;this._av=this._recordType=this._videoToolBarTop=0;this._phoneType=1;this._userMainServer=this._allTimeRecord=0;this._ftpIp="";this._ftpPort=0;this._ftpPassWord=this._ftpUser="";this._ftpDirectory="/home/media/media";this._localDirectory="";this._ftpType=0;this._ftpSpeedLimit=-1;this._sipIp=this._sipDn="";this._sipServerPort=5060;this._sipProtocol="udp";this._sipPassWord="";this._sipDomain="bj.cincc.cn";this._sipAuthType=1;this._sipPassWdCryptType=0;this._sipBackIp="";this._sipBackServerPort=5060;this._sipBackProtocol="udp";this._sipBackPassWord="";this._sipBackDomain="bj.cincc.cn";this._sipBackAuthType=1;this._selfPrompt=0;this._msgFlag="";this._appType=0;this._minotorVersion="3.0";this._weChatServerIp=this._autoUpdateUrl=this._taskID="";this._minMediaPort=2E4;this._maxMediaPort=4E4;this._recvAgc=1;this._recvNs=0;this._sendEc=this._sendAgc=1;this._sipHeartBeatType=this._sendNs=0;this._updating=!1;this._btnIDS="0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,27";this._btnMaskIDS="";this._localserver="127.0.0.1";this._localPort=4520;this._localGuardPort=4510;this._ctrlStatus=barStatus_Null;this._localHttpPort=-1;this._agentBusySubStatus_old=this._agentBusySubStatus=this._agentStatus=0;this._strExitCause=this._strBusySubStatus="";this._barExitCode="0";this._retrieveCall=0;this._realMethodName="";this._versionType=this._killMaccard=0;this._agentOldStatus=-2;this._ampOffSetTime=0;this._autoUpdateConfig=!1;this._workStatus=-1;this._arrUserBtn=this._btnIDS.split(",");this.InitSerialBtn=function(a,b){this._btnIDS=a;this._btnMaskIDS=b;this._arrUserBtn=this._btnIDS.split(",")};this.IsRegisterBackServer=function(){return 1==this._autoExChangeServer&&1==this._userMainServer};this.getInitialParam=function(){""==this._sipBackPassWord&&(this._sipBackPassWord=this._sipPassWord);""==this._sipBackIp&&(this._sipBackIp=this._sipIp,this._sipBackProtocol=this._sipProtocol,this._sipBackDomain=this._sipDomain,this._sipBackServerPort=this._sipServerPort);""==this._monitorBackIp&&(this._monitorBackIp=this._backIP,this._monitorBackPort=this._monitorPor);var a=Array(42);a[0]=this._phoneType;a[1]=this._appType;a[2]=this._mainIP;a[3]=this._mainPortID;a[4]=this._backIP;a[5]=this._backPortID;a[6]=this._agentID;a[7]=this._vccId;a[8]=this._passWord;a[9]=this._monitorIp;a[10]=this._monitorPor;a[11]=this._monitorBackIp;a[12]=this._monitorBackPort;a[13]=this._sipIp;a[14]=this._sipServerPort;a[15]=this._sipProtocol;a[16]=this._dn;a[17]=this._sipDomain;a[18]=this._sipPassWord;a[19]=this._sipAuthType;a[20]=this._sipBackIp;a[21]=this._sipBackServerPort;a[22]=this._sipBackProtocol;a[23]=this._sipBackDomain;a[24]=this._sipBackPassWord;a[25]=this._sipBackAuthType;a[26]=this._btnIDS;a[27]=-1;a[28]=GetBase64FromGBK(this.getConfigParam());a[29]=this._taskID;a[30]=this._ftpIp;a[31]=this._ftpPort;a[32]=this._ftpUser;a[33]=this._ftpPassWord;a[34]=this._ftpDirectory;a[35]=this._sipDn;a[36]=this._weChatServerIp;a[37]=this._sipPassWdCryptType;a[38]=this._passWdCryptType;a[39]=this._versionType;a[40]=this._isReConnect;a[41]=this._ftpType;a[42]=this._singleVideoWindow;a[43]=this._vedioWnd;a[44]=this._videoToolBarTop;this.IsRegisterBackServer()&&(a[4]=this._mainIP,a[5]=this._mainPortID,a[2]=this._backIP,a[3]=this._backPortID,a[11]=this._monitorIp,a[12]=this._monitorPor,a[9]=this._monitorBackIp,a[10]=this._monitorBackPort,a[20]=this._sipIp,a[21]=this._sipServerPort,a[13]=this._sipBackIp,a[14]=this._sipBackServerPort);return a.join("|")};this.getIntCookieValue=function(a,b){var c=getCookie(a);return""==c?b:parseInt(c)};this.loadFromLocal=function(){this._autoAnswer=this.getIntCookieValue("AutoAnswer",0);this._idleStatus=this.getIntCookieValue("AutoIdle",0);this._callIn=this.getIntCookieValue("CallIn",0);this._warn=this.getIntCookieValue("Warn",0);this._sipAlert=this.getIntCookieValue("SipAlert",1);this._registInterVal=this.getIntCookieValue("RegistInterval",3);this._vedioWnd=this.getIntCookieValue("VedioWnd",0);this._bandWidth=this.getIntCookieValue("BandWidth",192);this._frameRate=this.getIntCookieValue("FrameRate",30);this._vedioFormat=this.getIntCookieValue("VedioFormat",9);this._capType=this.getIntCookieValue("CapType",0);this._defaultIP=getCookie("DefaultIP");this._minMediaPort=this.getIntCookieValue("MinMediaPort",2E4);this._maxMediaPort=this.getIntCookieValue("MaxMediaPort",4E4);this._ecDelaySize=this.getIntCookieValue("EchoCancelDelay",0);this._ringIndex=this.getIntCookieValue("RingIndex",0);this._popAlert=this.getIntCookieValue("PopAlert",0);this._setBusySupport0=this.getIntCookieValue("SetBusySupport0",0);this._recvAgc=this.getIntCookieValue("RecvAgc",1);this._recvNs=this.getIntCookieValue("RecvNs",0);this._sendAgc=this.getIntCookieValue("SendAgc",1);this._sendEc=this.getIntCookieValue("SendEc",1);this._sendNs=this.getIntCookieValue("SendNs",0);this._sipHeartBeatType=this.getIntCookieValue("SipHeartBearType",0)};this.saveToLocal=function(){setCookie("AutoAnswer",this._autoAnswer,365);setCookie("AutoIdle",this._idleStatus,365);setCookie("CallIn",this._callIn,365);setCookie("Warn",this._warn,365);setCookie("SipAlert",this._sipAlert,365);setCookie("RegistInterval",this._registInterVal,365);setCookie("VedioWnd",this._vedioWnd,365);setCookie("BandWidth",this._bandWidth,365);setCookie("FrameRate",this._frameRate,365);setCookie("VedioFormat",this._vedioFormat,365);setCookie("CapType",this._capType,365);setCookie("DefaultIP",this._defaultIP,365);setCookie("MinMediaPort",this._minMediaPort,365);setCookie("MaxMediaPort",this._maxMediaPort,365);setCookie("EchoCancelDelay",this._ecDelaySize,365);setCookie("RingIndex",this._ringIndex,365);setCookie("PopAlert",this._popAlert,365);setCookie("SetBusySupport0",this._setBusySupport0,365);setCookie("RecvAgc",this._recvAgc,365);setCookie("RecvNs",this._recvNs,365);setCookie("SendAgc",this._sendAgc,365);setCookie("SendEc",this._sendEc,365);setCookie("SipHeartBearType",this._sipHeartBeatType,365)};this.getConfigParam=function(){var a=Array(24);a[0]=this._autoAnswer;a[1]=this._idleStatus;a[2]=this._callIn;a[3]=this._warn;a[4]=this._sipAlert;a[5]=this._registInterVal;a[6]=this._vedioWnd;a[7]=this._bandWidth;a[8]=this._frameRate;a[9]=this._vedioFormat;a[10]=this._capType;a[11]=this._defaultIP;a[12]=this._minMediaPort;a[13]=this._maxMediaPort;a[14]=this._ecDelaySize;a[15]=this._ringIndex;a[16]=this._recvAgc;a[17]=this._recvNs;a[18]=this._sendAgc;a[19]=this._sendEc;a[20]=this._sendNs;a[21]=this._sipHeartBeatType;a[22]=this._pingFlag;a[23]=this._snapShotType;a[24]=g_JsVersion;a[25]=this._ftpSpeedLimit;a[26]=this._customizeWidth;a[27]=this._customizeHeight;return a.join("|")};this.getConfiguration=function(){var a=Array(12);a[0]=this._autoAnswer;a[1]=this._idleStatus;a[2]=this._callIn;a[3]=this._warn;a[4]=this._sipAlert;a[5]=this._registInterVal;a[6]=this._vedioWnd;a[7]=this._bandWidth;a[8]=this._frameRate;a[9]=this._vedioFormat;a[10]=this._capType;a[11]=this._defaultIP;return a.join("|")}}var barStatus_GuardConnecting=1,barStatus_GuardConnected=2,barStatus_GuardDisconnecting=3,barStatus_GuardDisconnected=4,cmd_GuardType_Null=-1,cmd_GuardType_GetLocalPort=0,cmd_GuardType_UpdateSetup=1,cmd_GuardType_GetVersion=2,GuardEvent_WebSocket=0,GuardEvent_GetLocalPort=1,GuardEvent_UpdateSetup=2,GuardEvent_GetVersion=3,GuardEvent_GetVersionOK=4;function JGuardCtrl(a,b){this._oGuradWS=null;this._ctrlStatus=barStatus_Null;this._connectCount=0;this._cmdType=cmd_GuardType_Null;this._callBack=null;this._cmdParam2=this._cmdParam1="";this._localGuardIP=a;this._localGuardPort=b;this._IsGetVersion=!1;this._Create=function(){this._oGuradWS=new JAPSPWebSocket("CINGuard");this._oGuradWS.SetMsgCallBack(this.apspCallbackGurad);this._oGuradWS.oParent=this};this._ConnectToService=function(a,b){this._oGuradWS.WSConnect(a,b);this._ctrlStatus==barStatus_GuardConnecting&&this._cmdType!=cmd_GuardType_GetVersion&&this._OnFireEvent(GuardEvent_WebSocket,stringFormat("{0}|{1}|{2}|{3}",websocket_guard_connecting,a,b,this._connectCount));this._connectCount+=1};this._InvokeMethod=function(a,b){var c=this._oGuradWS.GetCmdName(a);if(""==c)return-1;DisplayLog(VccBar_Log_Info,"JGuardCtrl:_InvokeMethod(cmdName\x3d"+c+",param\x3d"+b+")");this._oGuradWS.WSSendMsg(buildApspMsg(c,b))};this._OnFireEvent=function(a,b){this._callBack&&this._callBack(a,b)};this.exeGuardCmd=function(a,b,g){DisplayLog(VccBar_Log_Info,"JGuardCtrl:exeGuardCmd(cmdType\x3d"+a+",cmdParam1\x3d"+b+",cmdParam2\x3d"+g+")");this._cmdType=a;this._cmdParam1=b;this._cmdParam2=g;this._ctrlStatus==barStatus_Null&&(this._ctrlStatus=barStatus_GuardConnecting,this._ConnectToService(this._localGuardIP,this._localGuardPort));return 0};this.SetCallBack=function(a){this._callBack=a};this._OnGuardWebSocketEvent=function(a,b){if(a==APSP_WebSocket_Event){var c=parseInt(b);c==websocket_connected?(this._ctrlStatus=barStatus_GuardConnected,this._cmdType!=cmd_GuardType_GetVersion&&this._OnFireEvent(GuardEvent_WebSocket,websocket_guard_connected+"|"),this._cmdType==cmd_GuardType_GetLocalPort?this._InvokeMethod(APSP_GetLocalPort_CONF,this._cmdParam1):this._cmdType==cmd_GuardType_UpdateSetup?this._InvokeMethod(APSP_UpdateSetup_CONF,GetApspParam(this._cmdParam1,this._cmdParam2)):this._cmdType==cmd_GuardType_GetVersion&&this._InvokeMethod(APSP_GetVersion_CONF,"")):c==websocket_remoteserver_disconnected?this._ctrlStatus==barStatus_GuardConnecting&&(this._connectCount<PORT_COUNT?(this._localGuardPort+=10,this._ConnectToService(this._localGuardIP,this._localGuardPort)):(this._OnFireEvent(GuardEvent_WebSocket,websocket_guard_remoteserver_disconnected+"|"),getLocalLanguage()==lg_zhcn?alert("\u7535\u8bdd\u6761\u536b\u58eb\u6ca1\u6709\u542f\u52a8"):alert("CINGuard.exe not work"))):c==websocket_closed&&(this._ctrlStatus!=barStatus_GuardConnecting&&(this._ctrlStatus=barStatus_Null),this._IsGetVersion&&(this._OnFireEvent(GuardEvent_GetVersionOK,""),this._IsGetVersion=!1))}};this._OnGuardWebSocketActionEvent=function(a,b){DisplayLog(VccBar_Log_Info,"JGuardCtrl:_OnGuardWebSocketActionEvent(cmdIndex\x3d"+a+",param\x3d"+b+")");if(a==APSP_GetLocalPort_CONF){if(this._ctrlStatus==barStatus_GuardConnected){this._oGuradWS.WSDisconnect();var c=parseInt(b);-1==c?getLocalLanguage()==lg_zhcn?alert("MacCard.exe\u4e0d\u5b58\u5728"):alert("MacCard.exe not exist"):-2==c?getLocalLanguage()==lg_zhcn?alert("\u7535\u8bdd\u6761\u5b89\u88c5\u5305\u5b89\u88c5\u4e0d\u6b63\u786e"):alert("CINVccBar package setup failure"):this._OnFireEvent(GuardEvent_GetLocalPort,c)}}else a==APSP_UpdateSetup_CONF?("-1"==b?getLocalLanguage()==lg_zhcn?alert("\u81ea\u52a8\u66f4\u65b0\u7a0b\u5e8f\u4e0d\u5b58\u5728!"):alert("Ccupdate not exist!"):"-2"==b?getLocalLanguage()==lg_zhcn?alert("\u7535\u8bdd\u6761\u5b89\u88c5\u5305\u5b89\u88c5\u4e0d\u6b63\u786e!"):alert("CINVccBar package setup failure!"):"-3"==b?getLocalLanguage()==lg_zhcn?alert("\u66f4\u65b0\u53c2\u6570\u4e0d\u6b63\u786e!"):alert("Bad ccupdate parameter!"):"1"==b?1==(getLocalLanguage()==lg_zhcn?confirm("\u68c0\u6d4b\u5230\u670d\u52a1\u5668\u4e0a\u6709\u65b0\u7684\u7248\u672c,\u786e\u8ba4\u4f60\u662f\u5426\u8981\u66f4\u65b0?"):confirm("There are a new version,would you like to update?"))&&(this._cmdParam2="update",this._InvokeMethod(APSP_UpdateSetup_CONF,GetApspParam(this._cmdParam1,this._cmdParam2))):"0"==b&&(getLocalLanguage()==lg_zhcn?alert("\u6ca1\u6709\u65b0\u7684\u7248\u672c\u9700\u8981\u66f4\u65b0!"):alert("There are no new version!")),this._oGuradWS.WSDisconnect()):a==APSP_GetVersion_CONF&&(this._OnFireEvent(GuardEvent_GetVersion,b),this._IsGetVersion=!0,this._oGuradWS.WSDisconnect());this._ctrlStatus==barStatus_GuardDisconnecting;this._cmdType=cmd_GuardType_Null;this._cmdParam2=this._cmdParam1="";this._connectCount=0};this.apspCallbackGurad=function(a,b,g){a==APSP_Type_Prompt?this.oParent._OnGuardWebSocketEvent(b,g):a==APSP_Type_Action&&this.oParent._OnGuardWebSocketActionEvent(b,g)};this._Create();return this}function BeginAsynFunctionTimer(a){null==application.oJVccBar.GetBarCtrl()._asynMethodTimerID&&(application.oJVccBar.GetBarCtrl()._asynMethodTimerID=setInterval(function(){application.oJVccBar.GetBarCtrl().PopAsynResponseEvent()},a))}function EndAsynFunctionTimer(){null!=application.oJVccBar.GetBarCtrl()._asynMethodTimerID&&(clearInterval(application.oJVccBar.GetBarCtrl()._asynMethodTimerID),application.oJVccBar.GetBarCtrl()._asynMethodTimerID=null)}function JAsynFunctionItem(a,b){this.cmdName=a;this.param=b;return this}function JAsynFunctionManeger(){this.arrFunction=[];this._timerBgn=!1;this._timerID=null;this.getHeadItem=function(){return 0<this.arrFunction.length?this.arrFunction[0]:null};this.addNewItem=function(a,b){this.arrFunction.push(new JAsynFunctionItem(a,b))};this.removeHeadItem=function(){0<this.arrFunction.length&&this.arrFunction.splice(0,1)}}function JOcxCtrl(a,b,c,f,g,k){this.left=a;this.top=b;this.width=c;this.height=f;this.showFlag=g;this._contentWindow=null==k?window:k;this.id="oBar_"+Math.ceil(100*Math.random());this.name=this.id+"_Ctrl";this.isUnderMsie11="msie"==application.oBrowserSys.os&&11>application.oBrowserSys.version;this.oATL_BarShow=this.oBarShow=null;this._agentSubBusyStatus=-1;this.oEvent={};this.errDescription="";this.methodCallBack=this.eventCallBack=null;this.asynExecuteMethod=1;this._asynMethodTimerID=null;this.oAsynMothmod=new JAsynFunctionManeger;this._createObject=function(){this.oBarShow=this._contentWindow.document.createElement("DIV");this.oBarShow.style.cursor="move";this.oBarShow.style.position="absolute";this.oBarShow.style.padding="5px";this.oBarShow.style.border="1px";this.oBarShow.style.left=this.left+"px";this.oBarShow.style.top=this.top+"px";this._contentWindow.document.body.appendChild(this.oBarShow);try{1==this.isUnderMsie11?(this.oBarShow.innerHTML='\x3cOBJECT height\x3d"'+this.height+'" width\x3d"'+this.width+'" classid\x3d"clsid:3E006E71-9408-4F24-9F6D-69C81BD5682F" \x3e\x3c/OBJECT\x3e',this.oATL_BarShow=this.oBarShow.firstChild,this.oATL_BarShow.id="oATL_BarShow_Ctrl_"+this.id,this._attachOCXEvents()):(this.oBarShow.innerHTML='\x3cOBJECT height\x3d"'+this.height+'" width\x3d"'+this.width+'" classid\x3d"clsid:3E006E71-9408-4F24-9F6D-69C81BD5682F" \x3e\x3c/OBJECT\x3e',this.oATL_BarShow=this.oBarShow.firstChild,this.oATL_BarShow.id="oATL_BarShow_Ctrl_"+this.id,this._attachFOCXEvents()),this.Display(this.showFlag)}catch(l){alert("\u521b\u5efaOCX\u7535\u8bdd\u6761\u51fa\u9519:\u3010"+l.message+"\u3011")}};this._forEvent=function(a,d){var b=document.createElement("script");b.language="javascript";b.setAttribute("for",this.oATL_BarShow.id);b.event=a;b.text=d;document.body.appendChild(b)};this._attachFOCXEvents=function(){this._forEvent("OnCallRing(CallingNo,CalledNo,OrgCalledNo,CallData,SerialID,ServiceDirect,CallID,UserParam,TaskID,UserDn,AgentDn,AreaCode,filename,networkInfo,queueTime,opAgentID,ringTime,projectID,serverName,AccessCode, TaskName, CityName)","altEventOnCallRing(CallingNo,CalledNo,OrgCalledNo,CallData,SerialID,ServiceDirect,CallID,UserParam,TaskID,UserDn,AgentDn,AreaCode,filename,networkInfo,queueTime,opAgentID,ringTime,projectID,serverName,AccessCode, TaskName, CityName);");this._forEvent("AnswerCall(UserNo,AnswerTime,SerialID,ServiceDirect,CallID,UserParam,TaskID)","altEventOnAnswerCall(UserNo,AnswerTime,SerialID,ServiceDirect,CallID,UserParam,TaskID);");this._forEvent("OnCallEnd(CallID,SerialID,ServiceDirect,UserNo,BgnTime,EndTime,AgentAlertTime,UserAlertTime,FileName,Directory,DisconnectType,UserParam,TaskID,serverName,networkInfo)","altEventOnCallEnd(CallID,SerialID,ServiceDirect,UserNo,BgnTime,EndTime,AgentAlertTime,UserAlertTime,FileName,Directory,DisconnectType,UserParam,TaskID,serverName,networkInfo);");this._forEvent("OnPrompt(code,description)","altEventOnPrompt(code,description);");this._forEvent("ReportBtnStatus(btnIDS)","altEventOnReportBtnStatus(btnIDS);");this._forEvent("OnInitalSuccess()","altEventOnInitalSuccess();");this._forEvent("OnInitalFailure(code,description)","altEventOnInitalFailure(code,description);");this._forEvent("OnEventPrompt(eventIndex,eventParam)","altEventOnEventPrompt(eventIndex,eventParam);");this._forEvent("OnAgentWorkReport(workStatus,description)","altEventOnAgentWorkReport(workStatus,description);");this._forEvent("OnCallDataChanged(callData)","altEventOnCallDataChanged(callData);");this._forEvent("OnBarExit(code,description)","altEventOnBarExit(code,description);");this._forEvent("OnCallQueueQuery(QueueInfo)","altEventOnCallQueueQuery(QueueInfo);");this._forEvent("OnQueryGroupAgentStatus(QueryInfo,type)","altEventOnQueryGroupAgentStatus(QueryInfo,type);");this._forEvent("OnSystemMessage(code,description)","altEventOnSystemMessage(code,description);");this._forEvent("OnRecvWeiboMsg(message)","altEventOnRecvWeiboMsg(message);");this._forEvent("OnIMMessage(msgType,message,sender)","altEventOnIMMessage(msgType,message,sender);");this._forEvent("OnRecvWeChatMessage(sessionId,msgseq,type,userId,vccPublicId,msgType,content,sessionUrl,recongnition,msgevent,eventKey,title,data,timeStamp)","altEventOnRecvWeChatMessage(sessionId,msgseq,type,userId,vccPublicId,msgType,content,sessionUrl,recongnition,msgevent,eventKey,title,data,timeStamp);");this._forEvent("OnSendWeChatMsgReport(sessionId,msgseq,code,des,timeStamp)","altEventOnSendWeChatMsgReport(sessionId,msgseq,code,des,timeStamp);");this._forEvent("OnUploadFileToMMSReport(strFileName,status,strUrl,sessionId,userId,vccPublicId)","altEventOnUploadFileToMMSReport(strFileName,status,strUrl,sessionId,userId,vccPublicId);");this._forEvent("OnDownloadFileToMMSReport(strUrl,status,strFileName,msgSeq)","altEventOnDownloadFileToMMSReport(strUrl,status,strFileName,msgSeq);");this._forEvent("OnServiceStaticReport(staticInfo)","altEventOnServiceStaticReport(staticInfo);");this._forEvent("OnQuerySPGroupList(type,ctiInfo)","altEventOnQuerySPGroupList(type,ctiInfo);");this._forEvent("OnAgentBusyReason(type,des)","altEventOnAgentBusyReason(type,des);");this._forEvent("OnAgentLogUpload(destAgent,urlType,uploadServer,fileName,code,des)","altEventOnAgentLogUpload(destAgent,urlType,uploadServer,fileName,code,des);");this._forEvent("OnAsrEventReport(seq,timeStamp,lineNum,text)","altEventOnAsrEventReport(seq,timeStamp,lineNum,text);");this._forEvent("OnStopSmSuccess(smRescode)","altEventOnStopSmSuccess(smRescode);");this._forEvent("OnSessionMessage(info)","altEventOnSessionMessage(info);");this._forEvent("OnUpdateMediaEvent(cause,number,av)","altEventOnUpdateMediaEvent(cause,number,av);");this._forEvent("OnSnapShotPngEvent(data)","altEventOnSnapShotPngEvent(data);");this._forEvent("OnAgentReport(AgentReportInfo)","altEventOnAgentReport(AgentReportInfo);");this._forEvent("OnTelReport(TelReportInfo)","altEventOnTelReport(TelReportInfo);");this._forEvent("OnServiceReport(ServiceReportInfo)","altEventOnServiceReport(ServiceReportInfo);");this._forEvent("OnMMServiceReport(ServiceReportInfo)","altEventOnMMServiceReport(ServiceReportInfo);");this._forEvent("OnIvrReport(IvrReportInfo)","altEventOnIvrReport(IvrReportInfo);");this._forEvent("OnTaskReport(TaskReportInfo)","altEventOnTaskReport(TaskReportInfo);");this._forEvent("OnOutboundReport(TaskInfo)","altEventOnOutboundReport(TaskInfo);");this._forEvent("OnCallReportInfo(CallInfo)","altEventOnCallReportInfo(CallInfo);");this._forEvent("OnQueueReport(ServiceReportInfo)","altEventOnQueueReport(ServiceReportInfo);");this._forEvent("OnQueryMonitorSumReport(cmdName,reportInfo)","altEventOnQueryMonitorSumReport(cmdName,reportInfo);");this._forEvent("OnWallServiceReport(serviceReportInfo)","altEventOnWallServiceReport(serviceReportInfo);");this._forEvent("OnWallQueueReport(queueInfo)","altEventOnWallQueueReport(queueInfo);");this._forEvent("OnWorkStaticInfoReport(staticInfo)","altEventOnWorkStaticInfoReport(staticInfo);");this._forEvent("OnAgentStaticReport(staticInfo)","altEventOnAgentStaticReport(staticInfo);");this._forEvent("OnTrunkReport(trunkInfo)","altEventOnTrunkReport(trunkInfo);");this._forEvent("OnTrunkSumReport(trunkInfo)","altEventOnTrunkSumReport(trunkInfo);")};this._attachOCXEvents=function(){this.oATL_BarShow.attachEvent("OnCallRing",altEventOnCallRing);this.oATL_BarShow.attachEvent("AnswerCall",altEventOnAnswerCall);this.oATL_BarShow.attachEvent("OnCallEnd",altEventOnCallEnd);this.oATL_BarShow.attachEvent("OnPrompt",altEventOnPrompt);this.oATL_BarShow.attachEvent("ReportBtnStatus",altEventOnReportBtnStatus);this.oATL_BarShow.attachEvent("OnInitalSuccess",altEventOnInitalSuccess);this.oATL_BarShow.attachEvent("OnInitalFailure",altEventOnInitalFailure);this.oATL_BarShow.attachEvent("OnEventPrompt",altEventOnEventPrompt);this.oATL_BarShow.attachEvent("OnAgentWorkReport",altEventOnAgentWorkReport);this.oATL_BarShow.attachEvent("OnCallDataChanged",altEventOnCallDataChanged);this.oATL_BarShow.attachEvent("OnBarExit",altEventOnBarExit);this.oATL_BarShow.attachEvent("OnCallQueueQuery",altEventOnCallQueueQuery);this.oATL_BarShow.attachEvent("OnQueryGroupAgentStatus",altEventOnQueryGroupAgentStatus);this.oATL_BarShow.attachEvent("OnSystemMessage",altEventOnSystemMessage);this.oATL_BarShow.attachEvent("OnRecvWeiboMsg",altEventOnRecvWeiboMsg);this.oATL_BarShow.attachEvent("OnIMMessage",altEventOnIMMessage);this.oATL_BarShow.attachEvent("OnRecvWeChatMessage",altEventOnRecvWeChatMessage);this.oATL_BarShow.attachEvent("OnSendWeChatMsgReport",altEventOnSendWeChatMsgReport);this.oATL_BarShow.attachEvent("OnUploadFileToMMSReport",altEventOnUploadFileToMMSReport);this.oATL_BarShow.attachEvent("OnDownloadFileToMMSReport",altEventOnDownloadFileToMMSReport);this.oATL_BarShow.attachEvent("OnServiceStaticReport",altEventOnServiceStaticReport);this.oATL_BarShow.attachEvent("OnQuerySPGroupList",altEventOnQuerySPGroupList);this.oATL_BarShow.attachEvent("OnAgentBusyReason",altEventOnAgentBusyReason);this.oATL_BarShow.attachEvent("OnAgentLogUpload",altEventOnAgentLogUpload);this.oATL_BarShow.attachEvent("OnAsrEventReport",altEventOnAsrEventReport);this.oATL_BarShow.attachEvent("OnStopSmSuccess",altEventOnStopSmSuccess);this.oATL_BarShow.attachEvent("OnSessionMessage",altEventOnSessionMessage);this.oATL_BarShow.attachEvent("OnUpdateMediaEvent",altEventOnUpdateMediaEvent);this.oATL_BarShow.attachEvent("OnSnapShotPngEvent",altEventOnSnapShotPngEvent);this.oATL_BarShow.attachEvent("OnAgentReport",altEventOnAgentReport);this.oATL_BarShow.attachEvent("OnTelReport",altEventOnTelReport);this.oATL_BarShow.attachEvent("OnServiceReport",altEventOnServiceReport);this.oATL_BarShow.attachEvent("OnMMServiceReport",altEventOnMMServiceReport);this.oATL_BarShow.attachEvent("OnIvrReport",altEventOnIvrReport);this.oATL_BarShow.attachEvent("OnTaskReport",altEventOnTaskReport);this.oATL_BarShow.attachEvent("OnOutboundReport",altEventOnOutboundReport);this.oATL_BarShow.attachEvent("OnCallReportInfo",altEventOnCallReportInfo);this.oATL_BarShow.attachEvent("OnQueueReport",altEventOnQueueReport);this.oATL_BarShow.attachEvent("OnQueryMonitorSumReport",altEventOnQueryMonitorSumReport);this.oATL_BarShow.attachEvent("OnWallServiceReport",altEventOnWallServiceReport);this.oATL_BarShow.attachEvent("OnWallQueueReport",altEventOnWallQueueReport);this.oATL_BarShow.attachEvent("OnWorkStaticInfoReport",altEventOnWorkStaticInfoReport);this.oATL_BarShow.attachEvent("OnAgentStaticReport",altEventOnAgentStaticReport);this.oATL_BarShow.attachEvent("OnTrunkReport",altEventOnTrunkReport);this.oATL_BarShow.attachEvent("OnTrunkSumReport",altEventOnTrunkSumReport)};this._invokeEvent=function(a,d){null!=this.eventCallBack&&this.eventCallBack(a,d)};this._OnCallRing=function(a,d,b,h,e,c,f,g,k,q,m,r,u,v,w,y,A,B,C,D,E,F){this._invokeEvent(eventOnCallRing,GetApspParam(a,d,b,h,e,c,f,g,k,q,m,r,u,v,w,y,A,B,C,D,E,F))};this._OnAnswerCall=function(a,d,b,h,e,c,f,g,k){this._invokeEvent(eventOnAnswerCall,GetApspParam(a,d,b,h,e,c,f,g,k))};this._OnCallEnd=function(a,d,b,h,e,c,f,g,k,q,m,r,u,v,w){this._invokeEvent(eventOnCallEnd,GetApspParam(a,d,b,h,e,c,f,g,k,q,m,r,u,v,w))};this._OnPrompt=function(a,d){this._invokeEvent(eventOnPrompt,GetApspParam(a,""))};this._OnReportBtnStatus=function(a){this._invokeEvent(eventOnReportBtnStatus,a)};this._OnInitalSuccess=function(){this._invokeEvent(eventOnInitalSuccess,GetApspParam())};this._OnInitalFailure=function(a,d){this._invokeEvent(eventOnInitalFailure,GetApspParam(a,d))};this._OnEventPrompt=function(a,d){this._invokeEvent(eventOnEventPrompt,GetApspParam(a,d))};this._OnAgentWorkReport=function(a,d){this._invokeEvent(eventOnAgentWorkReport,GetApspParam(a,d))};this._OnCallDataChanged=function(a){this._invokeEvent(eventOnCallDataChanged,a)};this._OnBarExit=function(a,d){this._invokeEvent(eventOnBarExit,GetApspParam(a,d))};this._OnCallQueueQuery=function(a){this._invokeEvent(eventOnCallQueueQuery,a)};this._OnQuerySPGroupList=function(a,d){this._invokeEvent(eventOnAQueryCTIInfoReport,GetApspParam(a,d))};this._OnAgentBusyReason=function(a,d){this._invokeEvent(eventOnAgentBusyReasonReport,GetApspParam(a,d))};this._OnAgentLogUpload=function(a,d,b,h,e,c){this._invokeEvent(eventOnAgentLogUploadReport,GetApspParam(a,d,b,h,e,c))};this._OnQueryGroupAgentStatus=function(a,d){"undefined"==typeof d&&(d=0);this._invokeEvent(eventOnQueryGroupAgentStatus,a+"@"+d)};this._OnSystemMessage=function(a,d){this._invokeEvent(eventOnSystemMessage,GetApspParam(a,d))};this._OnRecvWeiboMsg=function(a){this._invokeEvent(eventOnRecvWeiboMsg,a)};this._OnIMMessage=function(a,d,b){this._invokeEvent(eventOnIMMessage,GetApspParam(a,b,d))};this._OnRecvWeChatMessage=function(a,d,b,h,e,c,f,g,k,q,m,r,u,v){this._invokeEvent(eventOnRecvWeChatMessage,GetApspParam(a,d,b,h,e,c,f,g,k,q,m,r,u,v))};this._OnSendWeChatMsgReport=function(a,d,b,h,e){this._invokeEvent(eventOnSendWeChatMsgReport,GetApspParam(a,d,b,h,e))};this._OnUploadFileToMMSReport=function(a,d,b,h,e,c){this._invokeEvent(eventOnUploadFileToMMSReport,GetApspParam(a,d,b,h,e,c))};this._OnDownloadFileToMMSReport=function(a,d,b,h){this._invokeEvent(eventOnDownloadFileToMMSReport,GetApspParam(a,d,b,h))};this._OnWorkStaticInfoReport=function(a){this._invokeEvent(eventOnWorkStaticInfoReport,a)};this._OnQueueReport=function(a){this._invokeEvent(eventOnQueueReport,a)};this._OnAsrEventReport=function(a,d,b,h){this._invokeEvent(eventOnAsrEventReport,GetApspParam(a,d,b,h))};this._OnStopSmSuccess=function(a){this._invokeEvent(eventOnStopSmSuccess,a)};this._OnSessionMessage=function(a){this._invokeEvent(eventOnSessinMessage,a)};this._OnUpdateMediaEvent=function(a,d,b){this._invokeEvent(eventOnUpdateMediaEvent,GetApspParam(a,d,b))};this._OnSnapShotPngEvent=function(a){this._invokeEvent(eventOnSnapShotPngEvent,a)};this._OnStopCaptureSuccess=function(a,d){this._invokeEvent(eventOnStopCaptureSuccess,GetApspParam(a,d))};this._OnAgentReport=function(a){this._invokeEvent(eventOnAgentReport,a)};this._OnTelReport=function(a){this._invokeEvent(eventOnTelReport,a)};this._OnServiceReport=function(a){this._invokeEvent(eventOnServiceReport,a)};this._OnMMServiceReport=function(a){this._invokeEvent(eventOnMMServiceReport,a)};this._OnIvrReport=function(a){this._invokeEvent(eventOnIvrReport,a)};this._OnTaskReport=function(a){this._invokeEvent(eventOnTaskReport,a)};this._OnOutboundReport=function(a){this._invokeEvent(eventOnOutboundReport,a)};this._OnCallReportInfo=function(a){this._invokeEvent(eventOnCallReportInfo,a)};this._OnQueryMonitorSumReport=function(a,d){this._invokeEvent(eventOnQueryMonitorSumReport,GetApspParam(a,d))};this._OnWallServiceReport=function(a){this._invokeEvent(eventOnWallServiceReport,a)};this._OnWallQueueReport=function(a){this._invokeEvent(eventOnWallQueueReport,a)};this._OnServiceStaticReport=function(a){this._invokeEvent(eventOnServiceStaticReport,a)};this._OnAgentStaticReport=function(a){this._invokeEvent(eventOnAgentStaticReport,a)};this._OnTrunkReport=function(a){this._invokeEvent(eventOnTrunkReport,a)};this._OnTrunkSumReport=function(a){this._invokeEvent(eventOnTrunkSumReport,a)};this.PopAsynResponseEvent=function(){var a=this.oAsynMothmod.getHeadItem();null!=a&&(this._invokeAsynMethodReturn(a.cmdName,a.param),DisplayLog(VccBar_Log_Debug,"JOCXBar:PopAsynResponseEvent(cmdName:\u3010"+a.cmdName+"\u3011 param: \u3010"+a.param+"\u3011)"),this.oAsynMothmod.removeHeadItem())};this._invokeAsynMethodReturn=function(a,d){null!=this.methodCallBack&&this.methodCallBack(a,d)};this.AsynInvokeMechod=function(a,d){return 1==this.asynExecuteMethod?(BeginAsynFunctionTimer(500),DisplayLog(VccBar_Log_Debug,"JOCXBar:AsynInvokeMechod(cmdName:\u3010"+a+"\u3011 param: \u3010"+d+"\u3011)"),this.oAsynMothmod.addNewItem(a,d),0):d};this.GetBarType=function(){return vccBarTypeOCX};this.Initial=function(){return this.AsynInvokeMechod("Initial",this.oATL_BarShow.Initial())};this.SerialBtn=function(a,d){return this.AsynInvokeMechod("SerialBtn",this.oATL_BarShow.SerialBtn(a,d))};this.GetBtnStatus=function(a){return this.AsynInvokeMechod("GetBtnStatus",this.oATL_BarShow.GetBtnStatus(a))};this.Configurate=function(a){return this.AsynInvokeMechod("Configurate",this.oATL_BarShow.Configurate(a))};this.GetConfiguration=function(){return this.AsynInvokeMechod("GetConfiguration",this.oATL_BarShow.GetConfiguration())};this.UnInitial=function(a){return this.AsynInvokeMechod("UnInitial",this.oATL_BarShow.UnInitial(a))};this.SetUIStyle=function(a){return this.AsynInvokeMechod("SetUIStyle",this.oATL_BarShow.SetUIStyle(a))};this.GetVersion=function(){return this.oATL_BarShow.GetVersion()};this.SetBusy=function(a){var d=this.oATL_BarShow.SetBusy(a);0==d&&(this._agentSubBusyStatus=a);return d=this.AsynInvokeMechod("SetBusy",d)};this.SetIdle=function(){return this.AsynInvokeMechod("SetIdle",this.oATL_BarShow.SetIdle())};this.SetWrapUp=function(){return this.AsynInvokeMechod("SetWrapUp",this.oATL_BarShow.SetWrapUp())};this.SetCTICalloutTask=function(a){return this.AsynInvokeMechod("SetCTICalloutTask",this.oATL_BarShow.SetCTICalloutTask(a))};this.GetCTICalloutTask=function(){return this.AsynInvokeMechod("GetCTICalloutTask",this.oATL_BarShow.GetCTICalloutTask())};this.GetCallData=function(a){return this.AsynInvokeMechod("GetCallData",this.oATL_BarShow.GetCallData(a))};this.SetCallData=function(a,d){return this.AsynInvokeMechod("SetCallData",this.oATL_BarShow.SetCallData(a,d))};this.GetTransfer=function(){return this.AsynInvokeMechod("GetTransfer",this.oATL_BarShow.GetTransfer())};this.SetTransfer=function(a,d,b){return this.AsynInvokeMechod("SetTransfer",this.oATL_BarShow.SetTransfer(a,d,b))};this.ChangeCallQueue=function(a,d,b){return this.AsynInvokeMechod("ChangeCallQueue",this.oATL_BarShow.ChangeCallQueue(a,d,b))};this.GetCallID=function(){return this.AsynInvokeMechod("GetCallID",this.oATL_BarShow.GetCallID())};this.QuerySPGroupList=function(a,d,b,h,e,c){return this.AsynInvokeMechod("QuerySPGroupList",this.oATL_BarShow.QuerySPGroupList(a,d,b,h,e,c))};this.GetCallInfo=function(){return this.AsynInvokeMechod("GetCallInfo",this.oATL_BarShow.GetCallInfo())};this.SetTransparentParameter=function(a){return this.AsynInvokeMechod("SetTransparentParameter",this.oATL_BarShow.SetTransparentParameter(a))};this.GetAgentStatus=function(){return this.oATL_BarShow.GetAgentStatus()};this.GetAgentSubBusyStatus=function(){return 1==this.oATL_BarShow.GetAgentStatus()?this._agentSubBusyStatus:-1};this.GetBusySubStatus=function(){return this.oATL_BarShow.GetBusySubStatus()};this.SetDisplayNumber=function(a){return this.AsynInvokeMechod("SetDisplayNumber",this.oATL_BarShow.SetDisplayNumber(a))};this.GetDisplayNumber=function(){return this.AsynInvokeMechod("GetDisplayNumber",this.oATL_BarShow.GetDisplayNumber())};this.CallQueueQuery=function(a,d,b){"undefined"==typeof d&&(d=2);"undefined"==typeof b&&(b=0);return this.AsynInvokeMechod("CallQueueQuery",this.oATL_BarShow.CallQueueQuery(a,d,b))};this.QueryGroupAgentStatus=function(a,d,b,h){return this.AsynInvokeMechod("QueryGroupAgentStatus",this.oATL_BarShow.QueryGroupAgentStatus(a,d,b,h))};this.QueryPreViewCallOutNumbers=function(a,d,b,h){return this.AsynInvokeMechod("QueryPreViewCallOutNumbers",this.oATL_BarShow.QueryPreViewCallOutNumbers(a,d,b,h))};this.QueryMonitorSumInfo=function(a,d){return this.AsynInvokeMechod("QueryMonitorSumInfo",this.oATL_BarShow.QueryMonitorSumInfo(a,d))};this.GetBase64Data=function(a){return this.oATL_BarShow.GetBase64Data(a)};this.GetDataFromBase64=function(a){return this.oATL_BarShow.GetDataFromBase64(a)};this.SetWeChatQueueFlag=function(a){return this.AsynInvokeMechod("SetWeChatQueueFlag",this.oATL_BarShow.SetWeChatQueueFlag(a))};this.GetWeChatQueueFlag=function(){return this.AsynInvokeMechod("GetWeChatQueueFlag",this.oATL_BarShow.GetWeChatQueueFlag())};this.TransferCallQueue=function(a,d,b){return this.AsynInvokeMechod("TransferCallQueue",this.oATL_BarShow.TransferCallQueue(a,d,b))};this.SetActiveService=function(a){return this.AsynInvokeMechod("SetActiveService",this.oATL_BarShow.SetActiveService(a))};this.GetActiveService=function(){return this.AsynInvokeMechod("GetActiveService",this.oATL_BarShow.GetActiveService())};this.GetExitCause=function(){return this.oATL_BarShow.GetExitCause()};this.SetForwardNumber=function(a,d){return this.AsynInvokeMechod("SetForwardNumber",this.oATL_BarShow.SetForwardNumber(a,d))};this.GetForwardNumber=function(){return this.AsynInvokeMechod("GetForwardNumber",this.oATL_BarShow.GetForwardNumber())};this.SetAgentReservedStatus=function(a,d){return this.AsynInvokeMechod("SetAgentReservedStatus",this.oATL_BarShow.SetAgentReservedStatus(a,d))};this.GetAgentLogFile=function(a,d,b){return this.AsynInvokeMechod("GetAgentLogFile",this.oATL_BarShow.GetAgentLogFile(a,d,b))};this.GetMonitorOffSetTime=function(){return this.oATL_BarShow.GetMonitorOffSetTime()};this.SetMMService=function(a,d){return this.AsynInvokeMechod("SetMMService",this.oATL_BarShow.SetMMService(a,d))};this.MakeCall=function(a,d,b,h,e,c,f,g,k,q,m){"undefined"==typeof f&&(f=0);d=getDefaultParam(d);""==d&&(d=CD_PREVIEW_CALLOUT);"undefined"==typeof b&&(b="");"undefined"==typeof h&&(h="");"undefined"==typeof e&&(e="");"undefined"==typeof c&&(c="");"undefined"==typeof g&&(g="");"undefined"==typeof k&&(k="");"undefined"==typeof q&&(q="");"undefined"==typeof m&&(m="");return this.AsynInvokeMechod("MakeCall",this.oATL_BarShow.MakeCall(a,d,b,h,e,c,f,g,k,q,m))};this.CallIn=function(a,d,b,h,e){d=getDefaultParam(d);""==d&&(d=CD_AGENT_INSIDE_CALLOUT);"undefined"==typeof b&&(b="");"undefined"==typeof h&&(h="");"undefined"==typeof e&&(e="");return this.AsynInvokeMechod("CallIn",this.oATL_BarShow.CallIn(a,d,b,h,e))};this.TransferOut=function(a,d){return this.AsynInvokeMechod("TransferOut",this.oATL_BarShow.TransferOut(a,d))};this.Hold=function(a){getDefaultParam(a);return this.AsynInvokeMechod("Hold",this.oATL_BarShow.Hold())};this.RetrieveHold=function(a){getDefaultParam(a);return this.AsynInvokeMechod("RetrieveHold",this.oATL_BarShow.RetrieveHold())};this.Disconnect=function(a){"undefined"==typeof a&&(a=0);return this.AsynInvokeMechod("Disconnect",this.oATL_BarShow.Disconnect(a))};this.Answer=function(a){"undefined"==typeof a&&(a=0);return this.AsynInvokeMechod("Answer",this.oATL_BarShow.Answer(a))};this.Consult=function(a,d){return this.AsynInvokeMechod("Consult",this.oATL_BarShow.Consult(a,d))};this.Transfer=function(){return this.AsynInvokeMechod("Transfer",this.oATL_BarShow.Transfer())};this.Conference=function(){return this.AsynInvokeMechod("Conference",this.oATL_BarShow.Conference())};this.SendDTMF=function(a){return this.AsynInvokeMechod("SendDTMF",this.oATL_BarShow.SendDTMF(a))};this.Bridge=function(a,d){return this.AsynInvokeMechod("Bridge",this.oATL_BarShow.Bridge(a,d))};this.Mute=function(a,d){return this.AsynInvokeMechod("Mute",this.oATL_BarShow.Mute(a))};this.ReleaseThirdOne=function(a){return this.AsynInvokeMechod("ReleaseThirdOne",this.oATL_BarShow.ReleaseThirdOne(a))};this.ForceReset=function(){return this.AsynInvokeMechod("ForceReset",this.oATL_BarShow.ForceReset())};this.SendIMMessage=function(a,d,b,h,e,c){return this.AsynInvokeMechod("SendIMMessage",this.oATL_BarShow.SendIMMessage(a,d,b,h,e,c))};this.SendIMMessage2=function(a,d,b){return this.AsynInvokeMechod("SendIMMessage2",this.oATL_BarShow.SendIMMessage2(a,d,b))};this.WinCap=function(a,d,b){return this.AsynInvokeMechod("WinCap",this.oATL_BarShow.WinCap(a,d,b))};this.SendSipSessionMessage=function(a){return this.AsynInvokeMechod("SendSipSessionMessage",this.oATL_BarShow.SendSipSessionMessage(a))};this.UpdateMedia=function(a,d){return this.AsynInvokeMechod("UpdateMedia",this.oATL_BarShow.UpdateMedia(a,d))};this.BeginCapture=function(a,d){"undefined"==typeof a&&(a="");"undefined"==typeof d&&(d="1");return this.AsynInvokeMechod("BeginCapture",this.oATL_BarShow.BeginCapture(a,d))};this.Connect=function(a){return this.AsynInvokeMechod("Connect",this.oATL_BarShow.Connect(a))};this.ReleaseConnectOne=function(a){return this.AsynInvokeMechod("ReleaseConnectOne",this.oATL_BarShow.ReleaseConnectOne(a))};this.MultiConfTransfer=function(a){return this.AsynInvokeMechod("MultiConfTransfer",this.oATL_BarShow.MultiConfTransfer(a))};this.BeginPlay=function(a,d,b,h,e){return this.AsynInvokeMechod("BeginPlay",this.oATL_BarShow.BeginPlay(a,d,b,h,e))};this.StopPlay=function(a,d){return this.AsynInvokeMechod("StopPlay",this.oATL_BarShow.StopPlay(a,d))};this.BeginCollect=function(a,d,b,h,e,c,f,g,k,q){return this.AsynInvokeMechod("BeginCollect",this.oATL_BarShow.BeginCollect(a,d,b,h,e,c,f,g,k,q))};this.StopCollect=function(a,d){return this.AsynInvokeMechod("StopCollect",this.oATL_BarShow.StopCollect(a,d))};this.BeginRecord=function(a,d){return this.AsynInvokeMechod("BeginRecord",this.oATL_BarShow.BeginRecord(a,d))};this.StopRecord=function(a){return this.AsynInvokeMechod("StopRecord",this.oATL_BarShow.StopRecord(a))};this.AlterNate=function(a){return this.AsynInvokeMechod("AlterNate",this.oATL_BarShow.AlterNate(a))};this.CallBack=function(){return this.AsynInvokeMechod("CallBack",this.oATL_BarShow.CallBack())};this.ReCall=function(){return this.AsynInvokeMechod("ReCall",this.oATL_BarShow.ReCall())};this.SMMsg=function(a,d){return this.AsynInvokeMechod("SMMsg",this.oATL_BarShow.SMMsg(a,d))};this.ForeReleaseCall=function(a,d){return this.AsynInvokeMechod("ForeReleaseCall",this.oATL_BarShow.ForeReleaseCall(a,d))};this.Insert=function(a,d,b){return this.AsynInvokeMechod("Insert",this.oATL_BarShow.Insert(a,d,b))};this.Listen=function(a,d,b){return this.AsynInvokeMechod("Listen",this.oATL_BarShow.Listen(a,d,b))};this.Intercept=function(a,d,b,h){return this.AsynInvokeMechod("Intercept",this.oATL_BarShow.Intercept(a,d,b,h))};this.Help=function(a,d,b){return this.AsynInvokeMechod("Help",this.oATL_BarShow.Help(a,d,b))};this.Lock=function(a){return this.AsynInvokeMechod("Lock",this.oATL_BarShow.Lock(a))};this.UnLock=function(a){return this.AsynInvokeMechod("UnLock",this.oATL_BarShow.UnLock(a))};this.ForceIdle=function(a){return this.AsynInvokeMechod("ForceIdle",this.oATL_BarShow.ForceIdle(a))};this.ForceBusy=function(a){return this.AsynInvokeMechod("ForceBusy",this.oATL_BarShow.ForceBusy(a))};this.ForceOut=function(a){return this.AsynInvokeMechod("ForceOut",this.oATL_BarShow.ForceOut(a))};this.InitialState=function(){return this.AsynInvokeMechod("InitialState",this.oATL_BarShow.InitialState())};this.AgentQuery=function(a,d,b){return this.AsynInvokeMechod("AgentQuery",this.oATL_BarShow.AgentQuery(a,d,b))};this.TelQuery=function(a,d){return this.AsynInvokeMechod("TelQuery",this.oATL_BarShow.TelQuery(a,d))};this.IvrQuery=function(a,d){return this.AsynInvokeMechod("IvrQuery",this.oATL_BarShow.IvrQuery(a,d))};this.TrunkQuery=function(a,d){return this.AsynInvokeMechod("TrunkQuery",this.oATL_BarShow.TrunkQuery(a,d))};this.ServiceQuery=function(a,d){return this.AsynInvokeMechod("ServiceQuery",this.oATL_BarShow.ServiceQuery(a,d))};this.MMServiceQuery=function(a){return this.AsynInvokeMechod("MMServiceQuery",this.oATL_BarShow.MMServiceQuery(a))};this.AgentStateQuery=function(a,d,b,h){d=getDefaultParamValue(d,0);b=getDefaultParamValue(b,200);500<b&&(b=500);h=getDefaultParamValue(h,0);this.AsynInvokeMechod("AgentStateQuery",this.oATL_BarShow.AgentStateQuery(a,d,b,h))};this.TaskQuery=function(a,d){return this.AsynInvokeMechod("TaskQuery",this.oATL_BarShow.TaskQuery(a,d))};this.CallReportQuery=function(a,d){return this.AsynInvokeMechod("CallReportQuery",this.oATL_BarShow.CallReportQuery(a,d))};this.GetTaskSummary=function(a,d){return this.AsynInvokeMechod("GetTaskSummary",this.oATL_BarShow.GetTaskSummary(a,d))};this.StartNotification=function(a,d,b){return this.AsynInvokeMechod("StartNotification",this.oATL_BarShow.StartNotification(a,d,b))};this.EndNotification=function(a){return this.AsynInvokeMechod("EndNotification",this.oATL_BarShow.EndNotification(a))};this.SendWeiboMsg=function(a){return this.AsynInvokeMechod("SendWeiboMsg",this.oATL_BarShow.SendWeiboMsg(a))};this.UploadFileToMMS=function(a,d,b,h){return this.AsynInvokeMechod("UploadFileToMMS",this.oATL_BarShow.UploadFileToMMS(a,d,b,h))};this.DownFileFromMMS=function(a,d,b,h,e){return this.AsynInvokeMechod("DownFileFromMMS",this.oATL_BarShow.DownFileFromMMS(a,d,b,h,e))};this.SendWeChatMsg=function(a,d,b,h,e,c,f,g,k,q){return this.AsynInvokeMechod("SendWeChatMsg",this.oATL_BarShow.SendWeChatMsg(a,d,b,h,e,c,f,g,k,q))};this.QueryWeChatData=function(a,d,b,h,e,c,f){return this.AsynInvokeMechod("QueryWeChatData",this.oATL_BarShow.QueryWeChatData(a,d,b,h,e,c,f))};this.QueryWeChatHistory=function(a,d,b,h,e,c,f){return this.AsynInvokeMechod("QueryWeChatHistory",this.oATL_BarShow.QueryWeChatHistory(a,d,b,h,e,c,f))};this.GetWeChatParam=function(a){return this.AsynInvokeMechod("GetWeChatParam",this.oATL_BarShow.GetWeChatParam(a))};this.SetCtrlAttribute=function(a,d){"MainIP"==a?this.oATL_BarShow.MainIP=d:"BackIP"==a?this.oATL_BarShow.BackIP=d:"MainPortID"==a?this.oATL_BarShow.MainPortID=d:"BackPortID"==a?this.oATL_BarShow.BackPortID=d:"AgentID"==a?this.oATL_BarShow.AgentID=d:"Dn"==a?this.oATL_BarShow.Dn=d:"PassWord"==a?this.oATL_BarShow.PassWord=d:"MediaFlag"==a?this.oATL_BarShow.MediaFlag=d:"PhonType"==a?this.oATL_BarShow.PhonType=d:"AppType"==a?this.oATL_BarShow.AppType=d:"SipServerIP"==a?this.oATL_BarShow.SipServerIP=d:"SipServerPort"==a?this.oATL_BarShow.SipServerPort=d:"SipProtocol"==a?this.oATL_BarShow.SipProtocol=d:"SipDn"==a?this.oATL_BarShow.SipDn=d:"SipAuthType"==a?this.oATL_BarShow.SipAuthType=d:"SipDomain"==a?this.oATL_BarShow.SipDomain=d:"SipPassWord"==a?this.oATL_BarShow.SipPassWord=d:"SipBackServerIP"==a?this.oATL_BarShow.SipBackServerIP=d:"SipBackServerPort"==a?this.oATL_BarShow.SipBackServerPort=d:"SipBackProtocol"==a?this.oATL_BarShow.SipBackProtocol=d:"SipBackAuthType"==a?this.oATL_BarShow.SipBackAuthType=d:"SipBackDomain"==a?this.oATL_BarShow.SipBackDomain=d:"SipBackPassWord"==a?this.oATL_BarShow.SipBackPassWord=d:"MonitorIP"==a?this.oATL_BarShow.MonitorIP=d:"MonitorPort"==a?this.oATL_BarShow.MonitorPort=d:"WeChatServer"==a?this.oATL_BarShow.WeChatServer=d:"SelfPrompt"==a?this.oATL_BarShow.SelfPrompt=d:"MinotorVersion"==a?this.oATL_BarShow.MinotorVersion=d:"TaskID"==a?this.oATL_BarShow.TaskID=d:"AutoUpdateURL"==a?this.oATL_BarShow.AutoUpdateURL=d:"SipPassWdCryptType"==a?this.oATL_BarShow.SipPassWdCryptType=d:"PassWdCryptType"==a?this.oATL_BarShow.PassWdCryptType=d:"AutoSelectAgent"==a?this.oATL_BarShow.AutoSelectAgent=d:"VersionType"==a?this.oATL_BarShow.VersionType=d:"CurUseServer"==a?this.oATL_BarShow.CurUseServer=d:"AutoExChangeServer"==a?this.oATL_BarShow.AutoExChangeServer=d:"IsAllTimeRecord"==a?this.oATL_BarShow.IsAllTimeRecord=d:"RecordType"==a?this.oATL_BarShow.RecordType=d:"AgentName"==a?this.oATL_BarShow.AgentName=d:"msgFlag"==a?this.oATL_BarShow.msgFlag=d:"AgentType"==a?this.oATL_BarShow.AgentType=d:"LocalPort"==a?this.oATL_BarShow.LocalPort=d:"ServiceLists"==a?this.oATL_BarShow.ServiceLists=d:"TimeOut"==a?this.oATL_BarShow.TimeOut=d:"ftpServerIP"==a?this.oATL_BarShow.ftpServerIP=d:"ftpServerPort"==a?this.oATL_BarShow.ftpServerPort=d:"ftpUser"==a?this.oATL_BarShow.ftpUser=d:"ftpPassWord"==a?this.oATL_BarShow.ftpPassWord=d:"ftpDirectory"==a?this.oATL_BarShow.ftpDirectory=d:"ftpType"==a?this.oATL_BarShow.ftpType=d:"forceEndProcess"!=a&&DisplayLog(VccBar_Log_Error,"bad attribute name:"+a)};this.GetCtrlAttribute=function(a){if("MainIP"==a)return this.oATL_BarShow.MainIP;if("BackIP"==a)return this.oATL_BarShow.BackIP;if("MainPortID"==a)return this.oATL_BarShow.MainPortID;if("BackPortID"==a)return this.oATL_BarShow.BackPortID;if("AgentID"==a)return this.oATL_BarShow.AgentID;if("Dn"==a)return this.oATL_BarShow.Dn;if("PassWord"==a)return this.oATL_BarShow.PassWord;if("MediaFlag"==a)return this.oATL_BarShow.MediaFlag;if("PhonType"==a)return this.oATL_BarShow.PhonType;if("AppType"==a)return this.oATL_BarShow.AppType;if("SipServerIP"==a)return this.oATL_BarShow.SipServerIP;if("SipServerPort"==a)return this.oATL_BarShow.SipServerPort;if("SipProtocol"==a)return this.oATL_BarShow.SipProtocol;if("SipDn"==a)return this.oATL_BarShow.SipDn;if("SipAuthType"==a)return this.oATL_BarShow.SipAuthType;if("SipDomain"==a)return this.oATL_BarShow.SipDomain;if("SipPassWord"==a)return this.oATL_BarShow.SipPassWord;if("SipBackServerIP"==a)return this.oATL_BarShow.SipBackServerIP;if("SipBackServerPort"==a)return this.oATL_BarShow.SipBackServerPort;if("SipBackProtocol"==a)return this.oATL_BarShow.SipBackProtocol;if("SipBackAuthType"==a)return this.oATL_BarShow.SipBackAuthType;if("SipBackDomain"==a)return this.oATL_BarShow.SipBackDomain;if("SipBackPassWord"==a)return this.oATL_BarShow.SipBackPassWord;if("MonitorIP"==a)return this.oATL_BarShow.MonitorIP;if("MonitorPort"==a)return this.oATL_BarShow.MonitorPort;if("WeChatServer"==a)return this.oATL_BarShow.WeChatServer;if("SelfPrompt"==a)return this.oATL_BarShow.SelfPrompt;if("MinotorVersion"==a)return this.oATL_BarShow.MinotorVersion;if("TaskID"==a)return this.oATL_BarShow.TaskID;if("AutoUpdateURL"==a)return this.oATL_BarShow.AutoUpdateURL;if("PassWdCryptType"==a)return this.oATL_BarShow.SipPassWdCryptType;if("SipPassWdCryptType"==a)return this.oATL_BarShow.PassWdCryptType;if("AutoSelectAgent"==a)return this.oATL_BarShow.AutoSelectAgent;if("VersionType"==a)return this.oATL_BarShow.VersionType;if("CurUseServer"==a)return this.oATL_BarShow.CurUseServer;if("AutoExChangeServer"==a)return this.oATL_BarShow.AutoExChangeServer;if("IsAllTimeRecord"==a)return this.oATL_BarShow.IsAllTimeRecord;if("RecordType"==a)return this.oATL_BarShow.RecordType;if("AgentName"==a)return this.oATL_BarShow.AgentName;if("msgFlag"==a)return this.oATL_BarShow.msgFlag;if("AgentType"==a)return this.oATL_BarShow.AgentType;if("LocalPort"==a)return this.oATL_BarShow.LocalPort;if("ServiceLists"==a)return this.oATL_BarShow.ServiceLists;if("TimeOut"==a)return this.oATL_BarShow.TimeOut;if("ftpServerIP"==a)return this.oATL_BarShow.ftpServerIP;if("ftpServerPort"==a)return this.oATL_BarShow.ftpServerPort;if("ftpUser"==a)return this.oATL_BarShow.ftpUser;if("ftpPassWord"==a)return this.oATL_BarShow.ftpPassWord;if("ftpDirectory"==a)return this.oATL_BarShow.ftpDirectory;if("ftpType"==a)return this.oATL_BarShow.ftpType;"forceEndProcess"!=a&&DisplayLog(VccBar_Log_Error,"bad attribute name:"+a);return""};this.GetBarCtrl=function(){return this};this.GetOCXCtrl=function(){return this.oATL_BarShow};this.Display=function(a){this.oBarShow.style.display=1==a?"":"none"};this.attachEventfun=function(a){this.eventCallBack=a};this.attachResponsefun=function(a){this.methodCallBack=a};this.SetAsysMode=function(a){this.asynExecuteMethod=a;1==this.asynExecuteMethod?BeginAsynFunctionTimer(500):EndAsynFunctionTimer()};this.GetAsysMode=function(){return this.asynExecuteMethod};this.show=function(){this.oATL_BarShow&&(this.oATL_BarShow.style.left=this.left,this.oATL_BarShow.style.top=this.top,this.oATL_BarShow.style.width=this.width,this.oATL_BarShow.style.height=this.height);this.resize(this.left,this.top,this.width,this.height)};this.resize=function(a,d,b,h){this.left="number"==typeof a?a:0;this.top="number"==typeof d?d:0;this.width=0<b?b:100;this.height=0<h?h:100;with(this.oBarShow.style)pixelWidth=this.width,pixelHeight=this.height,pixelLeft=this.left,pixelTop=this.top;this.oATL_BarShow.style.width=this.width;this.oATL_BarShow.style.height=this.height};this._createObject();return this}function altEventOnCallRing(a,b,c,f,g,k,l,d,p,h,e,t,n,x,z,q,m,r,u,v,w,y){application.oJVccBar.GetBarCtrl()._OnCallRing(a,b,c,f,g,k,l,d,p,h,e,t,n,x,z,q,m,r,u,v,w,y)}function altEventOnAnswerCall(a,b,c,f,g,k,l,d,p){application.oJVccBar.GetBarCtrl()._OnAnswerCall(a,b,c,f,g,k,l,d,p)}function altEventOnCallEnd(a,b,c,f,g,k,l,d,p,h,e,t,n,x,z){application.oJVccBar.GetBarCtrl()._OnCallEnd(a,b,c,f,g,k,l,d,p,h,e,t,n,x,z)}function altEventOnPrompt(a,b){application.oJVccBar.GetBarCtrl()._OnPrompt(a,b)}function altEventOnReportBtnStatus(a){application.oJVccBar.GetBarCtrl()._OnReportBtnStatus(a)}function altEventOnInitalSuccess(){application.oJVccBar.GetBarCtrl()._OnInitalSuccess()}function altEventOnInitalFailure(a,b){application.oJVccBar.GetBarCtrl()._OnInitalFailure(a,b)}function altEventOnEventPrompt(a,b){application.oJVccBar.GetBarCtrl()._OnEventPrompt(a,b)}function altEventOnAgentWorkReport(a,b){application.oJVccBar.GetBarCtrl()._OnAgentWorkReport(a,b)}function altEventOnCallDataChanged(a){application.oJVccBar.GetBarCtrl()._OnCallDataChanged(a)}function altEventOnBarExit(a,b){application.oJVccBar.GetBarCtrl()._OnBarExit(a,b)}function altEventOnCallQueueQuery(a){application.oJVccBar.GetBarCtrl()._OnCallQueueQuery(a)}function altEventOnQueryGroupAgentStatus(a,b){application.oJVccBar.GetBarCtrl()._OnQueryGroupAgentStatus(a,b)}function altEventOnSystemMessage(a,b){application.oJVccBar.GetBarCtrl()._OnSystemMessage(a,b)}function altEventOnRecvWeiboMsg(a){application.oJVccBar.GetBarCtrl()._invokeEvent(eventOnRecvWeiboMsg,a)}function altEventOnIMMessage(a,b,c){b=GetBase64FromGBK(b);application.oJVccBar.GetBarCtrl()._OnIMMessage(a,b,c)}function altEventOnRecvWeChatMessage(a,b,c,f,g,k,l,d,p,h,e,t,n,x){application.oJVccBar.GetBarCtrl()._OnRecvWeChatMessage(a,b,c,f,g,k,l,d,p,h,e,t,n,x)}function altEventOnSendWeChatMsgReport(a,b,c,f,g){application.oJVccBar.GetBarCtrl()._OnSendWeChatMsgReport(a,b,c,f,g)}function altEventOnUploadFileToMMSReport(a,b,c,f,g,k){application.oJVccBar.GetBarCtrl()._OnUploadFileToMMSReport(a,b,c,f,g,k)}function altEventOnDownloadFileToMMSReport(a,b,c,f){application.oJVccBar.GetBarCtrl()._OnDownloadFileToMMSReport(a,b,c,f)}function altEventOnWorkStaticInfoReport(a){application.oJVccBar.GetBarCtrl()._OnWorkStaticInfoReport(a)}function altEventOnQuerySPGroupList(a,b){application.oJVccBar.GetBarCtrl()._OnQuerySPGroupList(a,b)}function altEventOnAgentBusyReason(a,b){application.oJVccBar.GetBarCtrl()._OnAgentBusyReason(a,b)}function altEventOnAgentLogUpload(a,b,c,f,g,k){application.oJVccBar.GetBarCtrl()._OnAgentLogUpload(a,b,c,f,g,k)}function altEventOnAsrEventReport(a,b,c,f){application.oJVccBar.GetBarCtrl()._OnAsrEventReport(a,b,c,f)}function altEventOnStopSmSuccess(a){application.oJVccBar.GetBarCtrl()._OnStopSmSuccess(a)}function altEventOnSessionMessage(a){application.oJVccBar.GetBarCtrl()._OnSessionMessage(a)}function altEventOnUpdateMediaEvent(a,b,c){application.oJVccBar.GetBarCtrl()._OnUpdateMediaEvent(a,b,c)}function altEventOnSnapShotPngEvent(a){application.oJVccBar.GetBarCtrl()._OnSnapShotPngEvent(a)}function altEventOnStopCaptureSuccess(a,b){application.oJVccBar.GetBarCtrl()._OnStopCaptureSuccess(a,b)}function altEventOnAgentReport(a){application.oJVccBar.GetBarCtrl()._OnAgentReport(a)}function altEventOnTelReport(a){application.oJVccBar.GetBarCtrl()._OnTelReport(a)}function altEventOnServiceReport(a){application.oJVccBar.GetBarCtrl()._OnServiceReport(a)}function altEventOnMMServiceReport(a){application.oJVccBar.GetBarCtrl()._OnMMServiceReport(a)}function altEventOnIvrReport(a){application.oJVccBar.GetBarCtrl()._OnIvrReport(a)}function altEventOnTaskReport(a){application.oJVccBar.GetBarCtrl()._OnTaskReport(a)}function altEventOnOutboundReport(a){application.oJVccBar.GetBarCtrl()._OnOutboundReport(a)}function altEventOnCallReportInfo(a){application.oJVccBar.GetBarCtrl()._OnCallReportInfo(a)}function altEventOnQueueReport(a){application.oJVccBar.GetBarCtrl()._OnQueueReport(a)}function altEventOnQueryMonitorSumReport(a,b){application.oJVccBar.GetBarCtrl()._OnQueryMonitorSumReport(a,b)}function altEventOnWallServiceReport(a){application.oJVccBar.GetBarCtrl()._OnWallServiceReport(a)}function altEventOnWallQueueReport(a){application.oJVccBar.GetBarCtrl()._OnWallQueueReport(a)}function altEventOnServiceStaticReport(a){application.oJVccBar.GetBarCtrl()._OnServiceStaticReport(a)}function altEventOnAgentStaticReport(a){application.oJVccBar.GetBarCtrl()._OnAgentStaticReport(a)}function altEventOnTrunkReport(a){application.oJVccBar.GetBarCtrl()._OnTrunkReport(a)}function altEventOnTrunkSumReport(a){application.oJVccBar.GetBarCtrl()._OnTrunkSumReport(a)}var VccBar_Log_None=0,VccBar_Log_Error=1,VccBar_Log_Warn=2,VccBar_Log_Debug=4,VccBar_Log_Info=8,VccBar_Log_Protocol=16,MAXCALLNUMLEN=64,g_DebugFlag=1,gLogType=VccBar_Log_None;function LeafOutMuchMessage(a,b){return 0<=b.indexOf("OnStaticInfoReport")||0<=b.indexOf("OnQueueReport")?!1:!0}function DisplayLog(a,b){if(LeafOutMuchMessage(a,b)&&a&gLogType){var c="";a==VccBar_Log_Error&&(c="\u3010\u9519\u8bef\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Warn&&(c="\u3010\u8b66\u544a\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Debug&&(c="\u3010\u8c03\u8bd5\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Info&&(c="\u3010\u4fe1\u606f\u3011\u3010"+getTimeString()+"\u3011");a==VccBar_Log_Protocol&&(c="\u3010\u534f\u8bae\u3011\u3010"+getTimeString()+"\u3011");b=c+b;a==VccBar_Log_Protocol&&(b+="\r\n");application.Log(b)}}function getSubString(a,b,c){if(""==b&&""==c)return a;if(""==b)b=a;else{var f=a.indexOf(b);if(0>f)return"";f+=b.length;b=a.substr(f,a.length)}a=b;if(""==c)b=a;else{c=a.indexOf(c);if(0>c)return"";b=a.substr(0,c)}return b}function getRelatedIntArrayValue(a,b,c){for(var f=0;f<a.length;f++)if(a[f]==c)return b[f];return-1}function getRelatedStringArrayValue(a,b,c){for(var f=0;f<a.length;f++)if(a[f]==c)return b[f];return""}function trimStr(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function trimLeftStr(a){return a.replace(/(^\s*)/g,"")}function trimRightStr(a){return a.replace(/(\s*$)/g,"")}function getDefaultParam(a){return"undefined"==typeof a?"":a}function getDefaultParamValue(a,b){return"undefined"==typeof a?getDefaultParam(b):a}function getTimeString(){var a=new Date,b=a.getFullYear(),c=a.getMonth()+1,c=10>c?"0"+c:c,f=a.getDate(),f=10>f?"0"+f:f,g=a.getHours(),g=10>g?"0"+g:g,k=a.getMinutes(),k=10>k?"0"+k:k,l=a.getSeconds(),l=10>l?"0"+l:l,a=a.getMilliseconds();return b.toString()+":"+c.toString()+":"+f.toString()+" "+g.toString()+":"+k.toString()+":"+l.toString()+"  "+a.toString()}function stringFormat(){if(0==arguments.length)return"";for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(new RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a}function formatCallNum(a){for(var b="",c=0,f=0;f<a.length;f++)" "!=a[f]&&"-"!=a[f]&&(b+=a[f],c++);return b}function isPhoneNum(a,b){return!0}function $$(a){return window.document.getElementById(a)}function arrayEmpty(a){a.splice(0,a.length)}function arrayRemoveItem(a,b){for(var c=0;c<a;c++)if(a[c]==b)return c;-1!=c&&a.splice(index,1)}function stringToInt(a,b){return""==a||null==a||"undefined"==typeof a?b:parseInt(a)}function getArrayIndex(a,b){if(0>=a.length)return-1;for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function getStringTimerInterval(a,b){var c=StringToDate(a),f=StringToDate(b);if(0==c||0==f)return 0;c=f.getTime()-c.getTime();return Math.round(c/1E3)}function getAcpTimeString(a){var b=new Date,c=b.getFullYear(),f=b.getMonth()+1,f=10>f?"0"+f:f,g=b.getDate(),g=10>g?"0"+g:g,k=b.getHours(),k=10>k?"0"+k:k,l=b.getMinutes(),l=10>l?"0"+l:l,d=b.getSeconds(),d=10>d?"0"+d:d,b=b.getMilliseconds();return(a=getDefaultParamValue(a,!0))?stringFormat("{0}:{1}:{2} {3}:{4}:{5} {6}",c.toString(),f.toString(),g.toString(),k.toString(),l.toString(),d.toString(),b.toString()):stringFormat("{0}{1}{2}{3}{4}{5}",c.toString(),f.toString(),g.toString(),k.toString(),l.toString(),d.toString())}function StringToDate(a){if(""==a||"undefined"==typeof a||14!=a.length)return 0;var b=new Date;b.setYear(parseInt(a.substr(0,4)));b.setMonth(parseInt(a.substr(4,2)));b.setDate(parseInt(a.substr(6,2)));b.setHours(parseInt(a.substr(8,2)));b.setMinutes(parseInt(a.substr(10,2)));b.setSeconds(parseInt(a.substr(12,2)));return b}function CXmlParse(){this.oXmlDoc=null;this.nType=-1;this.loadXMLFile=function(a){try{this.oXmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.nType=1}catch(b){try{this.oXmlDoc=document.implementation.createDocument("","",null),this.nType=0}catch(c){return alert(c.message),this.nType=-1,!1}}try{this.oXmlDoc.async=!1,this.oXmlDoc.load(a),alert(a)}catch(b){return alert(b.message),this.nType=-1,!1}return!0};this.loadXml=function(a){try{this.oXmlDoc=(new DOMParser).parseFromString(a,"text/xml"),this.nType=0}catch(b){try{this.oXmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.nType=1,this.oXmlDoc.async=!1,this.oXmlDoc.loadXML(a)}catch(c){return this.nType=-1,!1}}return!0};this.queryNodes=function(a){return-1==this.nType?null:0==this.nType?this.oXmlDoc.getElementsByTagName(a):this.oXmlDoc.selectNodes(a)};this.queryNode=function(a){return-1==this.nType?null:0==this.nType?(a=this.oXmlDoc.getElementsByTagName(a),0<a.length?a[0]:null):this.oXmlDoc.selectSingleNode(a)};this.queryNodeValue=function(a){return-1==this.nType?"":0==this.nType?null==a?"":a.childNodes[0].nodeValue:null!=a?a.text:""};this.queryNodeValueByPath=function(a){return-1==this.nType?"":this.queryNodeValue(this.queryNode(a))};this.queryNodeAttribute=function(a,b){if(-1==this.nType)return"";if(0==this.nType)return null==a?"":a.getAttribute(b);try{if(!a||!a.attributes)return"";if(null!=a.attributes[b])return a.attributes[b].value;if(null!=a.attributes.getNamedItem(b))return a.attributes.getNamedItem(b).value}catch(c){}return""};this.queryNodeAttributeByPath=function(a,b){return-1==this.nType?"":this.queryNodeAttribute(this.queryNode(a),b)};this.close=function(){this.nType=this.oXmlDoc=null};return this}function xmlTest(){getSubString('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e','type\x3d"','"');getSubString('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e','name\x3d"','"');getSubString('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e',"\x3cpaspparam\x3e","\x3c/paspparam\x3e");var a=new CXmlParse;a.loadXml('\x3capspMessage ver\x3d"2.0.0" time\x3d"2014:05:09 18:05:07 546"\x3e\x3cheader\x3e\x3csessionID\x3eWUSHENGJUN\x3c/sessionID\x3e\x3c/header\x3e\x3cbody type\x3d"event" name\x3d"OnPrompt"\x3e\x3cpaspparam\x3e4407||0\x3c/paspparam\x3e\x3c/body\x3e\x3c/apspMessage\x3e')&&(1==a.nType?alert("IE:"+a.queryNodeAttributeByPath("apspMessage/body","name")):alert(a.queryNodeAttributeByPath("body","name")),1==a.nType?alert("IE:"+a.queryNodeValueByPath("apspMessage/header/sessionID")):alert(a.queryNodeValueByPath("sessionID")))}var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];function base64encode(a){var b,c,f,g,k,l;f=a.length;c=0;for(b="";c<f;){g=a.charCodeAt(c++)&255;if(c==f){b+=base64EncodeChars.charAt(g>>2);b+=base64EncodeChars.charAt((g&3)<<4);b+="\x3d\x3d";break}k=a.charCodeAt(c++);if(c==f){b+=base64EncodeChars.charAt(g>>2);b+=base64EncodeChars.charAt((g&3)<<4|(k&240)>>4);b+=base64EncodeChars.charAt((k&15)<<2);b+="\x3d";break}l=a.charCodeAt(c++);b+=base64EncodeChars.charAt(g>>2);b+=base64EncodeChars.charAt((g&3)<<4|(k&240)>>4);b+=base64EncodeChars.charAt((k&15)<<2|(l&192)>>6);b+=base64EncodeChars.charAt(l&63)}return b}function base64decode(a){var b,c,f,g,k;g=a.length;f=0;for(k="";f<g;){do b=base64DecodeChars[a.charCodeAt(f++)&255];while(f<g&&-1==b);if(-1==b)break;do c=base64DecodeChars[a.charCodeAt(f++)&255];while(f<g&&-1==c);if(-1==c)break;k+=String.fromCharCode(b<<2|(c&48)>>4);do{b=a.charCodeAt(f++)&255;if(61==b)return k;b=base64DecodeChars[b]}while(f<g&&-1==b);if(-1==b)break;k+=String.fromCharCode((c&15)<<4|(b&60)>>2);do{c=a.charCodeAt(f++)&255;if(61==c)return k;c=base64DecodeChars[c]}while(f<g&&-1==c);if(-1==c)break;k+=String.fromCharCode((b&3)<<6|c)}return k}function utf16to8(a){var b,c,f,g;b="";f=a.length;for(c=0;c<f;c++)g=a.charCodeAt(c),1<=g&&127>=g?b+=a.charAt(c):(2047<g?(b+=String.fromCharCode(224|g>>12&15),b+=String.fromCharCode(128|g>>6&63)):b+=String.fromCharCode(192|g>>6&31),b+=String.fromCharCode(128|g>>0&63));return b}function utf8to16(a){var b,c,f,g,k,l;b="";f=a.length;for(c=0;c<f;)switch(g=a.charCodeAt(c++),g>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=a.charAt(c-1);break;case 12:case 13:k=a.charCodeAt(c++);b+=String.fromCharCode((g&31)<<6|k&63);break;case 14:k=a.charCodeAt(c++),l=a.charCodeAt(c++),b+=String.fromCharCode((g&15)<<12|(k&63)<<6|(l&63)<<0)}return b}function GetBase64FromGBK(a){return"undefined"==typeof a?"":base64encode(utf16to8(a))}function GetGBKFromBase64(a){return"undefined"==typeof a?"":utf8to16(base64decode(a))}function CharToHex(a){var b,c,f,g;b="";f=a.length;for(c=0;c<f;)g=a.charCodeAt(c++),g=g.toString(16),2>g.length&&(g="0"+g),b+="\\x"+g+" ",0<c&&0==c%8&&(b+="\r\n");return b}function getCookie(a){return 0<document.cookie.length&&(c_start=document.cookie.indexOf(a+"\x3d"),-1!=c_start)?(c_start=c_start+a.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""}function setCookie(a,b,c){var f=new Date;f.setDate(f.getDate()+c);a=a+"\x3d"+escape(b)+(null==c?"":";expires\x3d"+f.toGMTString());document.cookie=a}function GetCABVersion(){return"1.0.0.6"==g_JsVersion?"|20.150101":"1.0.0.7"==g_JsVersion?"20.150101|20.150401":"1.0.0.8"==g_JsVersion?"20.150401|20.150101":""}var TIMER_AUTO=0,TIMER_HANDLE=1,g_oJTimer=null;function JTimeItem(){this.id=-1;this.intervalMax=this.interval=0;this.intervalCount=-1;return this}function JTimer(a){"undefined"==typeof a&&(a=100);if(null!=g_oJTimer)return g_oJTimer._cellInterVal=a,g_oJTimer;this._cellInterVal=a;this._bStart=!1;this._onTimerCallBackEvent=null;this._timers=[];this._timerType=TIMER_AUTO;this._timerID=null;this.SetTimerCallBack=function(a){this._onTimerCallBackEvent=a};this.IsProcess=function(){return this._bStart};this.OnTimer=function(){if(null!=this._onTimerCallBackEvent)for(var a=0;a<this._timers.length;a++)-1!=this._timers[a].intervalMax&&(this._timers[a].intervalCount++,this._timers[a].intervalCount>=this._timers[a].intervalMax&&-1!=this._timers[a].intervalMax&&(this._timers[a].intervalCount=0,this._onTimerCallBackEvent(this._timers[a].id)))};this.Start=function(){this._bStart||(this._timerType==TIMER_AUTO&&null==g_oJTimer._timerID&&(g_oJTimer._timerID=setInterval(function(){g_oJTimer.OnTimer()},g_oJTimer._cellInterVal)),this._bStart=!0)};this.Stop=function(){this._bStart&&(null!=g_oJTimer._timerID&&(clearInterval(g_oJTimer._timerID),g_oJTimer._timerID=null),this._bStart=!1)};this.SetTimer=function(a,c){if(0>a||0>=c)return-1;if(-1!=this._getTimerIndex(a))return this.Reset(a),-3;var b=new JTimeItem;b.id=a;b.interval=c;b.intervalMax=c/this._cellInterVal;this._timers.push(b);return this._timers.length-1};this.KillTimer=function(a){a=this._getTimerIndex(a);-1!=a&&this._timers.splice(a,1)};this.Reset=function(a){a=this._getTimerIndex(a);-1!=a&&(this._timers[a].intervalCount=0)};this._getTimerIndex=function(a){for(var b=0;b<this._timers.length;b++)if(this._timers[b].id==a)return b;return-1};g_oJTimer=this;return this}var G_oSiverlightCtrl=null;function JSilverLightCtrl(a,b,c,f,g,k,l){this.left=a;this.top=b;this.width=c;this.height=f;l="undefined"==typeof l?null:l;this._window=null==l?window:l;this._contentWindow=null==k?window:k;this.id="oSiverLight_"+Math.ceil(100*Math.random());this.name=this.id+"_Ctrl";this.oSilverlight=this.oSL_MonShow=this.oMonitorShow=null;this._realMethodName="";G_oSiverlightCtrl=this;this._relationPath="undefined"==typeof g?"":g;this._createObject=function(){this.oMonitorShow=this._window.document.createElement("DIV");this.oMonitorShow.style.cursor="move";this.oMonitorShow.style.position="absolute";this.oMonitorShow.style.border="1px solid #828282";this.oMonitorShow.style.left=this.left+"px";this.oMonitorShow.style.top=this.top+"px";this.oMonitorShow.style.width=this.width+"px";this.oMonitorShow.style.height=this.height+"px";this.oMonitorShow.style.textAlign="center";this.oMonitorShow.id="silverlightControlBarHost";this._contentWindow==this._window?this._contentWindow.document.body.appendChild(this.oMonitorShow):this._contentWindow.appendChild(this.oMonitorShow);this.oMonitorShow.innerHTML=this._getMSLHtml();this.oSL_MonShow=this.oMonitorShow.firstChild};this._getMSLHtml=function(){return'\x3cobject id\x3d"objsilverlightBarControl" data\x3d"data:application/x-silverlight-2," type\x3d"application/x-silverlight-2" width\x3d"100%" height\x3d"100%" \x3e\x3cparam name\x3d"source" value\x3d"'+this._relationPath+'CCVccBar.xap"/\x3e\x3cparam name\x3d"onError" value\x3d"onSilverlightBarError" /\x3e\x3cparam name\x3d"background" value\x3d"white" /\x3e\x3cparam name\x3d"minRuntimeVersion" value\x3d"4.0.50826.0" /\x3e\x3cparam name\x3d"autoUpgrade" value\x3d"true" /\x3e\x3cparam name\x3d"onLoad" value\x3d"SilverlightPluginBarLoaded" /\x3e\x3ca href\x3d"http://go.microsoft.com/fwlink/?LinkID\x3d149156\x26v\x3d5.0.61118.0" style\x3d"text-decoration:none"\x3e\x3cimg src\x3d"http://go.microsoft.com/fwlink/?LinkId\x3d161376" alt\x3d"Get Microsoft Silverlight" style\x3d"border-style:none"/\x3e\x3c/a\x3e\x3c/object\x3e'};this._createObject();this._GetAppMainPage=function(){null!=this.oSL_MonShow&&null==this.oSilverlight&&(this.oSilverlight=this.oSL_MonShow.Content.MainApp,this.oSilverlight.RegisterEventFun("OnSLEventFunction"),this.oSilverlight.RegisterResponseFun("OnSLResponseFunction"),this.SetCtrlAttribute("AgentType",0),this.SetCtrlAttribute("PassWord","111111"),this.SetCtrlAttribute("MainPortID",14800),this.SetCtrlAttribute("BackPortID",14800),this.SetCtrlAttribute("TaskID","0"),this.SetCtrlAttribute("MonitorPort",4502),this.SetCtrlAttribute("AppType",0),this.SetCtrlAttribute("SipServerPort",5060),this.SetCtrlAttribute("SipPassWord","00000000"),this.SetCtrlAttribute("SipProtocol","UDP"),this.SetCtrlAttribute("SipPassWdCryptType",0),this.SetCtrlAttribute("SipAuthType",1),this.SetCtrlAttribute("PhonType",0),this.SetCtrlAttribute("SelfPrompt",0),this.SetCtrlAttribute("forceEndProcess",g_DebugFlag),this.OnMonitorControlLoad())};this._invokeEventReport=function(a,b){null!=this.eventCallBack&&(DisplayLog(VccBar_Log_Info,"JSilverLightCtrl:_invokeEventReport(cmdIndex\x3d"+a+"  param\x3d"+b+")"),this.eventCallBack(a,b))};this._invokeResponseReport=function(a,b){null!=this.responseCallBack&&("SetCTIInfo"==a||"QueryCTIInfo"==a?(DisplayLog(VccBar_Log_Info,"JSilverLightCtrl:_invokeResponseReport(cmdName\x3d"+this._realMethodName+"  param\x3d"+b+")"),this.responseCallBack(this._realMethodName,b)):(DisplayLog(VccBar_Log_Info,"JSilverLightCtrl:_invokeResponseReport(cmdName\x3d"+a+"  param\x3d"+b+")"),this.responseCallBack(a,b)))};this._InvokeMethod=function(a,b){if(""==a)return-1;DisplayLog(VccBar_Log_Debug,"JSilverLightCtrl:_InvokeMethod(cmdName\x3d"+a+",param\x3d"+b+")");return null!=this.oSilverlight?this.oSilverlight.InvokeExecuteMethod(a,b):-1};this._InvokeQueryMethod=function(a,b){return""==a?"":null!=this.oSilverlight?this.oSilverlight.InvokeReturnMethod(a,b):""};this.attachEventfun=function(a){this.eventCallBack=a};this.attachResponsefun=function(a){this.responseCallBack=a};this.GetBarCtrl=function(){return this};this.SetCtrlAttribute=function(a,b){DisplayLog(VccBar_Log_Debug,"JVccBar:SetCtrlAttribute(aName\x3d"+a+",aValue\x3d"+b+")");null!=this.oSilverlight&&(DisplayLog(VccBar_Log_Debug,"JVccBar:SetAttribute(aName\x3d"+a+",aValue\x3d"+b+")"),this.oSilverlight.SetAttribute(a,b))};this.GetCtrlAttribute=function(a){return null!=this.oSilverlight?this.oSilverlight.GetAttribute(a):""};this.GetBarType=function(){return vccBarTypeSILVERLIGHT};this._gfOnPrompt=function(a,b){"undefined"==typeof b&&(b="");this._invokeEventReport(eventOnPrompt,a+"|"+b)};this.Initial=function(){return this._InvokeMethod("Initial",getLocalLanguage())};this.SerialBtn=function(a,b){return this._InvokeMethod("SerialBtn",GetApspParam(a,b))};this.GetBtnStatus=function(a){return this._InvokeQueryMethod("GetBtnStatus",GetApspParam(a))};this.Configurate=function(a){return this._InvokeMethod("Configurate",GetApspParam(a))};this.GetConfiguration=function(){return this._InvokeQueryMethod("GetConfiguration","")};this.UnInitial=function(a){return this._InvokeMethod("UnInitial",a)};this.SetUIStyle=function(a){getLocalLanguage()==lg_zhcn?alert("\u6b64\u65b9\u6cd5\u65e0\u6548"):alert("invalidate Method")};this.GetVersion=function(){return this._InvokeQueryMethod("GetVersion","")};this.SetBusy=function(a){"undefined"==typeof a&&(a=0);return this._InvokeMethod("SetBusy",GetApspParam(a))};this.SetIdle=function(){return this._InvokeMethod("SetIdle","")};this.SetWrapUp=function(){return this._InvokeMethod("SetWrapUp","")};this.SetCTICalloutTask=function(a){return this._InvokeMethod("SetCTICalloutTask",GetApspParam(a))};this.GetCTICalloutTask=function(){return this._InvokeMethod("GetCTICalloutTask","")};this.GetCallData=function(a){return this._InvokeMethod("GetCallData",GetApspParam(a))};this.SetCallData=function(a,b){return this._InvokeMethod("SetCallData",GetApspParam(a,b))};this.GetTransfer=function(){return this._InvokeMethod("GetTransfer","")};this.SetTransfer=function(a,b,h){return this._InvokeMethod("SetTransfer",GetApspParam(a,b,h))};this.ChangeCallQueue=function(a,b,h){return this._InvokeMethod("ChangeCallQueue",GetApspParam(a,b,h))};this.GetCallID=function(){return this._InvokeMethod("GetCallID","")};this.QuerySPGroupList=function(a,b,h,e,c,f){"undefined"==typeof h&&(h="9");"undefined"==typeof e&&(e="0");this._realMethodName="QuerySPGroupList";return this._InvokeMethod("QueryCTIInfo",GetApspParam(h,a,b,e,c,f))};this.GetCallInfo=function(){return this._InvokeMethod("GetCallInfo","")};this.SetTransparentParameter=function(a){return this._InvokeMethod("SetTransparentParameter",GetApspParam(a))};this.GetAgentStatus=function(){return this._InvokeQueryMethod("GetAgentStatus","")};this.GetAgentSubBusyStatus=function(){return this._InvokeQueryMethod("GetAgentSubBusyStatus","")};this.GetBusySubStatus=function(){return this._InvokeQueryMethod("GetBusySubStatus","")};this.SetDisplayNumber=function(a){this._realMethodName="SetDisplayNumber";return this._InvokeMethod("SetCTIInfo",GetApspParam("8",a))};this.GetDisplayNumber=function(){this._realMethodName="GetDisplayNumber";return this._InvokeMethod("QueryCTIInfo",GetApspParam("21",""))};this.CallQueueQuery=function(a,b,h){"undefined"==typeof b&&(b=2);"undefined"==typeof h&&(h=0);return this._InvokeMethod("CallQueueQuery",GetApspParam(a,b,h))};this.QueryGroupAgentStatus=function(a,b,h,e){this._realMethodName="QueryGroupAgentStatus";return this._InvokeMethod("QueryCTIInfo",GetApspParam("22",a,b,h,e))};this.QueryPreViewCallOutNumbers=function(a,b,h,e){this._realMethodName="QueryGroupAgentStatus";return this._InvokeMethod("QueryCTIInfo",GetApspParam("23",a,b,h,e))};this.QueryMonitorSumInfo=function(a,b){return this._InvokeMethod("QueryMonitorSumInfo",GetApspParam(a,b))};this.GetBase64Data=function(a){return GetBase64FromGBK(a)};this.GetDataFromBase64=function(a){return GetGBKFromBase64(a)};this.SetWeChatQueueFlag=function(a){this._realMethodName="SetWeChatQueueFlag";return this._InvokeMethod("SetCTIInfo",GetApspParam("30",a))};this.GetWeChatQueueFlag=function(){this._realMethodName="SetWeChatQueueFlag";return this._InvokeMethod("QueryCTIInfo",GetApspParam("30",""))};this.TransferCallQueue=function(a,b,h){return this._InvokeMethod("TransferCallQueue",GetApspParam(a,b,h))};this.SetActiveService=function(a){this._realMethodName="SetActiveService";return this._InvokeMethod("SetCTIInfo",GetApspParam("26",a))};this.GetActiveService=function(){this._realMethodName="GetActiveService";return this._InvokeMethod("QueryCTIInfo",GetApspParam("26",""))};this.GetExitCause=function(){return this._InvokeQueryMethod("GetExitCause","")};this.SetForwardNumber=function(a,b){this._realMethodName="SetForwardNumber";return this._InvokeMethod("SetCTIInfo",GetApspParam("25",a,b))};this.GetForwardNumber=function(){this._realMethodName="GetForwardNumber";return this._InvokeMethod("QueryCTIInfo",GetApspParam("25",""))};this.SetAgentReservedStatus=function(a,b){this._realMethodName="SetAgentReservedStatus";return this._InvokeMethod("SetCTIInfo",GetApspParam("31",a,b))};this.SetMMService=function(a,b){this._realMethodName="SetMMService";return this._InvokeMethod("SetCTIInfo",GetApspParam("34",a,b))};this.GetAgentLogFile=function(a,b,h){this._realMethodName="GetAgentLogFile";return this._InvokeMethod("SetCTIInfo",GetApspParam("32",this.GetCtrlAttribute("AgentID"),a,b,h))};this.GetMonitorOffSetTime=function(){return parseInt(this._InvokeQueryMethod("GetMonitorOffSetTime",""))};this.MakeCall=function(a,b,h,e,c,f,g,k,l,m,r){b=getDefaultParam(b);""==b&&(b=CD_PREVIEW_CALLOUT);"undefined"==typeof h&&(h="");"undefined"==typeof e&&(e="");e=this.GetBase64Data(e);"undefined"==typeof c&&(c="");"undefined"==typeof f&&(f="");"undefined"==typeof g&&(g=0);if(""==a)return this._gfOnPrompt(4312),-1;"undefined"==typeof g&&(g=0);if(0==g&&(a=formatCallNum(a),!isPhoneNum(a,!0)))return this._gfOnPrompt(4313),-1;"undefined"==typeof k&&(k="");"undefined"==typeof l&&(l="");"undefined"==typeof m&&(m="");"undefined"==typeof r&&(r="");return this._InvokeMethod("MakeCall",GetApspParam(a,b,h,e,c,f,g,k,l,m,r))};this.CallIn=function(a,b,h,e,c){b=getDefaultParam(b);""==b&&(b=CD_AGENT_INSIDE_CALLOUT);"undefined"==typeof h&&(h="");"undefined"==typeof e&&(e="");e=this.GetBase64Data(e);"undefined"==typeof c&&(c="");return this._InvokeMethod("CallIn",GetApspParam(a,b,h,e,c))};this.TransferOut=function(a,b){return this._InvokeMethod("TransferOut",GetApspParam(a,b))};this.Hold=function(a){a=getDefaultParam(a);return this._InvokeMethod("Hold",a)};this.RetrieveHold=function(a){a=getDefaultParam(a);return this._InvokeMethod("RetrieveHold",a)};this.Disconnect=function(a){return this._InvokeMethod("Disconnect",GetApspParam(a))};this.Answer=function(a){return this._InvokeMethod("Answer",GetApspParam(a))};this.Consult=function(a,b){return this._InvokeMethod("Consult",GetApspParam(a,b))};this.Transfer=function(){return this._InvokeMethod("Transfer","")};this.Conference=function(){return this._InvokeMethod("Conference","")};this.SendDTMF=function(a){return this._InvokeMethod("SendDTMF",GetApspParam(a))};this.Bridge=function(a,b){return this._InvokeMethod("Bridge",GetApspParam(a,b))};this.Mute=function(a,b){return this._InvokeMethod("Mute",GetApspParam(a,b))};this.ReleaseThirdOne=function(a){return this._InvokeMethod("ReleaseThirdOne",GetApspParam(a))};this.ForceReset=function(){return this._InvokeMethod("ForceReset","")};this.SendIMMessage=function(a,b,h,e,c,f){f=this.GetBase64Data(f);return this._InvokeMethod("SendIMMessage",GetApspParam(a,b,h,e,c,f))};this.BeginPlay=function(a,b,h,e,c){return this._InvokeMethod("BeginPlay",GetApspParam(a,b,h,e,c))};this.StopPlay=function(a,b){return this._InvokeMethod("StopPlay",GetApspParam(a,b))};this.BeginCollect=function(a,b,h,e,c,f,g,k,l,m){return this._InvokeMethod("BeginCollect",GetApspParam(a,b,h,e,c,f,g,k,l,m))};this.StopCollect=function(a,b){return this._InvokeMethod("StopCollect",GetApspParam(a,b))};this.SendIMMessage2=function(a,b,h){"undefined"==typeof h&&(h="");h=this.GetBase64Data(h);return this._InvokeMethod("SendIMMessage2",GetApspParam(a,b,h))};this.WinCap=function(a,b,h){if("undefined"==typeof a||isNaN(a))a=1;"undefined"==typeof b&&(a=200);"undefined"==typeof h&&(h=1);return this._InvokeMethod("WinCap",GetApspParam(a,this.GetCtrlAttribute("MainIP"),b,h))};this.PopDlg=function(a,b,h,e){if("undefined"==typeof a||""==a)return-1;if("undefined"==typeof b||isNaN(b))b=0;if("undefined"==typeof h||isNaN(h))h=0;"undefined"==typeof e&&(e="");"MainSettingDlg"==a&&(e=this.GetBase64Data(e));return this._InvokeMethod("PopDLG",GetApspParam(a,b,h,e))};this.SendSipSessionMessage=function(a){a=this.GetBase64Data(a);return this._InvokeMethod("SendSipSessionMessage",a)};this.BeginRecord=function(a,b){return this._InvokeMethod("BeginRecord",GetApspParam(a,b))};this.StopRecord=function(a){return this._InvokeMethod("StopRecord",GetApspParam(a))};this.AlterNate=function(a){return this._InvokeMethod("AlterNate",GetApspParam(a))};this.CallBack=function(){return this._InvokeMethod("CallBack","")};this.ReCall=function(){return this._InvokeMethod("ReCall","")};this.SMMsg=function(a,b){return this._InvokeMethod("SMMsg",GetApspParam(a,b))};this.ForeReleaseCall=function(a,b){return this._InvokeMethod("ForeReleaseCall",GetApspParam(a,b))};this.Insert=function(a,b,h){return this._InvokeMethod("Insert",GetApspParam(a,b,h))};this.Listen=function(a,b,h){return this._InvokeMethod("Listen",GetApspParam(a,b,h))};this.Intercept=function(a,b,h,e){return this._InvokeMethod("Intercept",GetApspParam(a,b,h,e))};this.Help=function(a,b,h){return this._InvokeMethod("Help",GetApspParam(a,b,h))};this.Lock=function(a){return this._InvokeMethod("Lock",GetApspParam(a))};this.UnLock=function(a){return this._InvokeMethod("UnLock",GetApspParam(a))};this.ForceIdle=function(a){return this._InvokeMethod("ForceIdle",GetApspParam(a))};this.ForceBusy=function(a){return this._InvokeMethod("ForceBusy",GetApspParam(a))};this.ForceOut=function(a){return this._InvokeMethod("ForceOut",GetApspParam(a))};this.InitialState=function(){return this._InvokeMethod("InitialState","")};this.AgentQuery=function(a,b,h){return this._InvokeMethod("AgentQuery",GetApspParam(a,b,h))};this.TelQuery=function(a,b){return this._InvokeMethod("TelQuery",GetApspParam(a,b))};this.IvrQuery=function(a,b){return this._InvokeMethod("IvrQuery",GetApspParam(a,b))};this.TrunkQuery=function(a,b){return this._InvokeMethod("TrunkQuery",GetApspParam(a,b))};this.ServiceQuery=function(a,b){return this._InvokeMethod("ServiceQuery",GetApspParam(a,b,""))};this.MMServiceQuery=function(a){return this._InvokeMethod("MMServiceQuery",GetApspParam(a))};this.AgentStateQuery=function(a,b,h,e){b=getDefaultParamValue(b,0);h=getDefaultParamValue(h,200);500<h&&(h=500);e=getDefaultParamValue(e,0);return this._InvokeMethod("AgentStateQuery",GetApspParam(a,b,h,e))};this.TaskQuery=function(a,b){return this._InvokeMethod("TaskQuery",GetApspParam(a,b))};this.CallReportQuery=function(a,b){return this._InvokeMethod("CallReportQuery",GetApspParam(a,b))};this.GetTaskSummary=function(a,b){return this._InvokeMethod("GetTaskSummary",GetApspParam(a,b))};this.StartNotification=function(a,b,h){return this._InvokeMethod("StartNotification",GetApspParam(a,b,h))};this.EndNotification=function(a){return this._InvokeMethod("EndNotification",GetApspParam(a))};this.SendWeiboMsg=function(a){return this._InvokeMethod("SendWeiboMsg",GetApspParam(a))};this.UploadFileToMMS=function(a,b,h,e){return this._InvokeMethod("UploadFileToMMS",GetApspParam(a,b,h,e))};this.DownFileFromMMS=function(a,b,h,e,c){return this._InvokeMethod("DownFileFromMMS",GetApspParam(a,b,h,e,c))};this.SendWeChatMsg=function(a,b,h,e,c,f,g,k,l,m){f=GetBase64FromGBK(f);k=GetBase64FromGBK(k);l=GetBase64FromGBK(l);return this._InvokeMethod("SendWeChatMsg",GetApspParam(a,b,h,e,c,f,g,k,l,m))};this.QueryWeChatData=function(a,b,h,e,c,f,g){return this._InvokeMethod("QueryWeChatData",GetApspParam(a,b,h,e,c,f,g))};this.QueryWeChatHistory=function(a,b,h,e,c,f,g){return this._InvokeMethod("QueryWeChatHistory",GetApspParam(a,b,h,e,c,f,g))};this.GetWeChatParam=function(a){return this._InvokeMethod("GetWeChatParam",GetApspParam(a))};this.OnMonitorControlLoad=function(){};this.OnMethodResponseEvent=function(a,b){};this.Destory=function(){this._contentWindow==this._window?this._contentWindow.document.body.removeChild(this.oMonitorShow):this._contentWindow.removeChild(this.oMonitorShow)};this.Display=function(a){1==a?this.Refresh():(this.oMonitorShow.style.left="0px",this.oMonitorShow.style.top="0px",this.oMonitorShow.style.width="0px",this.oMonitorShow.style.height="0px")};this.Refresh=function(){null!=this.oSL_MonShow&&(this.oSL_MonShow.style.left=this.left,this.oSL_MonShow.style.top=this.top,this.oSL_MonShow.style.width=this.width,this.oSL_MonShow.style.height=this.height);this.Resize(this.left,this.top,this.width,this.height)};this.Resize=function(a,b,h,e){this.left="number"==typeof a?a:0;this.top="number"==typeof b?b:0;this.width=0<=h?h:100;this.height=0<=e?e:100;this.oMonitorShow.style.left=this.left+"px";this.oMonitorShow.style.top=this.top+"px";this.oMonitorShow.style.width=this.width+"px";this.oMonitorShow.style.height=this.height+"px"};return this}function onSilverlightBarError(a,b){var c="";null!=a&&0!=a&&(c=a.getHost().Source);var f=b.ErrorType;if("ImageError"!=f&&"MediaError"!=f)throw c="Unhandled Error in Silverlight Application "+c+"\n"+("Code: "+b.ErrorCode+"    \n"),c=c+("Category: "+f+"       \n")+("Message: "+b.ErrorMessage+"     \n"),"ParserError"==f?(c+="File: "+b.xamlFile+"     \n",c+="Line: "+b.lineNumber+"     \n",c+="Position: "+b.charPosition+"     \n"):"RuntimeError"==f&&(0!=b.lineNumber&&(c+="Line: "+b.lineNumber+"     \n",c+="Position: "+b.charPosition+"     \n"),c+="MethodName: "+b.methodName+"     \n"),Error(c);}function SilverlightPluginBarLoaded(){null!=G_oSiverlightCtrl&&G_oSiverlightCtrl._GetAppMainPage()}function OnSLEventFunction(a,b){null!=G_oSiverlightCtrl&&G_oSiverlightCtrl._invokeEventReport(a,b)}function OnSLResponseFunction(a,b){null!=G_oSiverlightCtrl&&G_oSiverlightCtrl._invokeResponseReport(a,b)}function JVccBar(a,b,c,f,g,k,l){this.app=l;this.left=a;this.top=b;this.width=c;this.height=f;this.showstyle=g;this._contentWindow=null==k?window:k;this.id="oBar_"+Math.ceil(100*Math.random());this.name=this.id+"_Ctrl";this.oMonitorDataManager=this.oBarControl=null;this.userBtnIds="";this.workStatus=-1;this.oBarAssist=this.oMonitorCtrl=this.oBarCtrl=this.oBarShow=null;this.errDescription="";this.arrBarEvent="OnCallRing AnswerCall OnAnswerCall OnCallEnd OnPrompt OnReportBtnStatus OnInitalSuccess OnInitalFailure OnEventPrompt OnAgentWorkReport OnCallDataChanged OnBarExit OnCallQueueQuery OnQueryGroupAgentStatus OnSystemMessage OnRecvWeiboMsg OnIMMessage OnRecvWeChatMessage OnSendWeChatMsgReport OnUploadFileToMMSReport OnDownloadFileToMMSReport OnWorkStaticInfoReport OnQueueReport OnQuerySPGroupList OnUpdateVideoWindow OnSessionMessage OnRtpStatics OnAgentBusyReason OnAgentStatus OnAgentLogUpload OnAsrEventReport OnStopSmSuccess OnUpdateMediaEvent OnSnapShotPngEvent OnStopCaptureSuccess OnModifyVideoStreamReport OnVideoWndStatusReport OnMethodResponseEvent OnAgentReport OnTelReport OnServiceReport OnIvrReport OnTaskReport OnOutboundReport OnCallReportInfo OnQueryMonitorSumReport OnWallServiceReport OnWallQueueReport OnServiceStaticReport OnAgentStaticReport OnTrunkReport OnTrunkSumReport OnCallCdrReport OnGetVersionReport OnDebug".split(" ");this._listeners={};this.arrBarMethodCallBack={SetBusy:null,SetIdle:null,SetWrapUp:null,SetCTICalloutTask:null,GetCTICalloutTask:null,GetCallData:null,SetCallData:null,GetTransfer:null,SetTransfer:null,ChangeCallQueue:null,QuerySPGroupList:null,SetTransparentParameter:null,SetDisplayNumber:null,GetDisplayNumber:null,CallQueueQuery:null,QueryGroupAgentStatus:null,QueryPreViewCallOutNumbers:null,SetWeChatQueueFlag:null,GetWeChatQueueFlag:null,TransferCallQueue:null,SetActiveService:null,GetActiveService:null,SetForwardNumber:null,GetForwardNumber:null,SetAgentReservedStatus:null,SetMMService:null,DeleteCaptureFile:null,GetAgentLogFile:null,MakeCall:null,CallIn:null,TransferOut:null,Hold:null,RetrieveHold:null,Disconnect:null,Answer:null,Consult:null,Transfer:null,Conference:null,SendDTMF:null,BeginPlay:null,StopPlay:null,Bridge:null,Mute:null,AlterNate:null,CallBack:null,ReCall:null,SMMsg:null,ReleaseThirdOne:null,BeginCollect:null,StopCollect:null,ForceReset:null,SendIMMessage:null,UpdateMedia:null,BeginCapture:null,Connect:null,ReleaseConnectOne:null,MultiConfTransfer:null,ModifyVideoStream:null,VideoInfo:null,ForeReleaseCall:null,Insert:null,Listen:null,Intercept:null,Lock:null,UnLock:null,ForceIdle:null,ForceBusy:null,ForceOut:null,Help:null,InitialState:null,AgentQuery:null,TelQuery:null,IvrQuery:null,ServiceQuery:null,TaskQuery:null,CallReportQuery:null,GetTaskSummary:null,QueryMonitorSumInfo:null,StartNotification:null,EndNotification:null,TrunkQuery:null,MMServiceQuery:null,AgentStateQuery:null};this._appType=-1;this._createObject=function(){null==this.oBarControl&&(this.oBarControl=new CHtmlBarControl(getLocalLanguage()));switch(this.showstyle){case showStyleOCX:"msie"!=this.app.oBrowserSys.os&&alert("\u53ea\u6709IE\u6d4f\u89c8\u5668\u624d\u80fd\u4f7f\u7528OCX\u63a7\u4ef6!");this.oBarCtrl=new JOcxCtrl(this.left,this.top,this.width,this.height,1,this._contentWindow);this.oBarCtrl.oParent=this;break;case showStyleSL:this.height=this.width=0;this.oBarCtrl=new JSilverLightCtrl(this.left,this.top,this.width,this.height,this.app.GetRelationPath()+"cab/",this._contentWindow);break;case showStyleJS:this.oBarCtrl=new JHTML5Ctrl;break;default:this.app.IsSurpportWebSocket()?this.oBarCtrl=new JHTML5Ctrl:(this.height=this.width=0,this.oBarCtrl=new JSilverLightCtrl(this.left,this.top,this.width,this.height,this.app.GetRelationPath()+"cab/",this._contentWindow))}this.SetAttribute("AgentType",0);this.SetAttribute("PassWord","111111");this.SetAttribute("MainPortID",14800);this.SetAttribute("BackPortID",14800);this.SetAttribute("TaskID","0");this.SetAttribute("MonitorPort",4502);this.SetAttribute("AppType",0);this.SetAttribute("SipServerPort",5060);this.SetAttribute("SipPassWord","00000000");this.SetAttribute("SipProtocol","UDP");this.SetAttribute("SipPassWdCryptType",0);this.SetAttribute("SipAuthType",1);this.SetAttribute("PhonType",0);this.SetAttribute("SelfPrompt",0);this.SetAttribute("forceEndProcess",g_DebugFlag);this.SetAttribute("LocalPort",4520);this.oBarCtrl.oParent=this;this.oBarCtrl.attachEventfun(this._eventFunction);this.oBarCtrl.attachResponsefun(this._responseFunction)};this._responseFunction=function(a,b){var d=this.oParent;DisplayLog(VccBar_Log_Debug,"JVccBar:OnMethodResponseEvent(cmdName:\u3010"+a+"\u3011 param: \u3010"+b+"\u3011)");if("GetWeChatParam"==a)null!=d.app.oWechatManager&&d.app.oWechatManager.SetUserInfo(b);else if("Initial"==a)"-2"==b&&(getLocalLanguage()==lg_zhcn?alert("\u7248\u672c\u4e0d\u5339\u914d\uff0c\u8bf7\u66f4\u65b0\u7248\u672c\u518d\u4f7f\u7528!"):alert("dismatch version\uff0cplease update new version!"));else if("PopDLG"==a){var e=b.split("@");if(2<e.length){var c=e[0],f=e[1],e=e[2];"VideoInfo"==c&&("camera"==f?d._invokeCmdCallBack(c,e.split("|")):"resolution"==f&&d._invokeCmdCallBack(c,e.split("|")))}return}d._invokeCmdCallBack(a,b);d.OnMethodResponseEvent(a,b);d.__emit("OnMethodResponseEvent",a,b);null!=d.oMonitorDataManager&&("InitialState"!=a&&"AgentQuery"!=a&&"TelQuery"!=a&&"IvrQuery"!=a&&"TrunkQuery"!=a&&"ServiceQuery"!=a&&"TaskQuery"!=a&&"CallReportQuery"!=a&&"GetTaskSummary"!=a&&"QueryMonitorSumInfo"!=a&&"StartNotification"!=a&&"EndNotification"!=a&&"MMServiceQuery"!=a&&"AgentStateQuery"!=a||d.oMonitorDataManager.__OnMonitorMethodResponseEvent(a,b))};this._invokeCmdCallBack=function(a,b){if("undefined"!=typeof this.arrBarMethodCallBack[a]&&null!=this.arrBarMethodCallBack[a])try{this.arrBarMethodCallBack[a]({data:b})}catch(h){console.info(h),this.arrBarMethodCallBack[a]=null}};this._bindCmdCallBack=function(a,b){"undefined"!=typeof this.arrBarMethodCallBack[a]&&"undefined"!=typeof b&&"function"==typeof b&&(this.arrBarMethodCallBack[a]=b)};this._eventFunction=function(a,b){var d=this.oParent;if(null==b||"undefined"==typeof b)b="";var e;try{e=b.split("|")}catch(q){}DisplayLog(VccBar_Log_Debug,"JVccBar:_eventFunction(cmdIndex\x3d"+a+",param\x3d"+b+")");switch(a){case eventOnCallRing:null!=d.oBarShow&&d.oBarShow.SetRingFlag(1);var c=e[7],f=21<e.length?e[22]:"0";"1"==f&&(c=GetGBKFromBase64(c));d.OnCallRing(e[0],e[1],e[2],e[3],e[4],e[5],e[6],c,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15],e[16],getDefaultParamValue(e[17],""),getDefaultParamValue(e[18],""),getDefaultParamValue(e[19],""),getDefaultParamValue(e[20],""),getDefaultParamValue(e[21],""));d.__emit("OnCallRing",e[0],e[1],e[2],e[3],e[4],e[5],e[6],c,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15],e[16],getDefaultParamValue(e[17],""),getDefaultParamValue(e[18],""),getDefaultParamValue(e[19],""),getDefaultParamValue(e[20],""),getDefaultParamValue(e[21],""));break;case eventOnAnswerCall:null!=d.oBarShow&&d.oBarShow.SetRingFlag(0);var p=7<e.length?e[7]:"",g=8<e.length?e[8]:"",f=9<e.length?e[9]:"0",c=e[5];"1"==f&&(c=GetGBKFromBase64(c));d.AnswerCall(e[0],e[1],e[2],e[3],e[4],c,e[6],p,g);d.__emit("AnswerCall",e[0],e[1],e[2],e[3],e[4],c,e[6],p,g);break;case eventOnCallEnd:null!=d.oBarShow&&d.oBarShow.SetRingFlag(0);f=14<e.length?e[14]:"0";c=e[11];"1"==f&&(c=GetGBKFromBase64(c));d.OnCallEnd(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],c,e[12],e[13],e[14]);d.__emit("OnCallEnd",e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],c,e[12],e[13],e[14]);break;case eventOnPrompt:c=e[0];f=e[1];4316==c&&(f=d.oBarControl.GetErrorItemDes(c)+f);4004==c&&(f=f+":"+d.oBarControl.GetErrorItemDes(f));""==f&&(f=d.oBarControl.GetErrorItemDes(c));4012==c&&(f=stringFormat(f,d.GetAttribute("TaskID")));1==d.GetAttribute("SelfPrompt")&&null!=d.oBarShow?d.oBarShow.ShowSelfPrompt(c,f):4411==c?(d.OnPrompt(c,f+d.errDescription),d.__emit("OnPrompt",c,f+d.errDescription)):(d.OnPrompt(c,f),d.__emit("OnPrompt",c,f));4409==c&&null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnAgentMonitorSignIn();if(4001==c||4002==c||4003==c||4013==c||4014==c||4015==c||4012==c)getLocalLanguage()==lg_zhcn?d.errDescription=" \u539f\u56e0\uff1a"+c+":"+f:d.errDescription=" cause\uff1a"+c+":"+f;4004==c&&(getLocalLanguage()==lg_zhcn?d.errDescription=" \u539f\u56e0\uff1a"+f:d.errDescription=" cause\uff1a"+f);4316==c&&(getLocalLanguage()==lg_zhcn?d.errDescription=" \u539f\u56e0\uff1a"+f:d.errDescription=" cause\uff1a"+f);break;case eventOnReportBtnStatus:d.userBtnIds=b;null!=d.oBarShow&&(d.oBarShow.ChangeBtnStatus(b),d.oBarShow.SetAgentStatus(d.GetAgentStatus()));null!=d.oMonitorCtrl&&d.oMonitorCtrl.SetReportBtnStatus(b,d.GetAgentStatus());null!=d.oBarAssist&&d.oBarAssist.oBarAgentStatus.SetAgentStatus(d.GetAgentStatus());d.OnReportBtnStatus(b);d.__emit("OnReportBtnStatus",b);d.OnAgentStatus(d.GetAgentStatus());break;case eventOnInitalSuccess:null!=d.oBarShow&&(d.oBarShow.SetSubBusyStatus(d.GetBusySubStatus()),d.oBarShow.SetSubBusySelectedItem(d.GetAgentSubBusyStatus()));null!=d.oBarAssist&&d.oBarAssist.oBarAgentStatus.SetSubBusyStatus(d.GetBusySubStatus());d.OnInitalSuccess();d.__emit("OnInitalSuccess");break;case eventOnInitalFailure:d.OnInitalFailure(e[0],e[1]+d.errDescription);d.__emit("OnInitalFailure",e[0],e[1],d.errDescription);d.errDescription="";break;case eventOnEventPrompt:"130"==e[0]||"126"==c?(d.OnEventPrompt(e[0],GetGBKFromBase64(e[1])),d.__emit("OnEventPrompt",e[0],GetGBKFromBase64(e[1]))):(d.OnEventPrompt(e[0],e[1]),d.__emit("OnEventPrompt",e[0],e[1]));break;case eventOnAgentWorkReport:if(d.workStatus==parseInt(e[0]))break;d.workStatus=parseInt(e[0]);"-1"==e[0]&&null!=d.oBarShow&&(d.oBarShow.SetSubBusyStatus(""),d.oBarShow.SetAgentStatus(d.GetAgentStatus()));null!=d.oMonitorCtrl&&d.oMonitorCtrl.SetAgentWorkReport(d.GetAttribute("AgentID"),d.GetAgentStatus(),parseInt(e[0]));d.OnAgentWorkReport(e[0],e[1]);d.__emit("OnAgentWorkReport",e[0],e[1]);break;case eventOnCallDataChanged:d.OnCallDataChanged(b);d.__emit("OnCallDataChanged",b);break;case eventOnBarExit:f=d.oBarControl.GetErrorItemDes(e[0]);""==f&&(f=e[1]);d.OnBarExit(e[0],f);d.__emit("OnBarExit",e[0],f);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnAgentMonitorSignOut("");break;case eventOnCallQueueQuery:d.OnCallQueueQuery(b);d.__emit("OnCallQueueQuery",b);break;case eventOnQueryGroupAgentStatus:e=b.split("@");c="0";1<e.length&&(c=e[1]);d.OnQueryGroupAgentStatus(e[0],c);d.__emit("OnQueryGroupAgentStatus",e[0],c);break;case eventOnSystemMessage:d.OnSystemMessage(e[0],getSubString(b,"|",""));d.__emit("OnSystemMessage",e[0],getSubString(b,"|",""));break;case eventOnRecvWeiboMsg:d.OnRecvWeiboMsg(b);d.__emit("OnRecvWeiboMsg",b);break;case eventOnIMMessage:d.OnIMMessage(e[0],this.GetDataFromBase64(e[2]),e[1]);d.__emit("OnIMMessage",e[0],this.GetDataFromBase64(e[2]),e[1]);break;case eventOnRecvWeChatMessage:null!=d.app.oWechatManager&&d.app.oWechatManager.OnSaveRecvMessageReport(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13]);d.OnRecvWeChatMessage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13]);d.__emit("OnRecvWeChatMessage",e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13]);break;case eventOnSendWeChatMsgReport:null!=d.app.oWechatManager&&d.app.oWechatManager.OnSaveSendMessageReport(e[0],e[1],e[2],e[3],e[4],e[5]);d.OnSendWeChatMsgReport(e[0],e[1],e[2],e[3],e[4],e[5]);d.__emit("OnSendWeChatMsgReport",e[0],e[1],e[2],e[3],e[4],e[5]);break;case eventOnUploadFileToMMSReport:null!=d.app.oWechatManager&&d.app.oWechatManager.OnInvokeUploadFileToMMSReport(e[0],e[1],e[2]);d.OnUploadFileToMMSReport(e[0],e[1],e[2],e[3],e[4],e[5]);d.__emit("OnUploadFileToMMSReport",e[0],e[1],e[2],e[3],e[4],e[5]);break;case eventOnDownloadFileToMMSReport:null!=d.app.oWechatManager&&d.app.oWechatManager.OnInvokeDownFileFromMMSReport(e[0],e[1],e[2],e[3]);d.OnDownloadFileToMMSReport(e[0],e[1],e[2],e[3]);d.__emit("OnDownloadFileToMMSReport",e[0],e[1],e[2],e[3]);break;case eventOnWorkStaticInfoReport:d.OnWorkStaticInfoReport(b);d.__emit("OnWorkStaticInfoReport",b);break;case eventOnAQueryCTIInfoReport:d.OnQuerySPGroupList(e[0],getSubString(b,"|",""));d.__emit("OnQuerySPGroupList",e[0],getSubString(b,"|",""));break;case eventOnAgentBusyReasonReport:null!=d.oBarShow&&d.oBarShow.SetSubBusySelectedItem(d.GetAgentSubBusyStatus());d.OnAgentBusyReason(e[0],getSubString(b,"|",""));d.__emit("OnAgentBusyReason",e[0],getSubString(b,"|",""));break;case eventOnAsrEventReport:d.OnAsrEventReport(e[0],e[1],e[2],e[3],e[4],e[5]);d.__emit("OnAsrEventReport",e[0],e[1],e[2],e[3],e[4],e[5]);break;case eventOnStopSmSuccess:d.OnStopSmSuccess(b);d.__emit("OnStopSmSuccess",b);break;case eventOnUpdateMediaEvent:"video"==e[2]?d.PopDlg("VideoDlg",0,0,1):d.PopDlg("VideoDlg",0,0,0);d.OnUpdateMediaEvent(e[0],e[1],e[2]);d.__emit("OnUpdateMediaEvent",e[0],e[1],e[2]);break;case eventOnSnapShotPngEvent:e="data:image/png;base64,"+b;d.OnSnapShotPngEvent(e);d.__emit("OnSnapShotPngEvent",e);break;case eventOnStopCaptureSuccess:d.OnStopCaptureSuccess(e[0],e[1]);d.__emit("OnStopCaptureSuccess",e[0],e[1]);break;case eventOnModifyVideoStreamReport:d.OnModifyVideoStreamReport(b);d.__emit("OnModifyVideoStreamReport",b);break;case eventOnVideoWndStatusReport:d.OnVideoWndStatusReport(e[0],e[1]);d.__emit("OnVideoWndStatusReport",e[0],e[1]);break;case eventOnQueueReport:d.OnQueueReport(b);d.__emit("OnQueueReport",b);break;case eventOnSessinMessage:d.OnSessionMessage(b);d.__emit("OnSessionMessage",b);break;case eventOnAgentLogUploadReport:d.OnAgentLogUpload(e[0],e[1],e[2],e[3],e[4],e[5]);d.__emit("OnAgentLogUpload",e[0],parseInt(e[1]),e[2],e[3],e[4],e[5]);break;case eventOnAgentReport:d.OnAgentReport(b);d.__emit("OnAgentReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnAgentReport(b);break;case eventOnTelReport:d.OnTelReport(b);d.__emit("OnTelReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnTelReport(b);break;case eventOnServiceReport:d.OnServiceReport(b);d.__emit("OnServiceReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnServiceReport(b);break;case eventOnMMServiceReport:d.OnMMServiceReport(b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnMMServiceReport(b);break;case eventOnIvrReport:d.OnIvrReport(b);d.__emit("OnIvrReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnIvrReport(b);break;case eventOnTaskReport:d.OnTaskReport(b);d.__emit("OnTaskReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnTaskReport(b);break;case eventOnOutboundReport:d.OnOutboundReport(b);d.__emit("OnOutboundReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnOutboundReport(b);break;case eventOnCallReportInfo:d.OnCallReportInfo(b);d.__emit("OnCallReportInfo",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnCallReportInfo(b);break;case eventOnQueryMonitorSumReport:d.OnQueryMonitorSumReport(e[0],e[1]);d.__emit("OnQueryMonitorSumReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnQueryMonitorSumReport(e[0],e[1]);break;case eventOnWallServiceReport:d.OnWallServiceReport(b);d.__emit("OnWallServiceReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnWallServiceReport(b);break;case eventOnWallQueueReport:d.OnWallQueueReport(b);d.__emit("OnWallQueueReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnWallQueueReport(b);break;case eventOnServiceStaticReport:d.OnServiceStaticReport(b);d.__emit("OnServiceStaticReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnServiceStaticReport(b);break;case eventOnAgentStaticReport:d.OnAgentStaticReport(b);d.__emit("OnAgentStaticReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnAgentStaticReport(b);break;case eventOnTrunkReport:d.OnTrunkReport(b);d.__emit("OnTrunkReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnTrunkReport(b);break;case eventOnTrunkSumReport:d.OnTrunkSumReport(b);d.__emit("OnTrunkSumReport",b);null!=d.oMonitorDataManager&&d.oMonitorDataManager.__OnTrunkSumReport(b);break;case eventOnGetVersionReport:d.OnGetVersionReport(d.GetVersion());d.__emit("OnGetVersionReport",d.GetVersion());break;case eventOnWebsocketSocket:this.GetBarType()==vccBarTypeSILVERLIGHT?(c=e[0],1==c?DisplayLog(VccBar_Log_Protocol,e[1]):2==c?DisplayLog(VccBar_Log_Info,e[1]):4==c?DisplayLog(VccBar_Log_Warn,e[1]):8==c?DisplayLog(VccBar_Log_Error,e[1]):d._inlineOnPrompt(e)):d._inlineOnPrompt(e)}};this._inlineOnPrompt=function(a){var b=a[0],d=a[1];"3000"==a[0]||"3100"==a[0]?d=stringFormat(this.oBarControl.GetErrorItemDes(a[0]),a[1],a[2],a[3]):""==d&&(d=this.oBarControl.GetErrorItemDes(a[0]));1==this.GetAttribute("SelfPrompt")&&null!=this.oBarShow?this.oBarShow.ShowSelfPrompt(b,d):this.OnPrompt(b,d)};this.SetAttribute=function(a,b){"AppType"==a?this._appType=b:"AutoUpdateURL"==a&&""!=b&&(b="/"==b.charAt(b.length-1)?b+"JVccBar/version/update":b+"/JVccBar/version/update");this.oBarCtrl.SetCtrlAttribute(a,b)};this.GetAttribute=function(a){return this.oBarCtrl.GetCtrlAttribute(a)};this.Initial=function(){return 0==this._appType?this.oBarCtrl.Initial():1==this._appType?(alert("\u5355\u72ec\u76d1\u63a7\u8bf7\u4e0d\u8981\u4f7f\u7528\u7535\u8bdd\u6761\u65b9\u5f0f!"),0):2==this._appType?this.oBarCtrl.Initial():-1};this.SerialBtn=function(a,b){null!=this.oBarShow&&this.oBarShow.SerialBtn(a,b);return this.oBarCtrl.SerialBtn(a,b)};this.GetBtnStatus=function(a){return this.userBtnIds};this.Configurate=function(a){return this.oBarCtrl.Configurate(a)};this.GetConfiguration=function(){return this.oBarCtrl.GetConfiguration()};this.UnInitial=function(a){"undefined"==typeof a&&(a=0);return this.oBarCtrl.UnInitial(a)};this.SetUIStyle=function(a){return this.oBarCtrl.SetUIStyle(a)};this.GetVersion=function(){return g_JsVersion+"-"+this.oBarCtrl.GetVersion()};this.SetBusy=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("SetBusy",a.callback),this.oBarCtrl.SetBusy(a.subStatus);this._bindCmdCallBack("SetBusy",b);return this.oBarCtrl.SetBusy(a)};this.SetIdle=function(a){if(a instanceof Object)return this._bindCmdCallBack("SetIdle",a.callback),this.oBarCtrl.SetIdle();this._bindCmdCallBack("SetIdle",a);return this.oBarCtrl.SetIdle()};this.SetWrapUp=function(a){var b=this.GetAgentStatus();if(1!=b&&2!=b)return-1;if(a instanceof Object)return this._bindCmdCallBack("SetWrapUp",a.callback),this.oBarCtrl.SetWrapUp();this._bindCmdCallBack("SetWrapUp",a);return this.oBarCtrl.SetWrapUp()};this.SetCTICalloutTask=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("SetCTICalloutTask",a.callback),this.oBarCtrl.SetCTICalloutTask(a);this._bindCmdCallBack("SetCTICalloutTask",b);return this.oBarCtrl.SetCTICalloutTask(a)};this.GetCTICalloutTask=function(a){if(a instanceof Object)return this._bindCmdCallBack("GetCTICalloutTask",a.callback),this.oBarCtrl.GetCTICalloutTask();this._bindCmdCallBack("GetCTICalloutTask",a);return this.oBarCtrl.GetCTICalloutTask()};this.GetCallData=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("GetCallData",a.callback),this.oBarCtrl.GetCallData(a.destAgentID);this._bindCmdCallBack("GetCallData",b);return this.oBarCtrl.GetCallData(a)};this.SetCallData=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("SetCallData",a.callback),this.oBarCtrl.SetCallData(a.destAgentID,a.calldata);this._bindCmdCallBack("SetCallData",c);return this.oBarCtrl.SetCallData(a,b)};this.GetTransfer=function(a){if(a instanceof Object)return this._bindCmdCallBack("GetTransfer",a.callback),this.oBarCtrl.GetTransfer();this._bindCmdCallBack("GetTransfer",a);return this.oBarCtrl.GetTransfer()};this.SetTransfer=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("SetTransfer",a.callback),this.oBarCtrl.SetTransfer(a.forwardDeviceID,a.forwardState,a.answerType);this._bindCmdCallBack("SetTransfer",e);return this.oBarCtrl.SetTransfer(a,b,c)};this.ChangeCallQueue=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("ChangeCallQueue",a.callback),this.oBarCtrl.ChangeCallQueue(a.calling,a.queuekey,a.orderid);this._bindCmdCallBack("ChangeCallQueue",e);return this.oBarCtrl.ChangeCallQueue(a,b,c)};this.GetCallID=function(){return this.oBarCtrl.GetCallID()};this.QuerySPGroupList=function(a,b,c,e,f,g,k){if(a instanceof Object)return this._bindCmdCallBack("QuerySPGroupList",a.callback),this.oBarCtrl.QuerySPGroupList(a.groupID,a.agentStatus,a.cmdType,a.checkAuthor,a.action,a.interval);this._bindCmdCallBack("QuerySPGroupList",k);return this.oBarCtrl.QuerySPGroupList(a,b,c,e,f,g)};this.GetCallInfo=function(){return this.oBarCtrl.GetCallInfo()};this.SetTransparentParameter=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("SetTransparentParameter",a.callback),this.oBarCtrl.SetTransparentParameter(a.transparentParam);this._bindCmdCallBack("SetTransparentParameter",b);return this.oBarCtrl.SetTransparentParameter(a)};this.GetAgentStatus=function(){return this.oBarCtrl.GetAgentStatus()};this.GetAgentSubBusyStatus=function(){return this.oBarCtrl.GetAgentSubBusyStatus()};this.GetBusySubStatus=function(){return this.oBarCtrl.GetBusySubStatus()};this.SetDisplayNumber=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("SetDisplayNumber",a.callback),this.oBarCtrl.SetDisplayNumber(a.destNum);this._bindCmdCallBack("SetDisplayNumber",b);return this.oBarCtrl.SetDisplayNumber(a)};this.GetDisplayNumber=function(a){if(a instanceof Object)return this._bindCmdCallBack("GetDisplayNumber",a.callback),this.oBarCtrl.GetDisplayNumber();this._bindCmdCallBack("GetDisplayNumber",a);return this.oBarCtrl.GetDisplayNumber()};this.CallQueueQuery=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("CallQueueQuery",a.callback),this.oBarCtrl.CallQueueQuery(a.serviceID,a.action,a.interval);this._bindCmdCallBack("CallQueueQuery",e);return this.oBarCtrl.CallQueueQuery(a,b,c)};this.QueryGroupAgentStatus=function(a,b,c,e,f){if(a instanceof Object)return this._bindCmdCallBack("QueryGroupAgentStatus",a.callback),this.oBarCtrl.QueryGroupAgentStatus(a.groupIDs,a.action,a.interval,a.type);this._bindCmdCallBack("QueryGroupAgentStatus",f);"undefined"==typeof e&&(e=0);return this.oBarCtrl.QueryGroupAgentStatus(a,b,c,e)};this.QueryPreViewCallOutNumbers=function(a,b,c,e,f){if(a instanceof Object)return this._bindCmdCallBack("QueryPreViewCallOutNumbers",a.callback),this.oBarCtrl.QueryPreViewCallOutNumbers(a.serviceNum,a.agentID,a.num,a.realloc);this._bindCmdCallBack("QueryPreViewCallOutNumbers",f);return this.oBarCtrl.QueryPreViewCallOutNumbers(a,b,c,e)};this.GetBase64Data=function(a){return this.oBarCtrl.GetBase64Data(a)};this.GetDataFromBase64=function(a){return this.oBarCtrl.GetDataFromBase64(a)};this.SetWeChatQueueFlag=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("SetWeChatQueueFlag",a.callback),this.oBarCtrl.SetWeChatQueueFlag(a.flag);this._bindCmdCallBack("SetWeChatQueueFlag",b);return this.oBarCtrl.SetWeChatQueueFlag(a)};this.GetWeChatQueueFlag=function(a){if(a instanceof Object)return this._bindCmdCallBack("GetWeChatQueueFlag",a.callback),this.oBarCtrl.GetWeChatQueueFlag();this._bindCmdCallBack("GetWeChatQueueFlag",a);return this.oBarCtrl.GetWeChatQueueFlag()};this.TransferCallQueue=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("TransferCallQueue",a.callback),this.oBarCtrl.TransferCallQueue(a.queuekey,a.transferType,a.destNum);this._bindCmdCallBack("TransferCallQueue",e);return this.oBarCtrl.TransferCallQueue(a,b,c)};this.SetActiveService=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("SetActiveService",a.callback),this.oBarCtrl.SetActiveService(a.serviceNum);this._bindCmdCallBack("SetActiveService",b);return this.oBarCtrl.SetActiveService(a)};this.GetActiveService=function(a){if(a instanceof Object)return this._bindCmdCallBack("GetActiveService",a.callback),this.oBarCtrl.GetActiveService();this._bindCmdCallBack("GetActiveService",a);return this.oBarCtrl.GetActiveService()};this.GetExitCause=function(){return this.oBarCtrl.GetExitCause()};this.SetForwardNumber=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("SetForwardNumber",a.callback),this.oBarCtrl.SetForwardNumber(a.num,a.state);this._bindCmdCallBack("SetForwardNumber",c);return this.oBarCtrl.SetForwardNumber(a,b)};this.GetForwardNumber=function(a){if(a instanceof Object)return this._bindCmdCallBack("GetForwardNumber",a.callback),this.oBarCtrl.GetForwardNumber();this._bindCmdCallBack("GetForwardNumber",a);return this.oBarCtrl.GetForwardNumber()};this.SetAgentReservedStatus=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("SetAgentReservedStatus",a.callback),this.oBarCtrl.SetAgentReservedStatus(a.agentStatus,a.subBusyStatus);this._bindCmdCallBack("SetAgentReservedStatus",c);return this.oBarCtrl.SetAgentReservedStatus(a,b)};this.SetMMService=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("SetMMService",a.callback),this.oBarCtrl.SetMMService(a.serviceID,a.flag);this._bindCmdCallBack("SetMMService",c);return this.oBarCtrl.SetMMService(a,b)};this.DeleteCaptureFile=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("DeleteCaptureFile",a.callback),this.oBarCtrl.DeleteCaptureFile(a.fileName);this._bindCmdCallBack("DeleteCaptureFile",b);return this.oBarCtrl.DeleteCaptureFile(a)};this.GetAgentLogFile=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("GetAgentLogFile",a.callback),this.oBarCtrl.GetAgentLogFile(a.destAgentID,a.urlType,a.uploadServer);this._bindCmdCallBack("GetAgentLogFile",e);a=getDefaultParam(a);if(""==a)return-1;"undefined"==typeof c&&(c=0);b=getDefaultParam(b);return this.oBarCtrl.GetAgentLogFile(a,c,b)};this.GetAgentWorkStatus=function(){return this.workStatus};this.GetMonitorStatus=function(){return 2==this._appType||1==this._appType?-1!=this.GetAgentWorkStatus():!1};this.GetMonitorTimeOffSet=function(){return this.oBarCtrl.GetMonitorOffSetTime()};this.GetCodeDescription=function(a){return this.oBarControl.GetErrorItemDes(a)};this.MakeCall=function(a,b,c,e,f,g,k,l,q,m,r,u){if(a instanceof Object)return this._bindCmdCallBack("MakeCall",a.callback),this.oBarCtrl.MakeCall(a.destNum,a.serviceDirect,a.taskID,a.transParentParam,a.phoneID,a.projectID,a.cryptType,a.chargeNumber,a.displayNumber,a.numberX,a.av);this._bindCmdCallBack("MakeCall",u);return this.oBarCtrl.MakeCall(a,b,c,e,f,g,k,l,q,m,r)};this.CallIn=function(a,b,c,e,f,g){if(a instanceof Object)return this._bindCmdCallBack("CallIn",a.callback),this.oBarCtrl.CallIn(a.destAgentID,a.serviceDirect,a.taskID,a.transParentParam,a.av);this._bindCmdCallBack("CallIn",g);return this.oBarCtrl.CallIn(a,b,c,e,f)};this.TransferOut=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("TransferOut",a.callback),this.oBarCtrl.TransferOut(a.transferType,a.destNum);this._bindCmdCallBack("TransferOut",c);return this.oBarCtrl.TransferOut(a,b)};this.Hold=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("Hold",a.callback),this.oBarCtrl.Hold(a.destDeviceID);this._bindCmdCallBack("Hold",b);return this.oBarCtrl.Hold(a)};this.RetrieveHold=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("RetrieveHold",a.callback),this.oBarCtrl.RetrieveHold(a.destDeviceID);this._bindCmdCallBack("RetrieveHold",b);return this.oBarCtrl.RetrieveHold(a)};this.Disconnect=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("Disconnect",a.callback),this.oBarCtrl.Disconnect(a.callType);this._bindCmdCallBack("Disconnect",b);return this.oBarCtrl.Disconnect(a)};this.Answer=function(a,b){if(a instanceof Object){var d=a;this._bindCmdCallBack("Answer",d.callback);"undefined"==typeof d.recordFlag&&(d.recordFlag=0);return this.oBarCtrl.Answer(d.recordFlag)}this._bindCmdCallBack("Answer",b);"undefined"==typeof a&&(a=0);return this.oBarCtrl.Answer(a)};this.Consult=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("Consult",a.callback),this.oBarCtrl.Consult(a.consultType,a.consultNum);this._bindCmdCallBack("Consult",c);return this.oBarCtrl.Consult(a,b)};this.Transfer=function(a){if(a instanceof Object)return this._bindCmdCallBack("Transfer",a.callback),this.oBarCtrl.Transfer();this._bindCmdCallBack("Transfer",a);return this.oBarCtrl.Transfer()};this.Conference=function(a){if(a instanceof Object)return this._bindCmdCallBack("Conference",a.callback),this.oBarCtrl.Conference();this._bindCmdCallBack("Conference",a);return this.oBarCtrl.Conference()};this.SendDTMF=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("SendDTMF",a.callback),this.oBarCtrl.SendDTMF(a.tapKey);this._bindCmdCallBack("SendDTMF",b);return this.oBarCtrl.SendDTMF(a)};this.BeginRecord=function(a,b){return this.oBarCtrl.BeginRecord(a,b)};this.StopRecord=function(a){return this.oBarCtrl.StopRecord(a)};this.BeginPlay=function(a,b,c,e,f,g){if(a instanceof Object)return this._bindCmdCallBack("BeginPlay",a.callback),this.oBarCtrl.BeginPlay(a.destAgentID,a.destDeviceID,a.type,a.fileName,a.varparam);this._bindCmdCallBack("BeginPlay",g);return this.oBarCtrl.BeginPlay(a,b,c,e,f)};this.StopPlay=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("StopPlay",a.callback),this.oBarCtrl.StopPlay(a.destAgentID,a.destDeviceID);this._bindCmdCallBack("StopPlay",c);return this.oBarCtrl.StopPlay(a,b)};this.Bridge=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("Bridge",a.callback),this.oBarCtrl.Bridge(a.ivrNum,a.endCall);this._bindCmdCallBack("Bridge",c);return this.oBarCtrl.Bridge(a,b)};this.Mute=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("Mute",a.callback),this.oBarCtrl.Mute(a.flag,a.destDeviceID);this._bindCmdCallBack("Mute",c);return this.oBarCtrl.Mute(a,b)};this.AlterNate=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("AlterNate",a.callback),this.oBarCtrl.AlterNate(a.destDeviceID);this._bindCmdCallBack("AlterNate",b);return this.oBarCtrl.AlterNate(a)};this.CallBack=function(a){if(a instanceof Object)return this._bindCmdCallBack("CallBack",a.callback),this.oBarCtrl.CallBack();this._bindCmdCallBack("CallBack",a);return this.oBarCtrl.CallBack()};this.ReCall=function(a){if(a instanceof Object)return this._bindCmdCallBack("ReCall",a.callback),this.oBarCtrl.ReCall();this._bindCmdCallBack("ReCall",a);return this.oBarCtrl.ReCall()};this.SMMsg=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("SMMsg",c.callback),this.oBarCtrl.SMMsg(c.destAddress,c.shortMessage);this._bindCmdCallBack("SMMsg",c);return this.oBarCtrl.SMMsg(a,b)};this.ReleaseThirdOne=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("ReleaseThirdOne",a.callback),this.oBarCtrl.ReleaseThirdOne(a.retrieveCall);this._bindCmdCallBack("ReleaseThirdOne",b);return this.oBarCtrl.ReleaseThirdOne(a)};this.BeginCollect=function(a,b,c,e,f,g,k,l,q,m,r){if(a instanceof Object)return this._bindCmdCallBack("BeginCollect",a.callback),this.oBarCtrl.BeginCollect(a.destAgentID,a.destDeviceID,a.playType,a.filename,a.min,a.max,a.end,a.cel,a.fto,a.ito);this._bindCmdCallBack("BeginCollect",r);return this.oBarCtrl.BeginCollect(a,b,c,e,f,g,k,l,q,m)};this.StopCollect=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("StopCollect",a.callback),this.oBarCtrl.StopCollect(a.destAgentID,a.destDeviceID);this._bindCmdCallBack("StopCollect",c);return this.oBarCtrl.StopCollect(a,b)};this.ForceReset=function(){return this.oBarCtrl.ForceReset()};this.SendIMMessage=function(a,b,c,e,f,g,k){if(a instanceof Object)return this._bindCmdCallBack("SendIMMessage",a.callback),this.oBarCtrl.SendIMMessage(a.destTarget0,a.destTarget1,a.destTarget2,a.logicOperator,a.msgtype,a.message);this._bindCmdCallBack("SendIMMessage",k);return this.oBarCtrl.SendIMMessage(a,b,c,e,f,g)};this.SendIMMessage2=function(a,b,c){return this.oBarCtrl.SendIMMessage2(a,b,c)};this.WinCap=function(a,b,c){return this.oBarCtrl.WinCap(a,b,c)};this.PopDlg=function(a,b,c,e){return this.GetJVccBarType()!=vccBarTypeOCX?this.oBarCtrl.PopDlg(a,b,c,e):-1};this.VideoSetting=function(a){return this.GetJVccBarType()!=vccBarTypeOCX?this.oBarCtrl.VideoSetting(a):-1};this.VideoInfo=function(a){return this.GetJVccBarType()!=vccBarTypeOCX?(a instanceof Object&&this._bindCmdCallBack("VideoInfo",a.callback),this.oBarCtrl.VideoSettingInfo(a)):-1};this.SendSipSessionMessage=function(a){return this.oBarCtrl.SendSipSessionMessage(a)};this.UpdateMedia=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("UpdateMedia",a.callback),this.oBarCtrl.UpdateMedia(a.destDeviceID,a.av);this._bindCmdCallBack("UpdateMedia",c);return this.oBarCtrl.UpdateMedia(a,b)};this.BeginCapture=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("BeginCapture",a.callback),this.oBarCtrl.BeginCapture(a.destNum,a.faceDet);this._bindCmdCallBack("BeginCapture",c);"undefined"==typeof a&&(a="");"undefined"==typeof b&&(b="1");return this.oBarCtrl.BeginCapture(a,b)};this.Connect=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("Connect",a.callback),this.oBarCtrl.Connect(a.destDeviceID);this._bindCmdCallBack("Connect",b);return this.oBarCtrl.Connect(a)};this.ReleaseConnectOne=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("ReleaseConnectOne",a.callback),this.oBarCtrl.ReleaseConnectOne(a.destDeviceID);this._bindCmdCallBack("ReleaseConnectOne",b);return this.oBarCtrl.ReleaseConnectOne(a)};this.MultiConfTransfer=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("MultiConfTransfer",a.callback),this.oBarCtrl.MultiConfTransfer(a.destDeviceID);this._bindCmdCallBack("MultiConfTransfer",b);return this.oBarCtrl.MultiConfTransfer(a)};this.ModifyVideoStream=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("ModifyVideoStream",a.callback),this.oBarCtrl.ModifyVideoStream(a.mode,a.line,a.display);this._bindCmdCallBack("ModifyVideoStream",e);return this.oBarCtrl.ModifyVideoStream(a,b,c)};this.ForeReleaseCall=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("ForeReleaseCall",a.callback),this.oBarCtrl.ForeReleaseCall(a.destAgentID,a.type);this._bindCmdCallBack("ForeReleaseCall",c);return this.oBarCtrl.ForeReleaseCall(a,b)};this.Insert=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("Insert",a.callback),this.oBarCtrl.Insert(a.destAgentID,a.type,a.callID);this._bindCmdCallBack("Insert",e);return this.oBarCtrl.Insert(a,b,c)};this.Listen=function(a,b,c,e){if(e instanceof Object)return this._bindCmdCallBack("Listen",e.callback),this.oBarCtrl.Listen(e.destAgentID,e.type,e.callID);this._bindCmdCallBack("Listen",e);return this.oBarCtrl.Listen(a,b,c)};this.Intercept=function(a,b,c,e,f){if(a instanceof Object)return this._bindCmdCallBack("Intercept",a.callback),this.oBarCtrl.Intercept(a.destAgentID,a.type,a.callID,a.direction);this._bindCmdCallBack("Intercept",f);return this.oBarCtrl.Intercept(a,b,c,e)};this.Lock=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("Lock",a.callback),this.oBarCtrl.Lock(a.destAgentID);this._bindCmdCallBack("Lock",b);return this.oBarCtrl.Lock(a)};this.UnLock=function(a,b){if(b instanceof Object)return this._bindCmdCallBack("UnLock",b.callback),this.oBarCtrl.UnLock(b.destAgentID);this._bindCmdCallBack("UnLock",b);return this.oBarCtrl.UnLock(a)};this.ForceIdle=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("ForceIdle",a.callback),this.oBarCtrl.ForceIdle(a.destAgentID);this._bindCmdCallBack("ForceIdle",b);return this.oBarCtrl.ForceIdle(a)};this.ForceBusy=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("ForceBusy",a.callback),this.oBarCtrl.ForceBusy(a.destAgentID);this._bindCmdCallBack("ForceBusy",b);return this.oBarCtrl.ForceBusy(a)};this.ForceOut=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("ForceOut",a.callback),this.oBarCtrl.ForceOut(a.destAgentID);this._bindCmdCallBack("ForceOut",b);return this.oBarCtrl.ForceOut(a)};this.Help=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("Help",a.callback),this.oBarCtrl.Help(a.destAgentID,a.type,a.callID);this._bindCmdCallBack("Help",e);return this.oBarCtrl.Help(a,b,c)};this.InitialState=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("InitialState",a.callback),this.oBarCtrl.InitialState(a.curpos);this._bindCmdCallBack("InitialState",b);return this.oBarCtrl.InitialState(a)};this.AgentQuery=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("AgentQuery",a.callback),this.oBarCtrl.AgentQuery(a.monitorid,a.curpos,a.agentName);this._bindCmdCallBack("AgentQuery",e);return this.oBarCtrl.AgentQuery(a,b,c)};this.TelQuery=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("TelQuery",a.callback),this.oBarCtrl.TelQuery(a.monitorid,a.curpos);this._bindCmdCallBack("TelQuery",c);return this.oBarCtrl.TelQuery(a,b)};this.IvrQuery=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("IvrQuery",a.callback),this.oBarCtrl.IvrQuery(a.monitorid,a.curpos);this._bindCmdCallBack("IvrQuery",c);return this.oBarCtrl.IvrQuery(a,b)};this.ServiceQuery=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("ServiceQuery",a.callback),this.oBarCtrl.ServiceQuery(a.monitorid,a.curpos);this._bindCmdCallBack("ServiceQuery",c);return this.oBarCtrl.ServiceQuery(a,b)};this.TaskQuery=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("TaskQuery",a.callback),this.oBarCtrl.TaskQuery(a.monitorid,a.curpos);this._bindCmdCallBack("TaskQuery",c);return this.oBarCtrl.TaskQuery(a,b)};this.CallReportQuery=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("CallReportQuery",a.callback),this.oBarCtrl.CallReportQuery(a.monitorid,a.curpos,a.monitorVersion);this._bindCmdCallBack("CallReportQuery",e);return this.oBarCtrl.CallReportQuery(a,b,c)};this.GetTaskSummary=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("GetTaskSummary",a.callback),this.oBarCtrl.GetTaskSummary(a.monitorid,a.taskid);this._bindCmdCallBack("GetTaskSummary",c);return this.oBarCtrl.GetTaskSummary(a,b)};this.QueryMonitorSumInfo=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("QueryMonitorSumInfo",a.callback),this.oBarCtrl.QueryMonitorSumInfo(a.cmdName,a.amdParam);this._bindCmdCallBack("QueryMonitorSumInfo",c);return this.oBarCtrl.QueryMonitorSumInfo(a,b)};this.StartNotification=function(a,b,c,e){if(a instanceof Object)return this._bindCmdCallBack("StartNotification",a.callback),this.oBarCtrl.StartNotification(a.id,a.type,a.flag);this._bindCmdCallBack("StartNotification",e);return this.oBarCtrl.StartNotification(a,b,c)};this.EndNotification=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("EndNotification",a.callback),this.oBarCtrl.EndNotification(a.id);this._bindCmdCallBack("EndNotification",b);return this.oBarCtrl.EndNotification(a)};this.TrunkQuery=function(a,b,c){if(a instanceof Object)return this._bindCmdCallBack("TrunkQuery",a.callback),this.oBarCtrl.TrunkQuery(a.monitorid,a.curpos);this._bindCmdCallBack("TrunkQuery",c);return this.oBarCtrl.TrunkQuery(a,b)};this.MMServiceQuery=function(a,b){if(a instanceof Object)return this._bindCmdCallBack("MMServiceQuery",a.callback),this.oBarCtrl.MMServiceQuery(a.monitorid);this._bindCmdCallBack("MMServiceQuery",b);return this.oBarCtrl.MMServiceQuery(a)};this.AgentStateQuery=function(a,b,c,e,f){if(a instanceof Object)return this._bindCmdCallBack("AgentStateQuery",a.callback),this.oBarCtrl.AgentStateQuery(a.monitorid,a.curpos,a.maxitem,a.type);this._bindCmdCallBack("AgentStateQuery",f);return this.oBarCtrl.AgentStateQuery(a,b,c,e)};this.SendWeiboMsg=function(a){return this.oBarCtrl.SendWeiboMsg(a)};this.UploadFileToMMS=function(a,b,c,e){return this.oBarCtrl.UploadFileToMMS(a,b,c,e)};this.DownFileFromMMS=function(a,b,c,e,f){return this.oBarCtrl.DownFileFromMMS(a,b,c,e,f)};this.SendWeChatMsg=function(a,b,c,e,f,g,k,l,q,m){null!=this.app.oWechatManager&&this.app.oWechatManager.SaveSendMessage(a,b,c,e,f,g,k,l,q,m);return this.oBarCtrl.SendWeChatMsg(a,b,c,e,f,g,k,l,q,m)};this.QueryWeChatData=function(a,b,c,e,f,g,k){return this.oBarCtrl.QueryWeChatData(a,b,c,e,f,g,k)};this.QueryWeChatHistory=function(a,b,c,e,f,g,k){return this.oBarCtrl.QueryWeChatHistory(a,b,c,e,f,g,k)};this.GetWeChatParam=function(a){return this.oBarCtrl.GetWeChatParam(a)};this.OnCallRing=function(a,b,c,e,f,g,k,l,q,m,r,u,v,w,y,A,B,C,D,E,F,G){};this.AnswerCall=function(a,b,c,e,f,g,k,l,q){};this.OnAnswerCall=function(a,b,c,e,f,g,k,l,q){};this.OnCallEnd=function(a,b,c,e,f,g,k,l,q,m,r,u,v,w,y){};this.OnPrompt=function(a,b){};this.OnReportBtnStatus=function(a){};this.OnInitalSuccess=function(){};this.OnInitalFailure=function(a,b){};this.OnEventPrompt=function(a,b){};this.OnAgentWorkReport=function(a,b){};this.OnCallDataChanged=function(a){};this.OnBarExit=function(a,b){};this.OnCallQueueQuery=function(a){};this.OnQueryGroupAgentStatus=function(a,b){};this.OnSystemMessage=function(a,b){};this.OnRecvWeiboMsg=function(a){};this.OnIMMessage=function(a,b,c){};this.OnRecvWeChatMessage=function(a,b,c,e,f,g,k,l,q,m,r,u,v,w){};this.OnSendWeChatMsgReport=function(a,b,c,e,f,g){};this.OnUploadFileToMMSReport=function(a,b,c,e,f,g){};this.OnDownloadFileToMMSReport=function(a,b,c,e){};this.OnWorkStaticInfoReport=function(a){};this.OnQueueReport=function(a){};this.OnQuerySPGroupList=function(a,b){};this.OnAgentBusyReason=function(a,b){};this.OnAgentStatus=function(a){};this.OnAgentLogUpload=function(a,b,c,e,f,g){};this.OnAsrEventReport=function(a,b,c,e){};this.OnStopSmSuccess=function(a){};this.OnGetVersionReport=function(a){};this.OnSessionMessage=function(a){};this.OnUpdateMediaEvent=function(a,b,c){};this.OnSnapShotPngEvent=function(a){};this.OnStopCaptureSuccess=function(a,b){};this.OnModifyVideoStreamReport=function(a){};this.OnVideoWndStatusReport=function(a,b){};this.OnAgentReport=function(a){};this.OnTelReport=function(a){};this.OnServiceReport=function(a){};this.OnIvrReport=function(a){};this.OnTaskReport=function(a){};this.OnOutboundReport=function(a){};this.OnCallReportInfo=function(a){};this.OnQueryMonitorSumReport=function(a,b){};this.OnWallServiceReport=function(a){};this.OnWallQueueReport=function(a){};this.OnServiceStaticReport=function(a){};this.OnAgentStaticReport=function(a){};this.OnTrunkReport=function(a){};this.OnTrunkSumReport=function(a){};this.OnMMServiceReport=function(a){};this.OnMethodResponseEvent=function(a,b){};this.SetInlineShowBar=function(a){this.oBarShow=a;null!=this.oBarShow&&this.oBarCtrl.SerialBtn(this.oBarShow._btnIDs)};this.SetMonitorCtrl=function(a){this.oMonitorCtrl=a};this.SetMonitorData=function(a){this.oMonitorDataManager=a};this.SetAssistCtrl=function(a){this.oBarAssist=a};this.SetAsynMethod=function(a){this.GetJVccBarType()==vccBarTypeOCX&&this.oBarCtrl.GetBarCtrl().SetAsysMode(a)};this.GetAsynMethod=function(){return this.GetJVccBarType()!=vccBarTypeHTML5?this.oBarCtrl.GetBarCtrl().GetAsysMode():1};this.GetErrorDescription=function(a){return this.oBarControl.GetErrorItemDes(a)};this.GetBarCtrl=function(){return this.oBarCtrl.GetBarCtrl()};this.GetJVccBarType=function(){return this.oBarCtrl.GetBarType()};this.GetCloneParam=function(){var a=Array(16);a[0]=this.GetAttribute("MainIP");a[1]=this.GetAttribute("MainPortID");a[2]=this.GetAttribute("BackIP");a[3]=this.GetAttribute("BackPortID");a[4]=this.GetAttribute("MonitorIP");a[5]=this.GetAttribute("MonitorPort");a[6]=this.GetAttribute("SipServerIP");a[7]=this.GetAttribute("SipServerPort");a[8]=this.GetAttribute("SipProtocol");a[9]=this.GetAttribute("SipPassWord");a[10]=this.GetAttribute("PhonType");a[11]=this.GetAttribute("AppType");a[12]=this.GetAttribute("PassWord");a[13]=this.GetAttribute("MediaFlag");a[14]=this.GetAttribute("AgentID");a[15]=this.GetAttribute("Dn");return a.join("|")};this.SetCloneParam=function(a){a=a.split("|");return 16==a.length?(this.SetAttribute("MainIP",a[0]),this.SetAttribute("MainPortID",parseInt(a[1])),this.SetAttribute("BackIP",a[2]),this.SetAttribute("BackPortID",parseInt(a[3])),this.SetAttribute("MonitorIP",a[4]),this.SetAttribute("MonitorPort",parseInt(a[5])),this.SetAttribute("SipServerIP",a[6]),this.SetAttribute("SipServerPort",parseInt(a[7])),this.SetAttribute("SipProtocol",a[8]),this.SetAttribute("SipPassWord",a[9]),this.SetAttribute("PhonType",parseInt(a[10])),this.SetAttribute("AppType",parseInt(a[11])),this.SetAttribute("PassWord",a[12]),this.SetAttribute("MediaFlag",a[13]),this.SetAttribute("AgentID",a[14]),this.SetAttribute("Dn",a[15]),!0):!1};this.Display=function(a){null!=this.oBarShow&&(this.oBarShow.style.display=1==a?"block":"none")};this.__emit=function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var f=Array.prototype.slice.call(c);if(this._listeners[a])this._listeners[a].forEach(function(b,c){if(b.callback&&"function"===typeof b.callback){var d=!0;try{var e,d=(e=b.callback).call.apply(e,[b.scope||this].concat(f))}catch(m){console.error(m),this._listeners[a].splice(c,1)}"undefined"===typeof d&&(d=!0);return d}this._listeners[a].splice(c,1);return!0},this);else return!0};this.On=function(a,b,c){if(a instanceof String||"string"===(typeof a).toLowerCase())-1<this.arrBarEvent.indexOf(a)?(this._listeners[a]=this._listeners[a]||[],this._listeners[a].push({callback:b,scope:c||this})):console.warn(stringFormat("event [{0}] not support yet.",a));else if(a instanceof Object){var d=this;Object.keys(a).forEach(function(c){if(-1<d.arrBarEvent.indexOf(c)){var e=a[c];d._listeners[c]=d._listeners[c]||[];d._listeners[c].push({callback:e.callback||e,scope:e.scope||b||d})}else console.warn(stringFormat("event [{0}] not support yet.",c))})}else console.error("param not support [%o] yet.",a)};this.UnOn=function(a){if(a instanceof String||"string"===(typeof a).toLowerCase())-1<this.arrBarEvent.indexOf(a)?this._listeners[a].splice(0,this._listeners[a].length):console.warn(stringFormat("event [{0}] not support yet.",a));else if(a instanceof Object){var b=this;Object.keys(a).forEach(function(c){if(-1<b.arrBarEvent.indexOf(c)){var d=parseInt(a[c]);b._listeners[c]=b._listeners[c]||[];b._listeners[c].length>d?b._listeners[c].splice(d,1):console.warn(stringFormat("event [{0}] not exist {1} callback.",c,d))}else console.warn(stringFormat("event [{0}] not support yet.",c))})}else console.error("param not support [%o] yet.",a)};this.OnClear=function(){this._listeners={}};this._createObject();return this}var application=null,showStyleNONE=0,showStyleOCX=1,showStyleJS=2,showStyleAUTTO=3,showStyleSL=4,vccBarTypeOCX=0,vccBarTypeHTML5=1,vccBarTypeSILVERLIGHT=2,vccBarTypePUREJS=3;function applicationLoad(a,b,c,f,g,k,l){null==application&&("undefined"==typeof k&&(k=""),7==arguments.length?(application=new JApplication(a,b,c,f,g,k),application.onLoad=l):3==arguments.length&&(application=new JApplication(0,b,0,0,arguments[0],arguments[1]),application.onLoad=arguments[2]),setTimeout(createBar,1E3))}function applicationUnLoad(a){null!=application&&(null!=application.oJVccBar&&application.oJVccBar.UnInitial(a),null!=application.oJMonitor&&(delete application.oJMonitor,application.oJMonitor=null),null!=application.oJBarDisplayer&&(delete application.oJBarDisplayer,application.oJBarDisplayer=null),delete application,application=null)}function createBar(){application.oJVccBar=new JVccBar(application.left,application.top,application.width,application.height,application.showstyle,null,application);application.InitAssist();application.oJVccBar.SetAssistCtrl(application.oVccBarAssist);if(application.onLoad)application.onLoad()}function JApplication(a,b,c,f,g,k){this.oBrowserSys=this.onLoad=this.oVccBarAssist=this.oWechatManager=this.oJMonitorData=this.oWecharCtrl=this.oJBarDisplayer=this.oJMonitor=this.oJVccBar=null;this.RelationPath=k;this.left=a;this.top=b;this.width=c;this.height=f;this.showstyle=g;this.surpportWebsocket=!1;this._contentWindow=window;this.CreateBarDisplay=function(){if(this.showstyle==showStyleJS||this.showstyle==showStyleAUTTO)this.IsSurpportWebSocket(),this.oJBarDisplayer=new JVccBarEasyUICtrl(this.left,this.top,this.width,this.height,this._contentWindow)};this.InitAssist=function(){this.oWechatManager=new JWechChatManager;this.oVccBarAssist=new JVccBarAssist(this)};this.InitMonitorDataManager=function(){this.oJMonitorData=new JcmMonitorManager(application.oJVccBar)};this.BindMonitorBarToEachOther=function(a){try{a="undefined"==typeof a?this.oJMonitor:a,null==a?alert("\u76d1\u63a7\u63a7\u4ef6\u6ca1\u6709\u521d\u59cb\u5316!"):(a.SetVccBarCtrl(this.oJVccBar),this.oJVccBar.SetMonitorCtrl(a))}catch(d){alert(d.message)}};this.GetRelationPath=function(){return this.RelationPath};this.IsSurpportWebSocket=function(){return this.surpportWebsocket};this.Log=function(a){this.OnDebug(a)};this.DislayLog=function(a){gLogType=getDefaultParamValue(a,VccBar_Log_None)};this.OnDebug=function(a){};this.OnLoad=function(){};this._Create=function(){this.surpportWebsocket=IsWebSocketValid();this.oBrowserSys=this._GetBrowerSys()};this._GetBrowerSys=function(){this.version=this.os="";var a=navigator.userAgent.toLowerCase();if(0<a.indexOf("msie"))this.os="msie",this.version=a.match(/msie ([\d.]+)/)[1];else if(0<a.lastIndexOf("firefox"))this.os="firefox",this.version=a.match(/firefox\/([\d.]+)/)[1];else if(0<a.lastIndexOf("chrome"))this.os="chrome",this.version=a.match(/chrome\/([\d.]+)/)[1];else{var b=GetIEVersion();-1==b?(this.os=a,this.version=""):(this.os="msie",this.version=b)}"zh-cn"==getLocalLanguage()?this.expression="ua:\u3010"+a+"\u3011\r\nos:\u3010"+this.os+"\u3011 version:\u3010"+this.version+"\u3011\r\nwebsocket:\u3010"+(1==this.surpportWebsocket?"\u652f\u6301":"\u4e0d\u652f\u6301")+"\u3011":this.expression="ua:["+a+"]\r\nos:["+this.os+"] version:["+this.version+"]\r\nwebsocket:["+(1==this.surpportWebsocket?"surpport":"unsurpport")+"]";return this};this._Create()}function loadHeadMeta(){var a=document.getElementsByTagName("HEAD").item(0),b=document.createElement("meta");b.setAttribute("http-equiv","X-UA-Compatible");b.setAttribute("content","IE\x3d10");a.appendChild(b)}function IsWebSocketValid(){!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket);return window.WebSocket?!0:!1}function isIE(){try{return window.ActiveXObject||"ActiveXObject"in window?!0:!1}catch(a){return!1}}function getLocalLanguage(){return("Netscape"==navigator.appName?navigator.language:navigator.userLanguage).toLowerCase()}function isUnderIe8(){var a=navigator.userAgent.toLowerCase();return 0<a.indexOf("msie")&&(a=a.match(/msie ([\d.]+)/)[1],8>=parseInt(a))?!0:!1}function GetIEVersion(){var a=navigator.userAgent,b=-1<a.indexOf("compatible")&&-1<a.indexOf("MSIE"),c=-1<a.indexOf("Edge")&&!b,f=-1<a.indexOf("Trident")&&-1<a.indexOf("rv:11.0");return b?(/MSIE (\d+\.\d+);/.test(a),a=parseFloat(RegExp.$1),7==a?7:8==a?8:9==a?9:10==a?10:6):c?"edge":f?11:-1};

